Sitecore=window.Sitecore||{};Sitecore.Speak=Sitecore.Speak||{};Sitecore.Speak.D3=Sitecore.Speak.D3||{};Sitecore.Speak.D3.models=Sitecore.Speak.D3.models||{};Sitecore.Speak.D3.models.constants=Sitecore.Speak.D3.models.constants||{};Sitecore.Speak.D3.models.formatter=Sitecore.Speak.D3.models.formatter||{};Sitecore.Speak.D3.models.dispatcher=Sitecore.Speak.D3.models.dispatcher||{};Sitecore.Speak.D3.models.data=Sitecore.Speak.D3.models.data||{};Sitecore.Speak.D3.models.utils=Sitecore.Speak.D3.models.utilsConfig||{};Sitecore.Speak.D3.models.utils=Sitecore.Speak.D3.models.utils||{};Sitecore.Speak.D3.models.chartProperties=Sitecore.Speak.D3.models.chartProperties||{};Sitecore.Speak.D3.models.colors=Sitecore.Speak.D3.models.colors||{};Sitecore.Speak.D3.models.nvd3Legend=Sitecore.Speak.D3.models.nvd3Legend||{};Sitecore.Speak.D3.models.nvd3Tooltip=Sitecore.Speak.D3.models.nvd3Tooltip||{};Sitecore.Speak.D3.models.functionLines=Sitecore.Speak.D3.models.functionLines||{};Sitecore.Speak.D3.models.nvd3Axis=Sitecore.Speak.D3.models.nvd3Axis||{};Sitecore.Speak.D3.models.nvd3VisualizationManager=Sitecore.Speak.D3.models.nvd3VisualizationManager||{};Sitecore.Speak.D3.components=Sitecore.Speak.D3.components||{};Sitecore.Speak.D3.components.Area=Sitecore.Speak.D3.components.Area||{};Sitecore.Speak.D3.components.Line=Sitecore.Speak.D3.components.Line||{};Sitecore.Speak.D3.components.Pie=Sitecore.Speak.D3.components.Pie||{};Sitecore.Speak.D3.components.Doughnut=Sitecore.Speak.D3.components.Doughnut||{};Sitecore.Speak.D3.components.Bar=Sitecore.Speak.D3.components.Bar||{};Sitecore.Speak.D3.components.Column=Sitecore.Speak.D3.components.Column||{};Sitecore.Speak.D3.components.Combination=Sitecore.Speak.D3.components.Combination||{},function(n){n.colors={otherColor:["#CCCCCC"],singleColor:["#6AC0E2"],singleNegativeColor:["#EA6962"],facetColors:{value:"#88BB5D",visits:"#6AC0E2",valuepervisit:"#FCE179",allfacets:"#a6a6a6",otherfacets:"#e3e3e3",avgvisitduration:"#E5DDB3",bouncerate:"#D4C4D0",bounce:"#B497AD",conversionrate:"#CAE1B7",conversion:"#A2CA81",avgpagecount:"#D09F62",avgvisitcount:"#E8CFB0",pageviews:"#FB9851",avgvisitpageviews:"#AADBEE",timeonsite:"#D1C47A",avgcountvalue:"#FAD338",count:"#D6AB76"},selectedSegmentColor:"#185F7B",standardColors:["#55B7DD","#95C36F","#FAD338","#FA8938","#E7534B","#A989A1","#CBBC67","#D09F62","#6AC0E2","#A2CA81","#FCE179","#FB9851","#EA6962","#B497AD","#D1C47A","#D6AB76","#8CCEE8","#B7D69E","#FCE179","#FCAF79","#EE8B86","#C5AFC0","#DCD298","#DFBE95","#AADBEE","#CAE1B7","#FCE99C","#FCC49C","#F3A9A5","#D4C4D0","#E5DDB3","#E8CFB0","#D0EBF6","#E2EED7","#FEF3C8","#FEDFC8","#F8D0CE","#E7DEE5","#F1EDD5","#F2E4D4","#EAF6FB","#F2F7ED","#FEFAE6","#FEF0E6","#FCEAE9","#F4F0F3","#F8F7EC","#F9F3EB","#3FAED9","#88BB5D","#F9CE1F","#F97A1F","#9F7A95","#C4B454","#CA924E","#E33E35","#2694C0","#6EA244","#E0B406","#E06106","#CA241C","#85607C","#AB9A3B","#B17935","#1E7699","#588136","#B39005","#B34D05","#A21D16","#6A4D63","#897B2F","#8D612A"],shadedSkyColors:["#1E7699","#2694C0","#3FAED9","#55B7DD","#6AC0E2","#8CCEE8","#AADBEE","#D0EBF6","#EAF6FB"],getPalette:function(t,i,r){var f=t?n.colors.getShadedPalette(i):n.colors.standardColors,u;return r>0&&r<i?(u=n.data.clone(f),u[r]=n.colors.otherColor,u):f},setChartColors:function(n,t,i,r){t&&i?n.barColor(r):n.color(r)},getShadedPalette:function(t){var i=n.colors.shadedSkyColors;return t>=5&&t<=8&&(i=n.colors.shadedSkyColors.slice(1)),t<5&&(i=[n.colors.shadedSkyColors[1],n.colors.shadedSkyColors[3],n.colors.shadedSkyColors[5],n.colors.shadedSkyColors[7]]),i},getPaletteColor:function(n,t){return n[t%n.length]}}}(Sitecore.Speak.D3.models),function(n){n.tooltip=function(){function i(i){s=ut(i);t=s.createSVGPoint();document.body.appendChild(n)}function l(){return"pointerTop"}function a(){return[-5,0]}function v(){return" "}function y(){var t=c();return{top:t.y-n.getBoundingClientRect().height,left:t.x-n.getBoundingClientRect().width/2}}function p(){var i=r(),u=c(),t=n.getBoundingClientRect();return{top:i.n.y-t.height,left:u.x-t.width/2}}function w(){var t=r(),i=n.getBoundingClientRect();return{top:t.n.y-i.height,left:t.n.x-i.width/2}}function b(){var t=r();return{top:t.s.y,left:t.s.x-n.getBoundingClientRect().width/2}}function k(){var t=r();return{top:t.e.y-n.getBoundingClientRect().height/2,left:t.e.x}}function d(){var t=r();return{top:t.w.y-n.getBoundingClientRect().height/2,left:t.w.x-n.getBoundingClientRect().width}}function g(){var t=r();return{top:t.nw.y-n.getBoundingClientRect().height,left:t.nw.x-n.getBoundingClientRect().width}}function nt(){var t=r();return{top:t.ne.y-n.getBoundingClientRect().height,left:t.ne.x}}function tt(){var t=r();return{top:t.sw.y,left:t.sw.x-n.getBoundingClientRect().width}}function it(){var n=r();return{top:n.se.y,left:n.e.x}}function rt(){var n=d3.select(document.createElement("div"));return n.attr("class","d3-toolip"),n.style({position:"absolute",opacity:0,pointerEvents:"none",boxSizing:"border-box"}),n.node()}function ut(n){return(n=n.node(),n.tagName.toLowerCase()==="svg")?n:n.ownerSVGElement}function c(){var n={};return n.x=d3.event.clientX,n.y=d3.event.clientY,n}function r(){var e=h||d3.event.target,n={},i=e.getScreenCTM(),r=e.getBBox(),u=r.width||0,f=r.height||0,o=r.x||0,s=r.y||0,c=document.documentElement.scrollTop||document.body.scrollTop,l=document.documentElement.scrollLeft||document.body.scrollLeft;return t.x=o+l,t.y=s+c,n.nw=t.matrixTransform(i),t.x+=u,n.ne=t.matrixTransform(i),t.y+=f,n.se=t.matrixTransform(i),t.x-=u,n.sw=t.matrixTransform(i),t.y-=f/2,n.w=t.matrixTransform(i),t.x+=u,n.e=t.matrixTransform(i),t.x-=u/2,t.y-=f/2,n.n=t.matrixTransform(i),t.y+=f,n.s=t.matrixTransform(i),n}var u=l,f=a,e=v,n=rt(),s=null,t=null,h=null,o;return i.show=function(){var t=Array.prototype.slice.call(arguments);t[t.length-1]instanceof SVGElement&&(h=t.pop());var v=e.apply(this,t),c=f.apply(this,t),l=u.apply(this,t),r=d3.select(n),a=0,s;for(r.html(v).style({opacity:1,"pointer-events":"all"});a--;)r.classed(directions[a],!1);return s=o.get(l).apply(this),r.classed(l,!0).style({top:s.top+c[0]+"px",left:s.left+c[1]+"px"}),i},i.hide=function(){return nodel=d3.select(n),nodel.style({opacity:0,"pointer-events":"none"}),i},i.attr=function(t){if(arguments.length<2&&typeof t=="string")return d3.select(n).attr(t);var r=Array.prototype.slice.call(arguments);return d3.selection.prototype.attr.apply(d3.select(n),r),i},i.style=function(t){if(arguments.length<2&&typeof t=="string")return d3.select(n).style(t);var r=Array.prototype.slice.call(arguments);return d3.selection.prototype.style.apply(d3.select(n),r),i},i.direction=function(n){return arguments.length?(u=n==null?n:d3.functor(n),i):u},i.offset=function(n){return arguments.length?(f=n==null?n:d3.functor(n),i):f},i.html=function(n){return arguments.length?(e=n==null?n:d3.functor(n),i):e},o=d3.map({n:w,s:b,e:k,w:d,nw:g,ne:nt,sw:tt,se:it,pointerTop:p,pointer:y}),directions=o.keys(),i}}(Sitecore.Speak.D3.models),function(n,t){n.utilsConfig=Sitecore.Speak.version?{isDate:t.utils.is.date.bind(t.Helpers.date),isNumber:t.utils.is.number,isISODate:t.utils.date.isISO.bind(t.Helpers.date),parseISODate:t.utils.date.parseISO.bind(t.Helpers.Date)}:{isDate:_.isDate,isNumber:_.isNumber,isISODate:t.Helpers.date.isISO.bind(t.Helpers.date),parseISODate:t.Helpers.date.parseISO.bind(t.Helpers.date)}}(Sitecore.Speak.D3.models,Sitecore.Speak),function(n,t){t.utils={ellipse:function(n,t,i,r,u,f){var y;if(!n[0][0])return null;var e=n.text(),a=e.length,o=n.node().getComputedTextLength(),p=o,s=e,l=t-r-i-3;if(e.length===0)return e;var h=Math.floor(a/2),c=h,v=!1;if(o>l&&e.length>0)while(!v)u?(e=s.slice(a-c),n.text("..."+e)):(e=s.slice(0,c),n.text(e+"...")),o=n.node().getComputedTextLength(),h=Math.floor(h/2),h===0||Math.abs(o-l)<3?v=!0:c=o<l?c+h:c-h;return e===""&&(e=u?".."+s.slice(-1):s.slice(0,1)+"..",n.text(e)),o>=p&&n.text(s),y=n.text(),f&&typeof n.append=="function"&&(n.attr("pointer-events","auto"),n.select("title").remove(),n.append("title").text(s)),y},wrap:function(n,t,i){if(n[0][0]){var o=n.text().split(/\s+/).reverse(),f,u=[],h=0,s=n.attr("y"),e=parseFloat(n.attr("dy")),r=n.text(null).append("tspan").attr("x",0).attr("y",s);for(isNaN(e)||r.attr("dy",e+"em");o.length;)f=o.pop(),u.push(f),r.text(u.join(" ")),r.node().getComputedTextLength()>t&&(u.pop(),r.text(u.join(" ")),u=[f],r=n.append("tspan").attr("x",0).attr("y",s).attr("dy",++h*1.1+e+"em").text(f),i&&this.ellipse(r,t,1))}},showElements:function(n,t){n.classed("hide",!t)},setFillColor:function(n,t){n.style("fill",t)},getTopOffset:function(n){if(n.node()){var t=d3.transform(n.attr("transform"));return parseFloat(-t.translate[1])}return 0},setCanvasHeight:function(n,t,i,r,u,f){var e=this.getChartHeight(t,i,r,u,f);n.style({height:+e+"px"})},getChartHeight:function(n,i,r,u,f){var e=f?t.constants.yAxisLabelHeight:0;return e+=r?t.constants.chartTitleHeight:0,e+=u?t.constants.legend.legendItemHeight:0,n.parent().height()-e},getSerieIndex:function(n,i){var r=0,u=0;return n.some(function(n){if(n.legendState!==t.constants.legendState.unchecked){if(i===u)return!0;u++}r++}),r},getVisibleSerieIndex:function(n,i){var r=0,u=0;return n.some(function(n){if(n.legendState!==t.constants.legendState.unchecked){if(i===r)return!0;u++}r++}),u},setSingleSeriesNegativeColor:function(n,i,r){r&&t.utils.setFillColor(n.selectAll(i),t.colors.singleNegativeColor[0])},setSingleSeriesPositiveColor:function(n,i,r,u){r&&t.utils.setFillColor(n.selectAll(i),u)},hasDateCategory:function(n,i,r){if(i)return i.fieldType===t.constants.dataFormatType.date;var u=n[0].values[0];return u[r]?t.utilsConfig.isDate(u[r]):!1},hasNumberCategory:function(n,i,r){if(i)return i.fieldType===t.constants.dataFormatType.number;var u=n[0].values[0];return r in u?t.utilsConfig.isNumber(u[r]):!1},hasCurrencyCategory:function(n,i){return i?i.fieldType===t.constants.dataFormatType.currency:!1},getCanvasWidth:function(n,t){return n.width()-t.left-t.right},extendYDomainExcludeSeriesAt:function(n,t){var i=0,r=d3.min(n,function(n){if(i===t)return i++,Number.POSITIVE_INFINITY;i++;return d3.min(n.values,function(n){return n.y})}),u,f,e;return i=0,u=d3.max(n,function(n){if(i===t)return i++,Number.NEGATIVE_INFINITY;i++;return d3.max(n.values,function(n){return n.y})}),r===Number.POSITIVE_INFINITY&&(r=0),u===Number.NEGATIVE_INFINITY&&(u=0),f=Math.floor(r-(u-r)/10),r>=0&&f<0&&(f=0),e=Math.ceil(u+(u-r)/10),f===0&&e===0&&(e=1),[f,e]},extendYDomain:function(n){var t=d3.min(n,function(n){return d3.min(n.values,function(n){return n.y})}),u=d3.max(n,function(n){return d3.max(n.values,function(n){return n.y})}),i=Math.floor(t-(u-t)/10),r;return t>=0&&i<0&&(i=0),r=Math.ceil(u+(u-t)/10),i===0&&r===0&&(r=1),[i,r]},extendXDomain:function(n){var r=d3.min(n.chartData,function(n){return d3.min(n.values,function(n){return n.x})}),u=d3.max(n.chartData,function(n){return d3.max(n.values,function(n){return n.x})}),t=Math.floor(r-(u-r)/10),i,f;r>=0&&t<0&&(t=0);i=Math.ceil(u+(u-r)/10);t===i&&(t=Math.floor(t-t/10),i=Math.floor(i+i/10));f=[t,i];n.originalXDomain=[r,u];n.extendedXDomain=f;n.chartElement.bars.forceX(f);n.chartElement.lines.forceX(f);n.chartData[n.barSeriesIndex].values.splice(0,0,{x:t,y:0});n.chartData[n.barSeriesIndex].values.push({x:i,y:0})},setPieSizes:function(n,t,i,r){var f=n.width(),u=t;return i>0&&(i+=10),t>f-i&&(i===0?u=f:(u=f*.75,i=f-u)),r&&(u=f),d3.select("#svg-"+n.attr("data-sc-id")).style("width",u+"px"),d3.select("#svg-legend-"+n.attr("data-sc-id")).style("width",i+"px"),n.find(".svg-wrapper").width(u+i),{chartCanvasHeight:t,chartCanvasWidth:u,legendWidth:i}},getBBox:function(n){var t={};try{t=n.node().getBBox()}catch(i){}finally{t=t||{}}return t},getBBoxWidth:function(n){var t=this.getBBox(n);return t.width?t.width:0},getBBoxHeight:function(n){var t=this.getBBox(n);return t.height?t.height:0},shortenNumber:function(n,t){function r(n,t,i){var r=n.toString().split(".");return r[1]&&t!==0?r[0]+"."+r[1].substring(0,t)+i:r[0]+i}if(n<1)return"<1";var i=n=Math.floor(n);return n<1e3?n.toString().split(".")[0]:(t!==0&&(t=t||1),i=n/1e15,i>=1)?r(i,t,"Q"):(i=n/1e12,i>=1)?r(i,t,"T"):(i=n/1e9,i>=1)?r(i,t,"B"):(i=n/1e6,i>=1)?r(i,t,"M"):(i=n/1e3,i>=1)?r(i,t,"K"):n},hasPositiveSize:function(n,t){return n.height()-t.top-t.bottom>0&&n.width()-t.right-t.left>0},isVisible:function(n){return n.is(":visible")},isVisibleWithPositiveSize:function(n,t){return this.isVisible(n)&&this.hasPositiveSize(n,t)},setChartAnimation:function(n,i){n.duration(i?t.constants.animations.slow:t.constants.animations.none)}}}(Sitecore.Speak,Sitecore.Speak.D3.models),function(n){n.formatterConfig=n.formatterConfig||{dateFormatter:Sitecore.Speak.globalize.dateFormatter.bind(Sitecore.Speak.globalize),currencyFormatter:Sitecore.Speak.globalize.currencyFormatter.bind(Sitecore.Speak.globalize),numberFormatter:Sitecore.Speak.globalize.numberFormatter.bind(Sitecore.Speak.globalize)}}(Sitecore.Speak.D3.models),function(n){n.formatter={format:function(t,i){var u=function(n){return n},r,o,f,e;if(!i)return u(t);if(r={},o=i.fieldType,i.metricsFormat&&i.metricsFormat.numberScale)u=n.formatterConfig.metricsFormatter(i.metricsFormat);else switch(o){case n.constants.dataFormatType.date:case n.constants.dataFormatType.time:case n.constants.dataFormatType.datetime:i.formatCustom.length>0?(f=i.formatCustom,e="raw"):(f=i.formatPreset.value,e=i.formatPreset.type.toLowerCase());r[e]=f;u=n.formatterConfig.dateFormatter(r);break;case n.constants.dataFormatType.number:r={style:i.isPercentage?"percent":"decimal",round:i.roundingMethod.length>0?i.roundingMethod:"round",useGrouping:i.isThousandSeparated};i.numberOfDecimals>-1?(r.minimumFractionDigits=0,r.maximumFractionDigits=parseInt(i.numberOfDecimals)):(r.minimumFractionDigits=0,r.maximumFractionDigits=10);u=n.formatterConfig.numberFormatter(r);break;case n.constants.dataFormatType.currency:r={style:i.style.length>0?i.style.toLowerCase():"symbol",round:i.roundingMethod.length>0?i.roundingMethod:"round",useGrouping:i.isThousandSeparated};i.numberOfDecimals>-1?(r.minimumFractionDigits=0,r.maximumFractionDigits=parseInt(i.numberOfDecimals)):(r.minimumFractionDigits=0,r.maximumFractionDigits=10);u=n.formatterConfig.currencyFormatter(i.currency,r)}return u&&(t=u(t)),i.prefix=i.prefix||"",i.suffix=i.suffix||"",i.prefix+t+i.suffix}}}(Sitecore.Speak.D3.models),function(n){n.dispatcher=function(){"use strict";function n(n){return d3.dispatch(n)}return n.add=function(t){return n(t)},n}}(Sitecore.Speak.D3.models),function(n,t){t.data={initData:function(n,t,i,r,u,f){if(!this.validateData(n,t,r,u))return console.warn(r+": Invalid data"),null;t=this.validateSeriesDefinition(n,t,f);var e=[];return t.forEach(function(n){e.push([{key:"x",field:n.categoryFieldName},{key:"y",field:n.valueFieldName}])}),{data:this.mapData(n,e,i,t,u),seriesDefinitions:t}},validateSeriesDefinition:function(n,t,i){var u=0,r;return t.forEach(function(n){n.categoryDataFormatting&&(n.categoryDataFormatting.numberOfDecimals?(n.categoryDataFormatting.numberOfDecimals=parseInt(n.categoryDataFormatting.numberOfDecimals),isNaN(n.categoryDataFormatting.numberOfDecimals)&&(n.categoryDataFormatting.numberOfDecimals=-1)):n.categoryDataFormatting.numberOfDecimals=-1,isNaN(n.categoryDataFormatting.numberOfDecimals)&&(n.categoryDataFormatting.numberOfDecimals=-1));n.valueDataFormatting&&(n.valueDataFormatting.numberOfDecimals?(n.valueDataFormatting.numberOfDecimals=parseInt(n.valueDataFormatting.numberOfDecimals),isNaN(n.valueDataFormatting.numberOfDecimals)&&(n.categoryDataFormatting.numberOfDecimals=-1)):n.valueDataFormatting.numberOfDecimals=-1);u++}),r=[],n.forEach(function(u){var e=_.find(t,function(n){return n.seriesKey===u.key}),f;e?(this.setDataFormatting(n,e,i),r.push(e)):(f=this.clone(t[0]),f.seriesDisplayName=u.key,f.seriesKey=u.key,this.setDataFormatting(n,f,i),r.push(f))}.bind(this)),t=r},setDataFormatting:function(n,t,i){t.categoryDataFormatting||(t.categoryDataFormatting=this.setDefaultDataFormatting(n,t.categoryDataFormatting,t.categoryFieldName));t.valueDataFormatting||(t.valueDataFormatting=this.setDefaultDataFormatting(n,t.valueDataFormatting,t.valueFieldName));t.categoryDataFormatting=t.categoryDataFormatting||{};t.valueDataFormatting=t.valueDataFormatting||{};t.categoryDataFormatting.metricsFormat=i.xOptions;t.valueDataFormatting.metricsFormat=i.yOptions},setDefaultDataFormatting:function(n,i,r){var u;return u=t.utils.hasDateCategory(n,i,r)?t.constants.defaultDateDataFormatting:t.utils.hasNumberCategory(n,i,r)?this.clone(t.constants.defaultNumberDataFormatting):t.utils.hasCurrencyCategory(n,i)?t.constants.defaultCurrencyDataFormatting:null,u?this.clone(u):null},mapData:function(n,t,i,r,u){var f=0;return i?n.map(function(n){return this.initSeries(n,t[f],r[f++],u)}.bind(this)):this.initSingleSeries(n,t[0],r[0])},initSeries:function(n,i,r,u){var f={},o;for(var e in n)n.hasOwnProperty(e)&&(f.legendState=t.constants.legendState.checked,f.previusLegendState=f.legendState,f.displayName=r.seriesDisplayName?r.seriesDisplayName:n.key,e==="values"?(o=0,f.values=[],n.values.forEach(function(n){f.values.push({});i.forEach(function(i){if(i.field){var r=n[i.field];t.utilsConfig.isISODate(r)&&(r=t.utilsConfig.parseISODate(r));u===t.constants.chartType.combination?t.utilsConfig.isDate(r)&&(r=Date.parse(r)):t.utilsConfig.isDate(r)&&(r=new Date(r));f.values[o][i.key]=r}});o++})):f[e]=n[e]);return f},initSingleSeries:function(n,i){return n[0].values.map(function(n){var r={},u;r.legendState=t.constants.legendState.checked;r.previusLegendState=r.legendState;for(u in n)n.hasOwnProperty(u)&&i.forEach(function(i){if(i.field){var u=n[i.field];t.utilsConfig.isISODate(u)&&(u=t.utilsConfig.parseISODate(u));r[i.key]=u}});return r})},setCombinationChartLineSeriesIndex:function(n){var t=0;n.forEach(function(n){n.bar||(n.combinationChartLineSeriesIndex=t++)})},setSeriesPercentages:function(n){var i=this.sum(n),r=i!==0?100/i:0;n.forEach(function(n){n.percentage=t.data.round(n.y*r)})},setTooltipStackedSeriesPercentages:function(n){var i=d3.sum(n.series,function(n){return n.value}),r=i!==0?100/i:0;n.series.forEach(function(n){n.percentage=t.data.round(n.value*r)})},sum:function(n){return d3.sum(n,function(n){return n.y})},getVisibleSeriesSum:function(n,i){var r=d3.sum(n,function(n){return n.legendState===t.constants.legendState.unchecked?0:n.y}),u;return i?(u=t.data.sum(n),t.data.round(r/u*100)):r},round:function(n){return Math.round(n*100)/100},clone:function(n){return JSON.parse(JSON.stringify(n))},validateData:function(n,i,r,u){if(!n)return!1;var f=0;try{i.forEach(function(i){if(!i.categoryFieldName)throw"CategoryFieldName undefined!";if(!i.valueFieldName)throw"ValueFieldName undefined!";if(n[f]){if(!n[f].values[0].hasOwnProperty(i.categoryFieldName))throw"The Data does not contain '"+i.categoryFieldName+"' field";if(!n[f].values[0].hasOwnProperty(i.valueFieldName))throw"The Data does not contain '"+i.valueFieldName+"' field";if(u===t.constants.chartType.combination||u===t.constants.chartType.area||u===t.constants.chartType.line){var r=n[f].values[0][i.categoryFieldName];if(!t.utilsConfig.isDate(r)&&!t.utilsConfig.isISODate(r)&&!t.utilsConfig.isNumber(r))throw"Area, Line and Combination charts require a numerable (number or date) category.";}}f++})}catch(e){return console.warn(r+": "+e),!1}return!0},getBarToLineAxisScale:function(n,t){var i=n[1]-n[0];return i===0?0:(t[1]-t[0])/i},sortByValue:function(n){return n.sort(function(n,t){return t.y-n.y})},groupOtherSegment:function(n,t,i){if(t<n.length){var r=n.slice(t),u=d3.sum(r,function(n){return n.y});n=n.slice(0,t+1);n[t].x=i;n[t].y=u}return n},initializeSeriesDefinitions:function(n){return n&&n!=="[null]"?JSON.parse(n):[{categoryDataFormatting:null,valueDataFormatting:null,seriesDisplayName:null,seriesKey:null,categoryFieldName:"x",valueFieldName:"y"}]},initializeMetricsFormat:function(n){var t={xOptions:{numberScale:null,numberScaleUnits:null,numberScaleValues:null},yOptions:{numberScale:null,numberScaleUnits:null,numberScaleValues:null}};return t.xOptions.numberScale=n.xNumberScale,t.xOptions.numberScaleUnits=n.xNumberScaleUnits,t.xOptions.numberScaleValues=n.xNumberScaleValues,t.yOptions.numberScale=n.yNumberScale,t.yOptions.numberScaleUnits=n.yNumberScaleUnits,t.yOptions.numberScaleValues=n.yNumberScaleValues,t},selectedDataItem:function(n,t,i,r){return this.item={seriesKey:n,x:t,y:i,rawData:r},this.item}}}(Sitecore.Speak,Sitecore.Speak.D3.models);var globalizeDataTypes={date:"date",datetime:"datetime",time:"time",number:"number",currency:"currency",text:"text"},mediumDateFormat="medium";Sitecore.Speak.D3.models.constants={animations:{none:0,veryFast:50,fast:150,medium:250,quiteSlow:400,slow:500,verySlow:1e3},chartType:{bar:0,column:1,line:2,area:3,pie:4,doughnut:5,combination:6},legend:{iconSize:12,gapIconText:5,textPosition:17,legendItemHeight:20,legendItemsMargin:20},yAxisLabelHeight:18,chartTitleHeight:48,categoryInformation:{legend:"Legend",calloutLabels:"Callout Labels",none:"None"},eventType:{mouseClick:0,mouseOver:1,mouseOut:2},legendState:{checked:0,unchecked:1,disengaged:2,hover:3},legendMode:{exclusiveCheck:0,multipleCheck:1},visualizationMode:{standard:0,notVisible:1,emphasized:2,deemphasized:3},dataFormatType:globalizeDataTypes,defaultDateFormat:mediumDateFormat,defaultDateType:globalizeDataTypes.date,defaultDateDataFormatting:{prefix:"",suffix:"",formatCustom:"",fieldType:globalizeDataTypes.date,formatPreset:{type:globalizeDataTypes.date,value:mediumDateFormat}},defaultNumberDataFormatting:{prefix:"",suffix:"",fieldType:globalizeDataTypes.number,isPercentage:!1,roundingMethod:"round",numberOfDecimals:-1,isThousandSeparated:!0},defaultCurrencyDataFormatting:{currency:"USD",style:"symbol",prefix:"",suffix:"",fieldType:globalizeDataTypes.number,isPercentage:!1,roundingMethod:"round",numberOfDecimals:-1,isThousandSeparated:!0},defaultNumberDataFormattingForPercentages:{prefix:"",suffix:"",fieldType:globalizeDataTypes.number,isPercentage:!0,roundingMethod:"round",numberOfDecimals:2,isThousandSeparated:!0},pieLabelsVisibilityThreshold:200,darkerLayerOpacity:.4,brighterLayerOpacity:.8,legendItemBrighterLayerOpacity:.2,doughnutLabelsVisibilityThreshold:125,doughnutRadio:.52,pieLabelAngleThreshold:.1,idSelector:"data-sc-id",darkLayerColor:"black",brightLayerColor:"white",darkLabelColor:"black",brightLabelColor:"white",trimFromStart:"TrimFromStart",allSeries:"all"};Sitecore.Speak.D3.models.chartProperties=function(){function n(){this.componentElement=null;this.canvasId=null;this.chartElement=null;this.svgElement=null;this.chartData=null;this.palette=[];this.isSingleSeries=!1;this.isLegendVisible=!1;this.margin={left:0,right:0,top:5,bottom:0};this.chartType=null;this.legendMode=null;this.numberOfItems=0}return n}(),function(n){n.nvd3Legend={styleLegendIcon:function(n){n.selectAll(".nv-series")[0].forEach(function(n){var i=d3.select(n),t=i.select("circle");if(t.node()){var r=t.style("fill"),u=t.style("stroke"),f=t.style("stroke-width"),e=t.style("fill-opacity");t.remove();i.append("rect").attr("x",-5).attr("y",-5).attr("width",10).attr("height",10).style("fill",r).style("stroke",u).style("stroke-width",f).style("fill-opacity",e)}})},handleLegendState:function(t,i,r,u){var f,e;if(i.chartData.length!==0){if(r>=0){e=i.chartData[r].legendState;switch(u){case n.constants.eventType.mouseClick:if(this.removeLegendItemEmphasis(t,r),n.nvd3VisualizationManager.removeAllInsideLines(i.svgElement),i.legendMode===n.constants.legendMode.multipleCheck)switch(e){case n.constants.legendState.checked:this.isLastCheckedLegendItem(i.chartData,r)?i.chartData.forEach(function(t){t.legendState=n.constants.legendState.checked}):i.chartData[r].legendState=n.constants.legendState.unchecked;break;case n.constants.legendState.unchecked:i.chartData[r].legendState=n.constants.legendState.checked}else switch(e){case n.constants.legendState.checked:if(this.areAllLegendItemsChecked(i.chartData)){for(f=0;f<i.chartData.length;f++)f!==r&&(i.chartData[f].legendState=n.constants.legendState.disengaged);i.selectedIndex=r}else{if(this.isLastCheckedLegendItem(i.chartData,r))for(f=0;f<i.chartData.length;f++)i.chartData[f].legendState=n.constants.legendState.checked;i.selectedIndex=-1}break;case n.constants.legendState.disengaged:for(i.chartData[r].legendState=n.constants.legendState.checked,f=0;f<i.chartData.length;f++)f!==r&&(i.chartData[f].legendState=n.constants.legendState.disengaged);i.selectedIndex=r}break;case n.constants.eventType.mouseOver:e===n.constants.legendState.disengaged&&this.engageLegendIcon(t,r);e!==n.constants.legendState.unchecked&&this.setLegendItemMouseOver(t,r);return;case n.constants.eventType.mouseOut:e!==n.constants.legendState.unchecked&&this.setLegendItemMouseOut(t,r);e===n.constants.legendState.disengaged&&this.disengageLegendIcon(t,r);return}}f=0;i.chartData.forEach(function(n){n.previusLegendState!==n.legendState&&(n.previusLegendState=n.legendState,this.setChartVisualization(n,f,i,t));f++}.bind(this))}},setChartVisualization:function(t,i,r,u){switch(t.legendState){case n.constants.legendState.checked:this.selectLegendIcon(u,i,!0);t.disabled=!1;n.nvd3VisualizationManager.setSeriesVisualization(r.svgElement,r.chartData,i,n.constants.visualizationMode.standard,r.chartType,!1);r.chartType===n.constants.chartType.pie&&n.nvd3Axis.setValueLabelsColor(r.svgElement,i,r.chartType,n.constants.visualizationMode.standard);break;case n.constants.legendState.unchecked:this.selectLegendIcon(u,i,!1);t.disabled=!0;n.nvd3VisualizationManager.setSeriesVisualization(r.svgElement,r.chartData,i,n.constants.visualizationMode.notVisible,r.chartType,!1);break;case n.constants.legendState.disengaged:this.disengageLegendIcon(u,i);t.disabled=!1;switch(r.chartType){case n.constants.chartType.combination:r.chartData[i].bar?n.nvd3VisualizationManager.setRectSeriesVisualization(r.svgElement,r.chartData,i,n.constants.visualizationMode.deemphasized,r.chartType,!1):n.nvd3VisualizationManager.setPathSeriesVisualization(r.svgElement,r.chartData,i,n.constants.visualizationMode.deemphasized,r.chartType,!1);break;case n.constants.chartType.column:case n.constants.chartType.bar:n.nvd3VisualizationManager.setRectSeriesVisualization(r.svgElement,r.chartData,i,n.constants.visualizationMode.deemphasized,r.chartType,!1);break;case n.constants.chartType.area:case n.constants.chartType.line:case n.constants.chartType.pie:case n.constants.chartType.doughnut:n.nvd3VisualizationManager.setPathSeriesVisualization(r.svgElement,r.chartData,i,n.constants.visualizationMode.deemphasized,r.chartType,!1);r.chartType===n.constants.chartType.pie&&n.nvd3Axis.setValueLabelsColor(r.svgElement,i,r.chartType,n.constants.visualizationMode.deemphasized)}}},reloadLegendState:function(n,t){var i=0;n.chartData.forEach(function(r){this.setChartVisualization(r,i,n,t);i++}.bind(this))},setLegendItemMouseOver:function(t,i){var r=t.select(".nv-series:nth-child("+(i+1)+")"),u=r.select("rect.icon");this.emphasizeLegendIcons(r,u,i,n.constants.visualizationMode.emphasized);r.select("text").style("text-decoration","underline")},setLegendItemMouseOut:function(t,i){var r=t.select(".nv-series:nth-child("+(i+1)+")"),u=r.select("rect.icon");this.emphasizeLegendIcons(r,u,i,n.constants.visualizationMode.standard);r.select("text").style("text-decoration","none")},selectLegendIcon:function(n,t,i){var r=n.select(".nv-series:nth-child("+(t+1)+")"),u=r.select("rect.icon");this.engageLegendIcon(n,t);u.style("fill-opacity",i?1:0)},engageLegendIcon:function(n,t){var i=n.select(".nv-series:nth-child("+(t+1)+") ");i.style("opacity",1)},disengageLegendIcon:function(t,i){var r=t.select(".nv-series:nth-child("+(i+1)+") ");r.style("opacity",n.constants.legendItemBrighterLayerOpacity)},emphasizeLegendIcons:function(t,i,r,u){n.nvd3VisualizationManager.setRectElementsVisualization(t,i,r,null,u,1);return},removeLegendItemEmphasis:function(t,i){n.nvd3VisualizationManager.removeAllEmphasizeLayers(t);var r=t.select(".nv-series:nth-child("+(i+1)+")");r.select("text").style("text-decoration","none")},isLastCheckedLegendItem:function(t,i){for(var r=0;r<t.length;r++)if(r!==i&&t[r].legendState===n.constants.legendState.checked)return!1;return!0},areAllLegendItemsChecked:function(t){for(var i=0;i<t.length;i++)if(t[i].legendState!==n.constants.legendState.checked)return!1;return!0},centerLegend:function(n,t){var r=this.getLegendContainerElement(n),i=(n.width()-t)/2;i<0&&(i=0);r.attr("transform","translate("+i+", 0)")},centerVerticalLegend:function(t,i){var r=d3.select("#svg-legend-"+t.attr(n.constants.idSelector)),u=n.utils.getBBoxHeight(r),f=r.select(".nv-legendWrap.nvd3-svg"),e=(i-u)/2;f.attr("transform","translate(0, "+e+")")},createLegend:function(t){var f;if(!t.isLegendVisible){d3.select("#svg-legend-"+t.componentElement.attr(n.constants.idSelector)).style("height","0");return}d3.select("#svg-legend-"+t.componentElement.attr(n.constants.idSelector)).style("height",n.constants.legend.legendItemHeight+"px");var i=this.getLegendContainerElement(t.componentElement),u=n.constants.legend.iconSize,e=n.constants.legend.textPosition,s=t.chartData.length,h=t.componentElement.width()/s-e-n.constants.legend.legendItemsMargin,o=1,r=0;i.selectAll(".nv-series").remove();f=this;t.chartData.forEach(function(s){var l=i.append("g").attr("class","nv-series").attr("sc-series-index",r).attr("transform","translate("+o+", 2)"),a=l.append("rect").style("fill",n.constants.darkLayerColor).style("fill-opacity",0).attr("x",0).attr("y",1).attr("height",u+2).attr("sc-series-index",r),c,v;a.append("title").text(s.displayName);a.on("click",function(){var r,u;t.chartData.length!==0&&(r=parseInt(d3.select(this).attr("sc-series-index")),n.nvd3VisualizationManager.removeAllEmphasizeLayers(t.svgElement),n.nvd3VisualizationManager.setSeriesVisualization(t.svgElement,t.chartData,r,n.constants.visualizationMode.standard,t.chartType,!0),f.handleLegendState(i,t,r,n.constants.eventType.mouseClick),u=t.chartData[r],t.legendMode===n.constants.legendMode.multipleCheck&&(t.hasBarSeries&&(t.chartData[t.barSeriesIndex].legendState===n.constants.legendState.unchecked?t.chartElement.lines.forceX(t.originalXDomain):t.chartElement.lines.forceX(t.extendedXDomain)),t.chartElement.legend.dispatch.stateChange({disabled:t.chartData.map(function(n){return!!n.disabled}),disengaged:t.chartData.map(function(n){return!!n.disengaged})})),t.chartElement.legend.dispatch.legendClick(u,r))}).on("mouseover",function(){if(t.chartData.length!==0){var r=parseInt(d3.select(this).attr("sc-series-index"));(f.handleLegendState(i,t,r,n.constants.eventType.mouseOver,t),t.chartData[r].legendState!==n.constants.legendState.unchecked)&&(n.nvd3VisualizationManager.setSeriesVisualization(t.svgElement,t.chartData,r,n.constants.visualizationMode.emphasized,t.chartType,!1),t.chartElement.legend.dispatch.legendMouseover(t.chartData[r],r))}}).on("mouseout",function(){if(t.chartData.length!==0){var r=parseInt(d3.select(this).attr("sc-series-index")),u;(f.handleLegendState(i,t,r,n.constants.eventType.mouseOut),t.chartData[r].legendState!==n.constants.legendState.unchecked)&&(u=n.constants.visualizationMode.standard,t.chartData[r].legendState===n.constants.legendState.disengaged&&(u=n.constants.visualizationMode.deemphasized),n.nvd3VisualizationManager.setSeriesVisualization(t.svgElement,t.chartData,r,u,t.chartType,!1),t.chartElement.legend.dispatch.legendMouseout(t.chartData[r],r))}});c=l.append("text").attr("text-anchor","start").attr("class","nv-legend-text").attr("dx",e+"px").attr("x",0).attr("y",12).text(s.displayName).attr("pointer-events","none");v=l.append("rect").style("x",1).style("y",1).attr("width",u).attr("height",u).style("fill",n.colors.getPaletteColor(t.palette,r)).style("stroke",n.colors.getPaletteColor(t.palette,r)).style("stroke-width",2).style("fill-opacity",1).attr("pointer-events","none").classed("icon",!0);t.chartType!==n.constants.chartType.line&&t.chartType!==n.constants.chartType.area&&(t.chartType!==n.constants.chartType.combination||s.bar)||(v.attr("rx",u/2),v.attr("ry",u/2));a.attr("width",e+n.utils.getBBoxWidth(c));n.utils.ellipse(c,h,0,0,!1,!1);o+=e+c.node().getComputedTextLength()+n.constants.legend.legendItemsMargin;f.selectLegendIcon(i,r,!0);r++});t.legendWidth=o-n.constants.legend.legendItemsMargin;this.centerLegend(t.componentElement,t.legendWidth)},createVerticalLegend:function(t,i){var o,f;if(!t.isLegendVisible)return 0;o=d3.select("#svg-legend-"+t.componentElement.attr(n.constants.idSelector));o.style("height",i+"px");var r=this.getLegendContainerElement(t.componentElement),e=n.constants.legend.iconSize,s=n.constants.legend.textPosition,h=0,u=0;return r.selectAll(".nv-series").remove(),f=this,t.chartData.forEach(function(i){var o=r.append("g").attr("class","nv-series").attr("sc-series-index",u).attr("transform","translate(2, "+h+")"),c=o.append("rect").style("fill",n.constants.darkLayerColor).style("fill-opacity",0).attr("x",0).attr("y",0).attr("height",n.constants.legend.legendItemHeight).attr("sc-series-index",u),a,l;c.append("title").text(i.x);c.on("click",function(){var i,u;t.chartData.length!==0&&(n.nvd3VisualizationManager.removeAllEmphasizeLayers(t.svgElement),i=parseInt(d3.select(this).attr("sc-series-index")),n.nvd3VisualizationManager.setSeriesVisualization(t.svgElement,t.chartData,i,n.constants.visualizationMode.standard,t.chartType,!0),f.handleLegendState(r,t,i,n.constants.eventType.mouseClick),u=t.chartData[i],t.chartElement.duration(n.constants.animations.fast),t.legendMode===n.constants.legendMode.multipleCheck&&t.chartElement.legend.dispatch.stateChange({disabled:t.chartData.map(function(n){return!!n.disabled}),disengaged:t.chartData.map(function(n){return!!n.disengaged})}),t.chartElement.legend.dispatch.legendClick(u,i))}).on("mouseover",function(){if(t.chartData.length!==0){var i=parseInt(d3.select(this).attr("sc-series-index"));(f.handleLegendState(r,t,i,n.constants.eventType.mouseOver),t.chartData[i].legendState!==n.constants.legendState.unchecked)&&(n.nvd3VisualizationManager.setSeriesVisualization(t.svgElement,t.chartData,i,n.constants.visualizationMode.emphasized,t.chartType,!1),n.nvd3Axis.setValueLabelsColor(t.svgElement,i,t.chartType,n.constants.visualizationMode.emphasized),t.chartElement.legend.dispatch.legendMouseover(t.chartData[i],i))}}).on("mouseout",function(){if(t.chartData.length!==0){var i=parseInt(d3.select(this).attr("sc-series-index")),u;f.handleLegendState(r,t,i,n.constants.eventType.mouseOut);t.chartData[i].legendState!==n.constants.legendState.unchecked&&(u=n.constants.visualizationMode.notVisible,t.chartData[i].legendState===n.constants.legendState.disengaged&&(u=n.constants.visualizationMode.deemphasized),n.nvd3VisualizationManager.setSeriesVisualization(t.svgElement,t.chartData,i,u,t.chartType,!1),t.chartType===n.constants.chartType.pie&&n.nvd3Axis.setValueLabelsColor(t.svgElement,i,t.chartType,u));t.chartElement.legend.dispatch.legendMouseout(t.chartData[i],i)}});a=o.append("text").attr("text-anchor","start").attr("class","nv-legend-text").attr("dx",s+"px").attr("x",0).attr("y",12).text(i.x).attr("pointer-events","none");l=o.append("rect").attr("x",0).attr("y",1).attr("width",e).attr("height",e).style("fill",n.colors.getPaletteColor(t.palette,u)).style("stroke",n.colors.getPaletteColor(t.palette,u)).style("stroke-width",2).style("fill-opacity",1).attr("pointer-events","none").classed("icon",!0);(t.chartType===n.constants.chartType.pie||t.chartType===n.constants.chartType.doughnut)&&(l.attr("rx",e/2),l.attr("ry",e/2));c.attr("width",s+n.utils.getBBoxWidth(a));h+=n.constants.legend.legendItemHeight;f.selectLegendIcon(r,u,!0);u++}),this.centerVerticalLegend(t.componentElement,i),n.utils.getBBoxWidth(r)},ellipseVerticalLegend:function(t,i){if(i!==0){var r=i-n.constants.legend.textPosition,u=d3.select("#svg-legend-"+t.attr(n.constants.idSelector)+" g.nvd3.nv-legend"),f=u.selectAll(".nv-series text");f.each(function(){n.utils.ellipse(d3.select(this),r,0,0,!1,!1)})}},isLegendVisible:function(n,t){return!n&&!t},setLegendMode:function(t,i){return t.legendMode=i==="ExclusiveCheck"?n.constants.legendMode.exclusiveCheck:n.constants.legendMode.multipleCheck},getLegendContainerElement:function(t){return d3.select("#svg-legend-"+t.attr(n.constants.idSelector)+" g.nv-legendWrap.nvd3-svg g.nvd3.nv-legend")}}}(Sitecore.Speak.D3.models),function(n){n.nvd3Tooltip={setTooltip:function(t,i,r){var l="",a="",f,o,e,h=[],d,g,s,y,nt,tt,v=t.chartElement,u=t.chartData,w=t.palette,it=t.isSingleSeries,rt=t.isSeriesStacked,c=t.chartType,ut=t.barToLineAxisScale,p=u.length,k=t.valueFormatter,b=t.categoryFormatter;if(c===n.constants.chartType.pie||c===n.constants.chartType.doughnut){v.tooltip.contentGenerator(function(n){return a=n.data.y<0?" negativeValue":"",e="<table><thead><tr><td colspan='3'><strong class='x-value'>"+n.data.x+"<\/strong><\/td><\/tr><\/thead><tbody>",e+=this.createSingleSeriesTooltipContent(n.data.y,n.data.percentage,t.valueFormatter),e+="<\/tbody><\/table>"}.bind(this));return}if(c===n.constants.chartType.line||c===n.constants.chartType.area){l="rounded";v.interactiveLayer.tooltip.contentGenerator(function(t){if(!u||u.length===0)return"";for(nt=t.series[t.series.length-1].key&&t.series[t.series.length-1].key==="TOTAL",a=t.value<0?" negativeValue":"",e="<table><thead><tr><td colspan='3'><strong class='x-value "+a+"'>"+t.value+"<\/strong><\/td><\/tr><\/thead><tbody>",h=[],r&&n.data.setTooltipStackedSeriesPercentages(t),f=0;f<p;f++)if(o=i?p-1-f:f,u[o].legendState!==n.constants.legendState.unchecked){g=n.utils.getVisibleSerieIndex(u,o);y=n.colors.getPaletteColor(w,o);switch(c){case n.constants.chartType.line:u[o].values.length>=t.index&&t.index>=0&&h.push({key:u[o].displayName,value:u[o].values[t.index].y,color:y,legendState:u[o].legendState});break;case n.constants.chartType.area:s=t.series.length===1?0:t.series.length-(nt?2:1)-g;s>=0&&(d=r?t.series[s].percentage:t.series[s].value,t.series.length>s&&h.push({key:u[o].displayName,value:d,color:y,legendState:u[o].legendState}))}}return c===n.constants.chartType.line&&h.sort(function(n,t){return t.value-n.value}),h.forEach(function(n){e+=this.createSeriesTooltipContent(n.key,n.value,n.color,l,r,k,n.legendState)}.bind(this)),e+="<\/tbody><\/table>"}.bind(this));return}!it&&rt?v.tooltip.contentGenerator(function(t){for(e="<table><thead><tr><td colspan='3'><strong class='x-value'>"+this.formatValue(!1,b,t.value)+"<\/strong><\/td><\/tr><\/thead><tbody>",f=0;f<p;f++)(o=i?p-1-f:f,u[o].legendState!==n.constants.legendState.unchecked)&&(e+=this.createSeriesTooltipContent(u[o].displayName,u[o].values[t.index].y,d3.rgb(n.colors.getPaletteColor(w,o)).darker(1),l,r,k,n.constants.legendState.emphasized));return e+="<\/tbody><\/table>"}.bind(this)):it?v.tooltip.contentGenerator(function(n){return a=n.data.y<0?" negativeValue":"",e="<table><thead><tr><td><strong class='x-value'>"+this.formatValue(!1,b,n.value)+"<\/strong><\/td><\/tr><\/thead><tbody><tr><td class='value"+a+"'>"+n.data.y+"<\/td><\/tr><\/tbody><\/table>"}.bind(this)):c===n.constants.chartType.combination?v.tooltip.contentGenerator(function(i){h=[];var o=0;if(i.point)o=t.hasBarSeries?i.pointIndex+1:i.pointIndex;else if(o=i.index,i.index===0||i.index===t.chartData[0].values.length-1)return t.chartElement.tooltip.hidden(!0),"";if(!u[0].values[o])return"";for(e="<table><thead><tr><td colspan='3'><strong class='x-value'>"+this.formatValue(!1,b,u[0].values[o].x)+"<\/strong><\/td><\/tr><\/thead><tbody>",f=0;f<p;f++)u[f].legendState!==n.constants.legendState.unchecked&&(y=u[f].bar?d3.rgb(n.colors.getPaletteColor(w,f)).darker(1):n.colors.getPaletteColor(w,f),s=u[f].bar?o:o-1,u[f].values[s]&&(l=u[f].bar?"":"rounded",tt=u[f].bar?u[f].values[s].y*ut:u[f].values[s].y,h.push({key:u[f].displayName,value:u[f].values[s].y,scaledValue:tt,color:y,legendState:u[f].legendState,roundedClass:l,valueFormatter:u[f].bar?t.valueFormatter:t.valueFormatter2})));return h.sort(function(n,t){return t.scaledValue-n.scaledValue}),h.forEach(function(n){e+=this.createSeriesTooltipContent(n.key,n.value,n.color,n.roundedClass,r,n.valueFormatter,n.legendState)}.bind(this)),e+="<\/tbody><\/table>",t.dispatcher.tooltipShown(i),e}.bind(this)):v.tooltip.contentGenerator(function(t){return a=t.series[0].value<0?" negativeValue":"",e="<table><thead><tr><td colspan='3'><strong class='x-value'>"+this.formatValue(!1,b,t.value)+"<\/strong><\/td><\/tr><\/thead><tbody>",e+=this.createSeriesTooltipContent(u[n.utils.getSerieIndex(u,t.data.series)].displayName,t.series[0].value,d3.rgb(t.series[0].color).darker(1.5),l,r,k,n.constants.legendState.emphasized),e+="<\/tbody><\/table>"}.bind(this))},disableTooltip:function(t,i,r){if(r===n.constants.chartType.line||r===n.constants.chartType.area){i.interactiveLayer.tooltip.enabled(!t);return}i.tooltip.contentGenerator(function(){});return},formatValue:function(n,t,i){return t&&typeof t=="function"&&(i=t(i)),i},createSeriesTooltipContent:function(t,i,r,u,f,e,o){var c=i<0?" negativeValue":"",h,s;return i=this.formatValue(f,e,i),h=o===n.constants.legendState.disengaged?" opacity:"+n.constants.legendItemBrighterLayerOpacity+";":"",s="<tr><td class='legend-color-guide'><div class='"+u+"' style='background-color: "+r+"; "+h+"'><\/div><\/td>",s+="<td class='key'>"+t+"<\/td>",s+("<td class='value right-align"+c+"'>"+i+"<\/td><\/tr>")},createSingleSeriesTooltipContent:function(t,i,r){var e=t<0?" negativeValue":"",u,f;return r&&(t=r(t)),u="",i!=null&&(u="("+n.nvd3Axis.calculatedPercentageFormatter(i)+")"),f="<tr>",f+="<td class='value"+e+"'>"+t+"<\/td>",f+("<td class='value"+e+"'>"+u+"<\/td><td><\/td><\/tr>")},removeTooltipOnResize:function(){$(document.body).find("div.nvtooltip").css({transform:"translateX(-999px)"})}}}(Sitecore.Speak.D3.models),function(n){n.functionLines={getAverageLineData:function(t,i,r,u){var c=[],e=[],l=0,f=0,a,o,s,h;if(u){for(o=0;o<t[0].values.length;o++)e.push(0),t.forEach(function(t){t.legendState===n.constants.legendState.checked&&(e[o]+=t.values[o].y)});e.length>0&&(f=e.reduce(function(n,t){return n+t})/e.length)}else a=0,t.forEach(function(t){t.legendState===n.constants.legendState.checked&&(l=l+t.values.reduce(function(n,t){return a++,n+t.y},0))}),f=l/a;return f=parseFloat(f).toFixed(2),s={},s.x=i,s.y=f,c.push(s),h={},h.x=r,h.y=f,c.push(h),c},addAverageLine:function(t,i,r){var f=this.getAverageLineData(t.data,0,t.width+t.margin.left,t.isSeriesStacked),e=d3.svg.line().interpolate("basis").x(function(n){return n.x}).y(function(n){return t.chart.yAxis.scale()(n.y)}),u=d3.select(t.svgId+" .function-line");u.node()&&u.remove();i||(i=this.setFunctionLineTooltip(d3.select(t.svgId),r));u=d3.select(t.svgId+" "+t.parentNodeSelector).append("g").attr("class","function-line").style("opacity",0);u.append("path").datum(f).attr("class","average-line").attr("d",e).on("mouseover",function(n,t){i.show(n,t)}).on("mouseout",function(n,t){i.hide(n,t)});return u.append("text").attr("x",f[0].x).attr("y",t.chart.yAxis.scale()(f[0].y)-5).attr("text-anchor","start").attr("class","average-line-text").text("Average"),u.transition().duration(n.constants.animations.slow).style("opacity",1),i},setFunctionLineTooltip:function(t,i){var r=n.tooltip().html(function(n){var t=parseFloat(n[0].y),r=t<0?" negativeValue":"";return"<strong>Average<\/strong> <br/><br/><div class="+r+">"+i(t)+"<\/div>"});return t.call(r),r}}}(Sitecore.Speak.D3.models),function(n){n.nvd3Axis={ellipseXLabels:function(t,i,r,u){u=u||2;var f=t.selectAll(".nv-x.nv-axis.nvd3-svg text:not(.nv-axislabel)");f.each(function(){d3.select(this)&&n.utils.ellipse(d3.select(this),r,u,u,i===n.constants.trimFromStart,!0)})},ellipseXAxisLabel:function(t,i,r){var u=t.select("g.nv-x.nv-axis.nvd3-svg  text.nv-axislabel");n.utils.ellipse(u,i,0,0,r,!1)},ellipseYAxisLabel:function(t,i){var r=t.select("g.nv-y.nv-axis.nvd3-svg  text.nv-axislabel");n.utils.ellipse(r,i,0,0,!1,!0)},drawXaxis:function(n,t){var i=n.select(".nv-x.nv-axis.nvd3-svg .nvd3.nv-wrap.nv-axis g");i.selectAll(".sc-xAxis").remove();i.append("line").attr("x1",0).attr("y1",0).attr("x2",t).attr("y2",0).classed("sc-xAxis",!0);setTimeout(function(){for(var t=n.selectAll(".nv-x.nv-axis.nvd3-svg .tick"),r=0;r<t[0].length;r++){var f=t[0][r],e=d3.transform(d3.select(f).attr("transform")),u=parseFloat(e.translate[0]);i.append("line").attr("x1",u).attr("y1",0).attr("x2",u).attr("y2",5).classed("sc-xAxis",!0)}return t.length},Sitecore.Speak.D3.models.constants.animations.fast)},centerXAxisLabel:function(n,t){n.select("g.nv-x.nv-axis.nvd3-svg  text.nv-axislabel").attr("x",t/2)},centerYAxisLabel:function(n,t){n.select("g.nv-y.nv-axis.nvd3-svg  text.nv-axislabel").attr("x",t/2)},setVerticalAxisLabel:function(t,i){var u=n.utils.getTopOffset(t.select(".nv-legendWrap.nvd3-svg")),f=u-12,r=t.select(".nv-axislabel.custom");r.node()?r.text(i):t.append("text").attr("x",0).attr("y",f).attr("text-anchor","start").attr("class","nv-axislabel custom").text(i)},showXaxisLabels:function(t,i){var r=t.select("g.nvd3.nv-wrap.nv-axis"),u=t.select("nv-x.nv-axis.nvd3-svg .tick");if(!i){r.style("opacity",0);u.style("opacity",0);return}u.style("opacity",1);r.transition().duration(n.constants.animations.medium).style("opacity",1)},hideXaxisLabels:function(n){this.showXaxisLabels(n,!1)},removeOverlappingLabels:function(t,i,r,u){var a=5,v="",c=0,h,e,f,o;u===n.constants.chartType.combination?(v=".nv-focus ",c=t.select(".nv-x.nv-axis.nvd3-svg").node().getBoundingClientRect().right+a):(h=t.select(".nv-y.nv-axis.nvd3-svg .nvd3.nv-wrap.nv-axis g.tick:first-of-type line"),h.node()||(h=t.select(".nv-x.nv-axis.nvd3-svg")),c=h.node().getBoundingClientRect().right);var s=t.selectAll(v+".nv-x.nv-axis.nvd3-svg .tick"),y=i?1:0,l=i?s[0].length-1:s[0].length;if(l===0)return 0;if(r&&r<l)return-1;for(e=y;e<l;e++){if(f=s[0][e],o=s[0][e+1],f&&f.getBoundingClientRect&&f.getBoundingClientRect().right>c-a){d3.select(f).remove();continue}if(f&&o&&f.getBoundingClientRect&&o.getBoundingClientRect)while(f.getBoundingClientRect().right+10>o.getBoundingClientRect().left)if(d3.select(o).remove(),e++,o=s[0][e+1],!o)break}return s.length},createXaxis:function(t,i,r,u,f,e,o,s,h){var c=n.utils.getCanvasWidth(i,r);this.centerXAxisLabel(t,c);this.showXaxisLabels(t,!1);setTimeout(function(){var i=this.removeOverlappingLabels(t,f,s,h);i===-1?setTimeout(function(){this.removeOverlappingLabels(t,f,s,h);this.completeRemovingOverlappingLabels(t,o,f,u,c)}.bind(this),Sitecore.Speak.D3.models.constants.animations.slow):this.completeRemovingOverlappingLabels(t,o,f,u,c);n.nvd3Axis.ellipseXAxisLabel(t,c,e===n.constants.trimFromStart)}.bind(this),Sitecore.Speak.D3.models.constants.animations.slow)},completeRemovingOverlappingLabels:function(n,t,i,r,u){i&&this.removeXaxisMinMax(n,t);r&&this.drawXaxis(n,u);this.showXaxisLabels(n,!0)},removeXaxisMinMax:function(n,t){var i=n.selectAll("g.nv-focus > g.nv-x.nv-axis.nvd3-svg g.tick text"),r=i.filter(function(){return this.__data__===t[0]}),u=i.filter(function(){return this.__data__===t[1]});r&&r.classed("hide",!0);u&&u.classed("hide",!0)},showHighestYValue:function(n){n.selectAll("g.nv-y.nv-axis.nvd3-svg g.nvd3.nv-wrap.nv-axis .tick:last-of-type text").style("opacity",1)},removePieLabels:function(n){n.selectAll("g.nv-pieWrap.nvd3-svg > g > g > g.nv-pieLabels text").remove()},centerPieLabels:function(t,i,r,u,f){var h=this,c=this.setPieLabelsVisibility(t,i.chartCanvasWidth);if(c){var l=Math.min(i.chartCanvasHeight,i.chartCanvasWidth),e=l/2,o=d3.svg.arc().outerRadius(e*.65).innerRadius(e*.65);this.removePieLabels(t);var a=t.selectAll("g.nv-pieWrap.nvd3-svg > g > g > g.nv-pieLabels"),v=t.selectAll("g.nv-pieWrap.nvd3-svg g.nvd3.nv-wrap.nv-pie g.nv-pie path:not(.sc-emphasize-mask):not(.sc-deemphasize-mask)"),s=0;v.each(function(){var t=o.centroid(this._current)[0],i=o.centroid(this._current)[1],e=this._current.endAngle-this._current.startAngle;e>r&&a.append("text").attr({x:t,y:i+4}).style("text-anchor","middle").attr("class","sc-internal-label-text").attr("sc-series-index",s).attr("pointer-events","none").style("opacity",0).text(f?h.calculatedPercentageFormatter(this._current.data.percentage):u(this._current.data.y)).transition().duration(n.constants.animations.medium).style("opacity",1);s++})}},setValueLabelsColor:function(t,i,r,u){var o="",f=n.constants.darkLayerColor,e=1;switch(r){case n.constants.chartType.pie:o=".nv-pieLabels text[sc-series-index='"+i+"']"}if(o!==""){switch(u){case n.constants.visualizationMode.emphasized:f=n.constants.brightLabelColor;e=1;break;case n.constants.visualizationMode.deemphasized:f=n.constants.darkLayerColor;e=n.constants.legendItemBrighterLayerOpacity;break;case n.constants.visualizationMode.standard:f=n.constants.darkLayerColor;e=1}t.selectAll(o).transition().duration(n.constants.animations.fast).style("fill",f).style("opacity",e)}},resetValueLabelsColor:function(t,i){var r="";switch(i){case n.constants.chartType.pie:r=".nv-pieLabels .sc-internal-label-text"}r!==""&&t.selectAll(r+" text").style("fill",n.constants.darkLayerColor).style("opacity",1)},setPieLabelsVisibility:function(t,i){var r=i<n.constants.pieLabelsVisibilityThreshold;return t.selectAll(".nv-pieLabels").classed("hide",r),!r},setYAxisLabel:function(n,t){n.querySelector(".nv-axislabel.custom").innerHTML=t?t:""},setYAxisLabels:function(t,i,r){var e=n.constants.legend.iconSize/2,f=e+5,s=d3.select("#svg-yaxis-labels-"+t.attr(n.constants.idSelector)),h=s.select(".left-axis-group"),c=s.select(".right-axis-group"),l=10,u,o;h.selectAll("*").remove();c.selectAll("*").remove();var a=i.length,y=t.width()*.7/(a-1)-f,v=t.width();for(u=0;u<a;u++)i[u].legendState!==n.constants.legendState.unchecked&&(o=n.colors.getPaletteColor(r,u),i[u].bar?this.setCombinationYAxisSeriesNames(t.width()*.3-l-f,h,i[u].displayName,!0,o,e,1,u,f):v=this.setCombinationYAxisSeriesNames(y,c,i[u].displayName,!1,o,e,v,u,f)-l)},setCombinationYAxisSeriesNames:function(t,i,r,u,f,e,o,s,h){var p=n.constants.yAxisLabelHeight,c=i.append("g").attr("sc-series-index",s),w=c.append("rect").style("fill",n.constants.darkLayerColor).style("fill-opacity",0).attr("x",0).attr("y",1).attr("height",p).attr("sc-series-index",s),l,b,a,v,y;return w.append("title").text(r),l=c.append("text").attr("text-anchor","start").attr("class","nv-legend-text").attr("x",h).attr("y",12).text(r).attr("pointer-events","none"),n.utils.ellipse(l,t,0,0,!1,!1),b=n.utils.getBBoxWidth(l),a=c.append("rect").attr("x",1).attr("y",(p-e)/2-1).attr("width",e).attr("height",e).style("fill",f).style("stroke",f).style("stroke-width",2).style("fill-opacity",1).attr("pointer-events","none").classed("icon",!0),u||(a.attr("rx",e/2),a.attr("ry",e/2)),v=h+b,w.attr("width",v),y=u?0:o-v,c.attr("transform","translate("+y+", 0)"),y},setCombinationChartRightYAxisLabels:function(t,i,r,u){var f="g.nvd3.nv-wrap.nv-linePlusBar g.nv-focus";if(r){t.select(f+" g.nvd3.nv-wrap.nv-axis.custom").remove();t.selectAll(f+" g.nv-y2.nv-axis.nvd3-svg .tick text").style("display","inline");return}t.select(f+" g.nvd3.nv-wrap.nv-axis.custom").remove();t.selectAll(f+" g.nv-y2.nv-axis.nvd3-svg .tick text").style("display","none");setTimeout(function(){var e=t.selectAll(f+" g.nv-y1.nv-axis.nvd3-svg > g > g > .tick"),o=t.select(f+" g.nv-y2.nv-axis.nvd3-svg"),r=0,s=o.append("g").style("opacity",0).classed("nvd3 nv-wrap nv-axis custom",!0),h=s.append("g");e.each(function(){var e=d3.select(this),o=d3.transform(e.attr("transform")),n=parseFloat(o.translate[1]),t=i.y2Axis.scale().invert(n),f;u&&(t=u(i.y2Axis.scale().invert(n)));f=h.append("g").classed(r===0?"tick zero":"tick",!0).style("opacity",1).attr("transform","translate(0,"+n+")");f.append("text").attr("dy",".32em").attr("x",3).attr("y",0).style("text-anchor","start").text(t);r++});t.select(f+" g.nvd3.nv-wrap.nv-axis.custom").transition().duration(n.constants.animations.medium).style("opacity",1)},n.constants.animations.slow)},setDoughnutInternalLabels:function(t,i,r,u,f){var a,h;i=i?i.toString():"";u=u?u.toString():"";var c=!1,l=t.select("g.nv-pieWrap.nvd3-svg g.nvd3.nv-wrap.nv-pie g.nv-pie"),s=Math.min(f.chartCanvasHeight,f.chartCanvasWidth);if(s<n.constants.doughnutLabelsVisibilityThreshold){l.select(".sc-doughnut-label").remove();return}a=14;s<200&&(a+=(200-s)/8);var v=s*.8/2-a,e=Math.floor(s/10),b=e*.75,k=e*.5,o,y,p,w;l.select(".sc-doughnut-label").remove();o=l.append("g").style("opacity",0).classed("sc-doughnut-label",!0);i.length>0&&(y=o.append("text").attr("text-anchor","middle").classed("sc-doughnut-label-all-categories",!0).text(i));p=o.append("text").attr("text-anchor","middle").attr("transform","translate(0,0)").style("font-weight","bold").classed("sc-doughnut-label-value",!0).text(r);u.length>0&&(w=o.append("text").attr("text-anchor","middle").classed("sc-doughnut-label-value-description",!0).text(u));h=e/3;i.length===0&&u.length>0&&(h=-(e/5));i.length>0&&u.length===0&&(h=e);o.attr("transform","translate(0,"+h+")");i.length>0&&(y.attr("transform","translate(0, -"+b*1.6+")").style("font-size",b+"px"),n.utils.ellipse(y,v,0,0,c,!1));p.style("font-size",e+"px");n.utils.ellipse(p,v,0,0,c,!0);u.length>0&&(w.attr("transform","translate(0,"+k*1.6+")").style("font-size",k+"px"),n.utils.ellipse(w,v,0,0,c,!1));o.transition().duration(n.constants.animations.medium).style("opacity",1)},createDoughnutCalloutLabels:function(t,i,r){var u=t.svgElement,g=t.chartData,v=t.palette,f=t.sizes,y=t.valueFormatter,p=this,o=Math.min(f.chartCanvasHeight,f.chartCanvasWidth),w=u.select("g.nv-pieWrap.nvd3-svg g.nvd3.nv-wrap.nv-pie g");if(this.removeDoughnutLabels(u),!(o<n.constants.doughnutLabelsVisibilityThreshold)){var b=u.selectAll("g.nv-pieWrap.nvd3-svg g.nvd3.nv-wrap.nv-pie g.nv-pie"),h=b.attr("transform"),k=d3.transform(h),e=parseFloat(k.translate[0]),c=w.insert("g",":first-child").attr("transform",h).attr("class","sc-labels-lines"),l=o/2,a=d3.svg.arc().outerRadius(l*.8-1).innerRadius(l*.8-1),d=u.selectAll("g.nv-pieWrap.nvd3-svg g.nvd3.nv-wrap.nv-pie g.nv-pie path:not(.sc-emphasize-mask):not(.sc-deemphasize-mask)"),s=0;d.each(function(){var et=this._current.startAngle,ot=this._current.endAngle,st=(et+ot)/2,h=o/10,k="start",d=2,g=st>Math.PI,ft;g&&(h=-h,k="end",d=-2);var l=a.centroid(this._current)[0],nt=l+h,tt=a.centroid(this._current)[1],it=tt,t=nt+d,rt=c.append("line").attr({x1:l,y1:tt,x2:l,y2:it}).style("stroke",n.colors.getPaletteColor(v,s)).attr("class","sc-label-line").attr("sc-series-index",s),w=this._current.data.x;i&&(w+=r?"  "+p.calculatedPercentageFormatter(this._current.data.percentage):"  "+y(this._current.data.y));var u=c.append("text").attr({x:t,y:it+4}).style("text-anchor",k).attr("class","sc-label-text").style("opacity",0).text(w),ut=u.node().getComputedTextLength(),b=w;g?e+t-ut<0&&(b=n.utils.ellipse(u,e+t,2,2,!1,!0)):t+ut+e>f.chartCanvasWidth&&(b=n.utils.ellipse(u,f.chartCanvasWidth-e-t,2,2,!1,!0));ft=b.toString().replace("...","").replace("..","");ft.length<=2?(u.remove(),rt.remove()):(rt.transition().duration(n.constants.animations.medium).attr("x2",nt),u.transition().duration(n.constants.animations.medium).style("opacity",1),s++)})}},removeDoughnutLabels:function(n){n.select("g.nv-pieWrap.nvd3-svg g.nvd3.nv-wrap.nv-pie g .sc-labels-lines").remove()},showCustomAxisLabel:function(n){n.find(".nv-axislabel.custom").toggle(!0)},hideCustomAxisLabel:function(n){n.find(".nv-axislabel.custom").toggle(!1)},formatAxisLabels:function(n){this.formatCategoryAxisLabels(n);this.formatValueAxisLabels(n)},formatCombinationAxisLabels:function(n){this.formatCombinationCategoryAxisLabels(n);this.formatCombinationValueAxisLabels(n)},formatCategoryAxisLabels:function(t){t.seriesDefinitions[0].categoryDataFormatting&&(t.categoryFormatter=function(i){return n.formatter.format(i,t.seriesDefinitions[0].categoryDataFormatting)},t.chartElement.xAxis.tickFormat(function(n){return t.categoryFormatter(n)}))},formatValueAxisLabels:function(t){t.seriesDefinitions[0].valueDataFormatting&&(t.valueFormatter=function(i){return n.formatter.format(i,t.seriesDefinitions[0].valueDataFormatting)},t.chartElement.yAxis.tickFormat(function(n){return t.valueFormatter(n)}))},formatCombinationCategoryAxisLabels:function(t){t.seriesDefinitions[0].categoryDataFormatting&&(t.categoryFormatter=function(i){return t.hasDateCategory&&(i=new Date(i)),n.formatter.format(i,t.seriesDefinitions[0].categoryDataFormatting)},t.chartElement.xAxis.tickFormat(function(n){return t.categoryFormatter(n)}))},formatCombinationValueAxisLabels:function(t){var r=t.hasBarSeries?t.barSeriesIndex:0,i;for(t.seriesDefinitions[r].valueDataFormatting&&(t.valueFormatter=function(i){return n.formatter.format(i,t.seriesDefinitions[r].valueDataFormatting)},t.chartElement.y1Axis.tickFormat(function(n){return t.valueFormatter(n)})),i=0;i<t.chartData.length;i++)if(!t.chartData[i].bar&&t.seriesDefinitions[i].valueDataFormatting){t.valueFormatter2=function(r){return n.formatter.format(r,t.seriesDefinitions[i].valueDataFormatting)};t.chartElement.y2Axis.tickFormat(function(n){return t.valueFormatter2(n)});return}},formatPieValueLabels:function(t){t.seriesDefinitions[0].valueDataFormatting&&(t.valueFormatter=function(i){return n.formatter.format(i,t.seriesDefinitions[0].valueDataFormatting)},t.chartElement.valueFormat(function(n){return t.valueFormatter(n)}))},calculatedPercentageFormatter:function(t){return n.formatter.format(t/100,n.constants.defaultNumberDataFormattingForPercentages)},validateNoData:function(t,i,r,u,f){var e=d3.select("#svg-legend-"+i.componentElement.attr(n.constants.idSelector)),o=d3.select(i.canvasId),s=i.componentElement.find("div.sc-d3-nodata-panel");return!t||t.length===0?(i.chartData=[],n.nvd3Tooltip.disableTooltip(!0,i.chartElement,i.chartType),i.chartType===n.constants.chartType.combination&&d3.select("#svg-yaxis-labels-"+i.componentElement.attr(n.constants.idSelector)).attr("opacity",0),this.hideCustomAxisLabel(i.componentElement),e.classed("hide",!0),o.selectAll("*").remove(),o.html(""),s.toggle(!0),!1):(s.toggle(!1),i.chartType===n.constants.chartType.combination&&d3.select("#svg-yaxis-labels-"+i.componentElement.attr(n.constants.idSelector)).attr("opacity",1),n.nvd3Tooltip.disableTooltip(!f,i.chartElement,i.chartType),this.showCustomAxisLabel(i.componentElement),e.classed("hide",!1),!0)},showLineChartMaxYLabel:function(n){this.showChartMaxYLabel(n,".nvd3.nv-wrap.nv-lineChart")},showAreaChartMaxYLabel:function(n){this.showChartMaxYLabel(n,".nvd3.nv-wrap.nv-stackedAreaChart")},showChartMaxYLabel:function(n,t){setTimeout(function(){var r=n.selectAll(t+" .nv-y.nv-axis.nvd3-svg .nvd3.nv-wrap.nv-axis g.tick")[0].length,i=n.selectAll(t+" .nv-y.nv-axis.nvd3-svg .nvd3.nv-wrap.nv-axis .nv-axisMaxMin.nv-axisMaxMin-y.nv-axisMax-y");r<2?i.style("display","block"):i.style("display","none")},Sitecore.Speak.D3.models.constants.animations.slow)}}}(Sitecore.Speak.D3.models),function(n){n.nvd3VisualizationManager={setSeriesVisualization:function(t,i,r,u,f,e){switch(f){case n.constants.chartType.combination:i[r].bar?n.nvd3VisualizationManager.setRectSeriesVisualization(t,i,r,u,f,e):n.nvd3VisualizationManager.setPathSeriesVisualization(t,i,r,u,f,e);break;case n.constants.chartType.column:case n.constants.chartType.bar:n.nvd3VisualizationManager.setRectSeriesVisualization(t,i,r,u,f,e);break;case n.constants.chartType.area:case n.constants.chartType.line:case n.constants.chartType.pie:case n.constants.chartType.doughnut:n.nvd3VisualizationManager.setPathSeriesVisualization(t,i,r,u,f,e)}},removeCombinationDummyBars:function(n,t){var i=n.select("g.nv-barsWrap.nvd3-svg rect.nv-bar-0-0"),r=n.select("g.nv-barsWrap.nvd3-svg rect.nv-bar-0-"+(t-1));i.style("opacity",0);r.style("opacity",0)},setRectSeriesVisualization:function(t,i,r,u,f,e){var o;o=f===n.constants.chartType.combination?t.selectAll("g.nv-focus g.nv-barsWrap.nvd3-svg g.nv-bars rect:not(.sc-emphasize-mask):not(.sc-deemphasize-mask)"):t.selectAll("g.nv-group.nv-series-"+n.utils.getVisibleSerieIndex(i,r)+" rect:not(.sc-emphasize-mask):not(.sc-deemphasize-mask)");this.setRectElementsVisualization(t,o,r,null,u,0,f);e&&this.resetRectElementsVisualization(t)},setPathSeriesVisualization:function(t,i,r,u,f,e){var o,s;switch(f){case n.constants.chartType.combination:o=t.select("g.nv-linesWrap.nvd3-svg g.nv-group.nv-series-"+i[r].combinationChartLineSeriesIndex+" path.nv-line:not(.sc-emphasize-mask):not(.sc-deemphasize-mask)");break;case n.constants.chartType.line:o=t.select("g.nv-linesWrap.nvd3-svg > g > g > g.nv-groups >  g.nv-group.nv-series-"+n.utils.getVisibleSerieIndex(i,r)+" path:not(.sc-emphasize-mask):not(.sc-deemphasize-mask)");break;case n.constants.chartType.area:s=n.utils.getVisibleSerieIndex(i,r)+1;o=t.select("g.nv-areaWrap path:nth-child("+s+"):not(.sc-emphasize-mask):not(.sc-deemphasize-mask)");break;case n.constants.chartType.pie:case n.constants.chartType.doughnut:o=t.select("g.nv-pieWrap .nv-pie g:nth-child("+(r+1)+") > path:not(.sc-emphasize-mask):not(.sc-deemphasize-mask)")}this.setPathElementsVisualization(t,o,r,u,f);e&&this.resetPathElementsVisualization(t,o,f)},setRectElementsVisualization:function(t,i,r,u,f,e,o){var h,c,s;if(i&&i[0].length!==0){h=this;c=0;switch(f){case n.constants.visualizationMode.emphasized:case n.constants.visualizationMode.deemphasized:var l=n.constants.darkerLayerOpacity,a=n.constants.darkLayerColor,v="sc-emphasize-mask";f===n.constants.visualizationMode.deemphasized&&(a=n.constants.brightLayerColor,v="sc-deemphasize-mask",l=n.constants.brighterLayerOpacity);i.each(function(){var t=d3.select(this);if(t.style("opacity")>0){var i=n.utils.getBBox(t),y=d3.select(this.parentNode),p=d3.transform(t.attr("transform")),w=parseFloat(p.translate[0]),b=parseFloat(p.translate[1]),k=i.x?i.x:0,d=i.y?i.y:0;s=o===n.constants.chartType.combination?h.getCombinationBarIndex(t,u,c):u?u:c;s||(s=0);y.append("rect").attr("x",k+w-e/2).attr("y",d+b-e/2).attr("width",i.width+e).attr("height",i.height+e).attr("rx",t.attr("rx")).attr("ry",t.attr("ry")).attr("class",v).attr("sc-series-index",r).attr("sc-category-index",s).style("fill",a).style("fill-opacity",0).transition().duration(n.constants.animations.medium).style("fill-opacity",l);f===n.constants.visualizationMode.emphasized&&h.removeDeemphasizeLayer(y,r,s);f===n.constants.visualizationMode.deemphasized&&h.removeEmphasizeLayer(y,r,s)}c++});break;case n.constants.visualizationMode.standard:i.each(function(){s=u?u:c;var n=d3.select(this.parentNode);h.removeDeemphasizeLayer(n,r,s);h.removeEmphasizeLayer(n,r,s);c++});break;case n.constants.visualizationMode.notVisible:i.each(function(){s=u?u:c;h.removeDeemphasizeLayer(t,r,s);h.removeEmphasizeLayer(t,r,s);c++})}}},getCombinationBarIndex:function(n,t,i){var u=0,e=n.attr("class"),o=e.indexOf("nv-bar-0-"),r,f;return o>-1?(r=e.slice(o).replace("nv-bar-0-",""),f=r.indexOf(" hover"),u=f>-1?parseInt(r.slice(0,f)):parseInt(r)):u=t?t:i,u},setPathElementsVisualization:function(t,i,r,u,f){var e=this,h=0,o,s;switch(u){case n.constants.visualizationMode.emphasized:case n.constants.visualizationMode.deemphasized:o=n.constants.darkerLayerOpacity;s="sc-emphasize-mask";u===n.constants.visualizationMode.deemphasized&&(s="sc-deemphasize-mask",o=n.constants.brighterLayerOpacity);i.each(function(){var t=d3.select(this),h=t.attr("d"),c=t.attr("transform"),i=d3.select(this.parentNode),l=f===n.constants.chartType.line||f===n.constants.chartType.combination?"none":u===n.constants.visualizationMode.emphasized?n.constants.darkLayerColor:n.constants.brightLayerColor,a=f===n.constants.chartType.line||f===n.constants.chartType.combination?"nv-line":"nv-area",v=f===n.constants.chartType.line||f===n.constants.chartType.combination?u===n.constants.visualizationMode.deemphasized?"4px":"3px":"0";f===n.constants.chartType.area&&t.style("stroke-width",0);i.append("path").attr("d",h).attr("transform",c).style("stroke-width",v).style("fill",l).style("stroke-opacity","0").style("fill-opacity","0").attr("class",a+" "+s).attr("sc-series-index",r).attr("sc-category-index",r).transition().duration(n.constants.animations.fast).ease("sine").style("stroke-opacity",o).style("fill-opacity",o);u===n.constants.visualizationMode.emphasized&&e.removeDeemphasizeLayer(i,r,r);u===n.constants.visualizationMode.deemphasized&&e.removeEmphasizeLayer(i,r,r)});break;case n.constants.visualizationMode.standard:f===n.constants.chartType.area&&i.each(function(){d3.select(this).style("stroke-width",1)});i.each(function(){var n=d3.select(this.parentNode);e.removeDeemphasizeLayer(n,r,r);e.removeEmphasizeLayer(n,r,r);h++});break;case n.constants.visualizationMode.notVisible:i.each(function(){e.removeDeemphasizeLayer(t,r,r);e.removeEmphasizeLayer(t,r,r);h++})}},removeEmphasizeLayer:function(t,i,r){var u=t.selectAll(".sc-emphasize-mask[sc-series-index='"+i+"'][sc-category-index='"+r+"']");u.transition().duration(n.constants.animations.fast).style("stroke-opacity",0).style("fill-opacity",0).remove()},removeDeemphasizeLayer:function(t,i,r){var u=t.selectAll(".sc-deemphasize-mask[sc-series-index='"+i+"'][sc-category-index='"+r+"']");u.transition().duration(n.constants.animations.fast).style("stroke-opacity",0).style("fill-opacity",0).remove()},setBarElementVisualization:function(t,i,r,u,f){var e=t.select("g.nv-group.nv-series-"+i+" .nv-bar:nth-child("+(r+1)+") rect:not(.sc-emphasize-mask):not(.sc-deemphasize-mask)");f||e.each(function(){d3.select(this).style("cursor","pointer")});n.nvd3VisualizationManager.setRectElementsVisualization(t,e,i,r,u,0,n.constants.chartType.bar)},setColumnElementVisualization:function(t,i,r,u,f){var e=t.selectAll("g.nv-group.nv-series-"+i+" > rect:nth-child("+(r+1)+"):not(.sc-emphasize-mask):not(.sc-deemphasize-mask)");f||e.each(function(){d3.select(this).style("cursor","pointer")});n.nvd3VisualizationManager.setRectElementsVisualization(t,e,i,r,u,0,n.constants.chartType.column)},setCombinationElementVisualization:function(t,i,r,u,f){var e=t.select("g.nvd3.nv-wrap.nv-linePlusBar g.nv-focus g.nv-barsWrap.nvd3-svg g.nv-bars rect.nv-bar-"+i+"-"+r+":not(.sc-emphasize-mask):not(.sc-deemphasize-mask)");f||e.each(function(){d3.select(this).style("cursor","pointer")});n.nvd3VisualizationManager.setRectElementsVisualization(t,e,i,r,u,0,n.constants.chartType.combination)},resetRectElementsVisualization:function(){},removeOverlapLayers:function(n){n&&n.selectAll(".sc-emphasize-mask, .sc-deemphasize-mask").remove()},removeAllEmphasizeLayers:function(n){n.selectAll(".sc-emphasize-mask").remove()},removeAllInsideLines:function(n){n.selectAll("path.sc-inside-line").remove()},resetPathElementsVisualization:function(t,i,r){r===n.constants.chartType.area&&i.each(function(){d3.select(this).style("stroke-width",1)})},visualizeLabelLineElements:function(t,i,r,u){var f,e,o;if(i===n.constants.visualizationMode.emphasized){if(f=t.select("g.nv-pieWrap.nvd3-svg g.nvd3.nv-wrap.nv-pie .sc-labels-lines line.sc-label-line[sc-series-index='"+r+"']"),!f[0][0])return;if(!f)return;e=t.select("g.nv-pieWrap.nvd3-svg g.nvd3.nv-wrap.nv-pie g .sc-labels-lines");o=d3.rgb(n.colors.getPaletteColor(u,r)).darker(1);e.append("line").attr({x1:f.attr("x1"),y1:f.attr("y1"),x2:f.attr("x2"),y2:f.attr("y2")}).style("stroke",o).style("opacity",0).attr("class","sc-line-mask").attr("sc-series-index",r).transition().duration(n.constants.animations.medium).style("opacity",1)}else t.selectAll("g.nv-pieWrap.nvd3-svg g.nvd3.nv-wrap.nv-pie .sc-labels-lines line.sc-line-mask[sc-series-index='"+r+"']").transition().duration(n.constants.animations.fast).remove()},visualizeInsideLineElements:function(t,i,r,u,f){var e,s,o;if(i===n.constants.visualizationMode.emphasized||i===n.constants.visualizationMode.standard){if(e=t.selectAll("g.nv-pieWrap.nvd3-svg g.nvd3.nv-wrap.nv-pie g.nv-pie .nv-slice:nth-child("+(r+1)+") path:not(.sc-emphasize-mask):not(.sc-deemphasize-mask)"),!e[0][0])return;if(s=Math.min(f.chartCanvasHeight,f.chartCanvasWidth),o=t.select("g.nv-pieWrap.nvd3-svg g.nvd3.nv-wrap.nv-pie g"),s<n.constants.doughnutLabelsVisibilityThreshold)return;var a=t.selectAll("g.nv-pieWrap.nvd3-svg g.nvd3.nv-wrap.nv-pie g.nv-pie"),h=a.attr("transform"),v=d3.rgb(n.colors.getPaletteColor(u,r)),c=s/2,l=d3.svg.arc().outerRadius(c*.52-2).innerRadius(c*.52-10).startAngle(e.node()._current.startAngle).endAngle(e.node()._current.endAngle);o.selectAll("path.sc-inside-line").remove();o.append("path").style("fill",v).style("fill-opacity",0).attr("transform",h).attr("d",l).attr("class","sc-inside-line").attr("sc-series-index",r).transition().duration(n.constants.animations.fast).style("fill-opacity",1);i===n.constants.visualizationMode.emphasized&&o.append("path").style("fill",n.constants.darkLayerColor).style("fill-opacity",0).attr("transform",h).attr("d",l).attr("class","sc-inside-line").attr("sc-series-index",r).transition().duration(n.constants.animations.fast).style("fill-opacity",n.constants.darkerLayerOpacity)}else t.selectAll("g.nv-pieWrap.nvd3-svg g.nvd3.nv-wrap.nv-pie g path.sc-inside-line[sc-series-index='"+r+"']").transition().duration(n.constants.animations.veryFast).remove()},arcTween:function(n){var t=d3.interpolate(this._current,n);return this._current=t(0),function(n){return arc(t(n))}},visualizeDotsElements:function(t,i,r,u,f){if(u===n.constants.visualizationMode.emphasized||u===n.constants.visualizationMode.deemphasized){if(!r)return;r.forEach(function(t){if(t&&t.element){var h=d3.select(t.element),u=h.attr("transform"),r=d3.select(t.element.parentNode),s=r.select("circle.sc-dots-mask"),e=d3.rgb(n.colors.getPaletteColor(f,t.seriesIndex)).darker(1),o=1;s[0][0]&&s.attr("transform")===u||(r.selectAll("circle.sc-dots-mask").remove(),i[t.seriesIndex].legendState===n.constants.legendState.disengaged?(r.append("circle").attr("cx",0).attr("cy",0).attr("r",6).style("fill",n.colors.getPaletteColor(f,t.seriesIndex)).style("opacity",1).attr("transform",u).attr("class","sc-dots-mask"),e=n.constants.brightLayerColor,o=.65,r.append("circle").attr("cx",0).attr("cy",0).attr("r",6).style("fill",e).style("opacity",o).attr("transform",u).attr("class","sc-dots-mask")):r.append("circle").attr("cx",0).attr("cy",0).attr("r",6).style("fill",e).style("opacity",o).attr("transform",u).attr("class","sc-dots-mask"))}})}u===n.constants.visualizationMode.standard&&t.selectAll(".sc-dots-mask").transition().duration(n.constants.animations.fast).remove()},getScatterDots:function(t,i){var o,u,f,r,e;if(!i)return null;for(o=i.length,u=[],r=0;r<o;r++)f=n.utils.getVisibleSerieIndex(i,r),e=t.select("g.nv-scatterWrap .nv-groups g.nv-group.nv-series-"+f+" path.nv-point.nv-noninteractive.hover"),e[0]&&u.push({seriesIndex:r,visibleIndex:f,element:e.node()});return u},setComnbinationChartHighlightedPoint:function(t,i){var f=!t.chartElement.tooltip.hidden(),r=0,e=!1,u;if(i.point)r=i.pointIndex+1;else if(e=!0,r=i.index,i.index===0||i.index===t.chartData[0].values.length-1)return;t.chartData.forEach(function(n){n.bar||t.svgElement.selectAll("g.nv-groups g.nv-series-"+n.combinationChartLineSeriesIndex+" path.nv-point-"+(r-1)).classed("hover",f)}.bind(this));e||(f?n.nvd3VisualizationManager.setCombinationElementVisualization(t.svgElement,t.barSeriesIndex,r,n.constants.visualizationMode.emphasized):(u=n.constants.visualizationMode.standard,t.hasBarSeries&&t.chartData[t.barSeriesIndex].legendState===n.constants.legendState.disengaged&&(u=n.constants.visualizationMode.deemphasized),t.hasBarSeries&&n.nvd3VisualizationManager.setCombinationElementVisualization(t.svgElement,t.barSeriesIndex,r,u)))}}}(Sitecore.Speak.D3.models);