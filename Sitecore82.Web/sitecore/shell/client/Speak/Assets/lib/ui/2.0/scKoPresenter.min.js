/**!
 *
 * koPresenter
 *
 * Built: Wed Mar 16 2016 13:15:11 GMT+0100 (Romance Standard Time)
 * PackageVersion: 0.0.15
 *
 */

!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);throw new Error("Cannot find module '"+g+"'")}var j=c[g]={exports:{}};b[g][0].call(j.exports,function(a){var c=b[g][1][a];return e(c?c:a)},j,j.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){var d=function(a,b){function c(a){if(8===a.nodeType)b(a);else if(a.childNodes.length>0)for(var d=0;d<a.childNodes.length;d++)c(a.childNodes[d],b)}return c(a,b)};b.exports={computeComments:d}},{}],2:[function(a,b,c){b.exports=function(b,c){return a("./ko")(b,c)}},{"./ko":3}],3:[function(a,b,c){var d=a("./dom");b.exports=function(a,b){var c=function(b){if(b.el){var c=[b.el],e=a.utils.array.toArray(b.el.querySelectorAll("[data-bind]"));c=c.concat(e),c.forEach(function(a){a.__registered=!0}),d.computeComments(b.el,function(a){a.__registered=!0}),b.el.__registered=!0}},e=function(){var a=new b.bindingProvider,c=a.nodeHasBindings;return a.nodeHasBindings=function(a){return a.__registered?!1:c.call(this,a)},a};return{markAsRegistered:c,SPEAKBindingProvider:e}}},{"./dom":1}],4:[function(a,b,c){var d={el:1,id:1,key:1,script:1,template:1,depth:1,ko:1,app:1,parent:1,on:1,trigger:1,once:1,listenToOnce:1,listenTo:1,off:1,children:1,__properties:1,processSubscribers:1,_s:1,viewModel:1,__parameterTemplates:1,_events:1,computed:1,get:1,set:1,_subscriptions:1,__getComputedValues:1,__triggerForComputed:1,defineProperties:1,defineProperty:1};b.exports={skip:d}},{}],5:[function(a,b,c){!function(){var b="undefined"!=typeof window,c=window.ko||requirejs("knockout"),d=b&&window.Sitecore?window.Sitecore.Speak:requirejs("boot"),e=a("./utils/utils").forEachValidProperty,f=a("sc-kospeakbindingprovider")(d,c),g=a("./utils/component")(c),h=a("./utils/viewModel")(c,g.updateComponentWhenViewModelChange),i=Sitecore.Speak.isDebug(),j=function(a,b){b||(b="log"),i&&console[b](a)},k=function(a,b,c,d){h.updateViewModelWhenComponentChange(a,b,c),g.updateComponentWhenViewModelChange(a,b,c,d)},l=function(a,b,c){j("Create ViewModel for Component: "+a.id),e(a,function(d){h.buildPropertyForViewModel(d,a,b,c),k(d,a,b,c)}),h.buildComputed(a,b),g.syncComputed(a,b),j("Finish creating ViewModel "+a.id+", result is:"),j(b)};c.bindingProvider.instance=new f.SPEAKBindingProvider,Sitecore.Speak.module("scKoPresenter",{buildViewModel:function(a){a.viewModel=a.viewModel||{},l(a,a.viewModel,!0)}}),Sitecore.Speak.presenter({name:"scKoPresenter",updateViewModel:function(){l(this,this.viewModel,!0)},initialized:function(){this.viewModel=this.viewModel||{},this._subscriptions={},l(this,this.viewModel,!0),this.viewModel.app=this.app,this.hasTemplate||(j("Applying bindings for component: "+this.id),j("Dom element for "+this.id+" is:"),j(this.el),c.applyBindings(this.viewModel,this.el),f.markAsRegistered(this))}})}()},{"./utils/component":6,"./utils/utils":8,"./utils/viewModel":9,"sc-kospeakbindingprovider":2}],6:[function(a,b,c){b.exports=function(b){var c=a("./sync")(b),d=a("../conf"),e=d.skip,f=function(a,b){for(var c in a)a.hasOwnProperty(c)&&!e[c]&&h(c,a,b)},g=function(a){return a.charAt(0).toUpperCase()+a.slice(1)},h=function(a,d,g){if(g[a].arrayBinding){d._subscriptions[a]=c.syncFromKoObsToSpeakObs(a,d,g,b);var i=g[a]();i.length>0&&d[a].array&&d[a].array[0]instanceof SpeakBaseModel&&i.forEach(function(b,c){var e=d[a].array[c];f(e,b)})}else if(g[a].bindableBinding&&!e[a]){var j=g[a];for(var k in j)j.hasOwnProperty(k)&&h(k,d[a],j)}else if(b.isObservable(g[a])){var l=c.updateComponent(a,d,g);d._subscriptions[a]=g[a].subscribe(l)}},i=function(a,b){var c=a.computed||{},d=Object.keys(c),e=a.__properties,f=Object.keys(e);d.forEach(function(c){a.on("change:"+g(c),function(){b.$updateComputedCount+=1,b.$updateComputed(b.$updateComputedCount)})}),f.forEach(function(c){a.on("change:"+g(c),function(){b.$updateComputedCount+=1,b.$updateComputed(b.$updateComputedCount)})})};return{updateComponentWhenViewModelChange:h,syncComputed:i}}},{"../conf":4,"./sync":7}],7:[function(a,b,c){var d=a("./utils");b.exports=function(a,b){var c=function(a,b,c){return function(){return Array.isArray(b[a])?(c[a]._changing=!0,c[a]().length>0&&c[a].removeAll(),b[a].forEach(function(b){c[a].push(b)}),void(c[a]._changing=!1)):void(Array.isArray(b[a])||c[a](b[a]))}},e=function(a,b,c){return function(b){c[a]._changing=!0,c[a].push(b),c[a]._changing=!1}},f=function(a,b,c){return function(b){c[a]._changing=!0,c[a].remove(b),c[a]._changing=!1}},g=function(a,b,c,e,f,g){var h=function(h){var i=h;return function(h){if(!c[a]._changing){if(c[a]._changing=!0,h instanceof SpeakBaseModel){var j=e(h,b);c[a][i].apply(c[a],[j]),d.forEachValidProperty(h,function(a){h.hasOwnProperty(a)&&(f(a,h,j),g(a,h,j))})}else c[a][i].apply(c[a],arguments);c[a]._changing=!1}}};b[a].on("push",h("push")),b[a].on("pop",h("pop")),b[a].on("slice",h("slice")),b[a].on("concat",h("concat")),b[a].on("shift",h("shift")),b[a].on("unshift",h("unshift")),b[a].on("reverse",h("reverse")),b[a].on("sort",h("sort")),b[a].on("remove",function(b){c[a]._changing||(c[a]._changing=!0,c[a].splice(b,1),c[a]._changing=!1)})},h=function(b,c,d){var e;return d[b].subscribe(function(a){e=a.slice(0)},void 0,"beforeChange"),d[b].subscribe(function(f){for(var g=a.utils.compareArrays(e,f),h=0,i=g.length;i>h;h++){var j=a.utils.arrayIndexOf(c[b].array||c[b],g[h].value);switch(g[h].status){case"retained":break;case"deleted":j>=0&&!d[b]._changing&&c[b].splice(j,1);break;case"added":d[b]._changing||(0===g[h].index?c[b].unshift(g[h].value):c[b].push(g[h].value))}}c[b].array||d[b]._changing||(c.trigger("change:"+b,c.get(b)),d[b]._changing=!1),e=void 0})},i=function(a,b,c){return function(d){c[a]._changing||(b[a]=d)}};return{updateViewModel:c,syncFromSpeakObsToKoObs:g,syncFromKoObsToSpeakObs:h,updateComponent:i,syncAddFromOriginalArrayToKoObs:e,syncRemoveFromOriginalArrayToKoObs:f}}},{"./utils":8}],8:[function(a,b,c){var d=a("../conf"),e=d.skip;b.exports={forEachValidProperty:function(a,b){for(var c in a)e[c]||b(c)}}},{"../conf":4}],9:[function(a,b,c){b.exports=function(b,c){var d=a("./sync")(b,this),e=a("../conf"),f=e.skip,g=function(a,c){var d=a.computed||{},e=Object.keys(d);c.$updateComputed=b.observable(),c.$updateComputedCount=c.$updateComputedCount||0,e.forEach(function(e){var f=d[e];f.write&&!f.owner&&(f.owner=a),f.write?c[e]=b.computed({read:function(){this.viewModel.$updateComputed();return f.read.apply(this,arguments)},owner:a,write:function(){f.write.apply(this,arguments),c.$updateComputedCount+=1,c.$updateComputed(c.$updateComputedCount)}}):c[e]=b.computed(function(){this.viewModel.$updateComputed();return f.read.apply(this,arguments)},a),c[e].isComputed=!0})},h=function(a,b,e){var g=b;if("function"!=typeof g[a]&&!f[a])if("speak"!==e[a].arrayType)if(g.on("add:"+a,d.syncAddFromOriginalArrayToKoObs(a,b,e)),g.on("remove:"+a,d.syncRemoveFromOriginalArrayToKoObs(a,b,e)),g[a]instanceof SpeakBaseModel){var k=g[a];for(var l in k)k.hasOwnProperty(l)&&h(l,k,e[a])}else g.on("change:"+a,d.updateViewModel(a,g,e));else{d.syncFromSpeakObsToKoObs(a,g,e,j,h,c);var m=g[a];m.length>0&&m.forEach(function(b,c){var d=e[a]()[c];i(b,g,d)})}},i=function(a,b,c){for(var d in a)a.hasOwnProperty(d)&&(f[d]||h(d,a,c))},j=function(a,b){var c={};a._subscriptions={},c._subscriptions={};for(var d in a)a.hasOwnProperty(d)&&(a._s=b._s,f[d]||k(d,a,c));return c},k=function(a,c,d,e){var f,g=d,h=c[a],i=h&&h.array,k=Array.isArray(h);if(!g[a]||e)if(k||i){f=i?h.array:h;var l=f.slice(0);if(l.length>0&&l[0]instanceof SpeakBaseModel){var m=[];l.forEach(function(a){m.push(j(a,c))}),g[a]=b.observableArray(m)}else g[a]=b.observableArray(l);g[a].arrayBinding=!0,g[a].arrayType=i?"speak":"original"}else c._s.utils.is.a["function"](h)?!g[a]&&c._s.utils.is.a["function"](h)&&(g[a]=function(){return c[a].apply(c,arguments)}):b.isObservable(h)?g[a]=h:h instanceof SpeakBaseModel?(g[a]=j(h,c),g[a].bindableBinding=!0):g[a]=b.observable(h)};return{buildPropertyForViewModel:k,updateViewModelWhenComponentChange:h,buildComputed:g,buildBindableViewModel:j}}},{"../conf":4,"./sync":7}]},{},[5]);