ManagedPoolThread #0 23:18:57 WARN  Failed to create counter 'Sitecore.System\Events | Events Raised / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #1 23:18:57 WARN  Failed to create counter 'Sitecore.System\IO | File Watcher Events / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #2 23:18:58 WARN  Failed to create counter 'Sitecore.System\Logging | Errors Logged / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #3 23:18:58 WARN  Failed to create counter 'Sitecore.System\Logging | Fatals Logged / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #4 23:18:58 WARN  Failed to create counter 'Sitecore.System\Logging | Informations Logged / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #5 23:18:58 WARN  Failed to create counter 'Sitecore.System\Logging | Warnings Logged / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #6 23:18:58 WARN  Failed to create counter 'Sitecore.System\Logging | Audits Logged / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #7 23:18:58 WARN  Failed to create counter 'Sitecore.System\Reflection | Methods Invoked / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #8 23:18:59 WARN  Failed to create counter 'Sitecore.System\Reflection | Objects Created / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #9 23:18:59 WARN  Failed to create counter 'Sitecore.System\Reflection | Objects Not Created / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #10 23:18:59 WARN  Failed to create counter 'Sitecore.System\Reflection | Types Resolved / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #11 23:18:59 WARN  Failed to create counter 'Sitecore.System\Reflection | Types Not Resolved / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #12 23:19:00 WARN  Failed to create counter 'Sitecore.System\Threading | Background Threads Started / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #13 23:19:00 WARN  Failed to create counter 'Sitecore.System\Xml | Packets Created / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
12716 23:19:15 INFO  HttpModule is being initialized
12716 23:19:15 INFO  
12716 23:19:15 INFO  **********************************************************************
12716 23:19:15 INFO  **********************************************************************
12716 23:19:15 INFO  Sitecore started
12716 23:19:15 INFO  Sitecore.NET 8.2 (rev. 170614)
12716 23:19:15 INFO  
12716 23:19:15 INFO  c:\repo\sitecore82\sitecore82\bin\antlr3.runtime.dll (Antlr3.Runtime)
12716 23:19:15 INFO  c:\repo\sitecore82\sitecore82\bin\castle.core.dll (Castle.Core, Castle.Core 3.3.3 for .NETFramework v4.5, 3.3.3.58)
12716 23:19:15 INFO  c:\repo\sitecore82\sitecore82\bin\componentart.web.ui.dll ()
12716 23:19:15 INFO  c:\repo\sitecore82\sitecore82\bin\dotnetopenauth.dll (DotNetOpenAuth, 1c99bf16c5b570cadcf27d0b9ce3d598d06b34ca)
12716 23:19:15 INFO  c:\repo\sitecore82\sitecore82\bin\ecmascript.net.dll (Modified version of the EcmaScript.NET assembly)
12716 23:19:15 INFO  c:\repo\sitecore82\sitecore82\bin\facebook.dll (Facebook C# SDK, Facebook C# SDK)
12716 23:19:15 INFO  c:\repo\sitecore82\sitecore82\bin\facebookapi.dll (FacebookAPI)
12716 23:19:15 INFO  c:\repo\sitecore82\sitecore82\bin\glass.mapper.dll (Glass.Mapper, 4.4.0.199)
12716 23:19:15 INFO  c:\repo\sitecore82\sitecore82\bin\glass.mapper.sc.dll (Glass.Mapper.Sc, 4.3.4.197)
12716 23:19:15 INFO  c:\repo\sitecore82\sitecore82\bin\glass.mapper.sc.mvc.dll (Glass.Mapper.Sc.Mvc)
12716 23:19:15 INFO  c:\repo\sitecore82\sitecore82\bin\google.apis.authentication.oauth2.dll (OAuth2 Authentication Library)
12716 23:19:15 INFO  c:\repo\sitecore82\sitecore82\bin\google.apis.dll ()
12716 23:19:15 INFO  c:\repo\sitecore82\sitecore82\bin\google.apis.plus.v1.dll (Google.Apis.Plus.v1)
12716 23:19:15 INFO  c:\repo\sitecore82\sitecore82\bin\hammock.clientprofile.dll (Hammock)
12716 23:19:15 INFO  c:\repo\sitecore82\sitecore82\bin\htmlagilitypack.dll (Html Agility Pack, 1.4.6.0)
12716 23:19:15 INFO  c:\repo\sitecore82\sitecore82\bin\icsharpcode.sharpziplib.dll (#ZipLibrary, A free C# compression library, 0.86.0)
12716 23:19:15 INFO  c:\repo\sitecore82\sitecore82\bin\iesi.collections.dll (Iesi.Collections, Enhanced Collections for .NET.  Code was published at http://www.codeproject.com/csharp/sets.asp, 1.0)
12716 23:19:15 INFO  c:\repo\sitecore82\sitecore82\bin\ithit.webdav.server.dll (WebDav Server .Net v2, IT Hit WebDAV Server .Net v2)
12716 23:19:15 INFO  c:\repo\sitecore82\sitecore82\bin\lucene.net.contrib.analyzers.dll (Lucene.Net.Contrib.Analyzers)
12716 23:19:15 INFO  c:\repo\sitecore82\sitecore82\bin\lucene.net.contrib.core.dll (Lucene.Net.Contrib.Core, Contributions to the Lucene.Net core library)
12716 23:19:15 INFO  c:\repo\sitecore82\sitecore82\bin\lucene.net.contrib.fastvectorhighlighter.dll (Lucene.Net.Contrib.FastVectorHighlighter, FastVectorHighlighter for Lucene.Net)
12716 23:19:15 INFO  c:\repo\sitecore82\sitecore82\bin\lucene.net.contrib.highlighter.dll (Lucene.Net.Contrib.Highlighter, The Apache Software Foundation Lucene.Net a full-text search engine library, 2.3.2)
12716 23:19:15 INFO  c:\repo\sitecore82\sitecore82\bin\lucene.net.contrib.memory.dll (Contrib.Memory)
12716 23:19:15 INFO  c:\repo\sitecore82\sitecore82\bin\lucene.net.contrib.queries.dll (Lucene.Net.Contrib.Queries)
12716 23:19:15 INFO  c:\repo\sitecore82\sitecore82\bin\lucene.net.contrib.regex.dll (Lucene.Net.Contrib.Regex)
12716 23:19:15 INFO  c:\repo\sitecore82\sitecore82\bin\lucene.net.contrib.simplefacetedsearch.dll (Lucene.Net.SimpleFacetedSearch, SimpleFacetedSearch for Lucene.Net)
12716 23:19:15 INFO  c:\repo\sitecore82\sitecore82\bin\lucene.net.contrib.snowball.dll (Lucene.Net.Contrib.Snowball, The Apache Software Foundation Lucene.Net a full-text search engine library, 2.0)
12716 23:19:15 INFO  c:\repo\sitecore82\sitecore82\bin\lucene.net.contrib.spellchecker.dll (SpellChecker.Net, The Apache Software Foundation Lucene.Net a full-text search engine library, 3.0.3)
12716 23:19:15 INFO  c:\repo\sitecore82\sitecore82\bin\lucene.net.dll (Lucene.Net, The Apache Software Foundation Lucene.Net a full-text search engine library, 3.0.3)
12716 23:19:15 INFO  c:\repo\sitecore82\sitecore82\bin\markdownsharp.dll (Markdown processor)
12716 23:19:15 INFO  c:\repo\sitecore82\sitecore82\bin\microsoft.ai.agent.intercept.dll (Microsoft.AI.Agent.Intercept)
12716 23:19:15 INFO  c:\repo\sitecore82\sitecore82\bin\microsoft.ai.dependencycollector.dll ()
12716 23:19:15 INFO  c:\repo\sitecore82\sitecore82\bin\microsoft.ai.perfcountercollector.dll ()
12716 23:19:15 INFO  c:\repo\sitecore82\sitecore82\bin\microsoft.ai.servertelemetrychannel.dll ()
12716 23:19:15 INFO  c:\repo\sitecore82\sitecore82\bin\microsoft.ai.web.dll (Application Insights .NET SDK, Application Insights for Web Applications)
12716 23:19:15 INFO  c:\repo\sitecore82\sitecore82\bin\microsoft.ai.windowsserver.dll ()
12716 23:19:15 INFO  c:\repo\sitecore82\sitecore82\bin\microsoft.analysisservices.adomdclient.dll (Microsoft SQL Server, ADOMD.NET, 10.50.1600.1)
12716 23:19:15 INFO  c:\repo\sitecore82\sitecore82\bin\microsoft.applicationinsights.dll ()
12716 23:19:15 INFO  c:\repo\sitecore82\sitecore82\bin\microsoft.aspnet.webapi.extensions.compression.server.dll (Microsoft.AspNet.WebApi.Extensions.Compression.Server, Module for ASP.NET WebApi that enables GZip and Deflate support for incoming and outgoing requests)
12716 23:19:15 INFO  c:\repo\sitecore82\sitecore82\bin\microsoft.codedom.providers.dotnetcompilerplatform.dll (Microsoft.CodeDom.Providers.DotNetCompilerPlatform, 1.0.0-20615)
12716 23:19:15 INFO  c:\repo\sitecore82\sitecore82\bin\microsoft.extensions.dependencyinjection.abstractions.dll (Microsoft .NET Extensions, Abstractions for dependency injection.
Commonly used types:
Microsoft.Extensions.DependencyInjection.IServiceCollection
Microsoft.Extensions.DependencyInjection.ServiceCollectionExtensions, 1.0.0-rtm-21431)
12716 23:19:15 INFO  c:\repo\sitecore82\sitecore82\bin\microsoft.extensions.dependencyinjection.dll (Microsoft .NET Extensions, Default implementation of dependency injection for Microsoft.Extensions.DependencyInjection, 1.0.0-rtm-21431)
12716 23:19:15 INFO  c:\repo\sitecore82\sitecore82\bin\microsoft.odata.core.dll (Microsoft® .NET Framework, Microsoft.OData.Core.dll, 6.15.0.0)
12716 23:19:15 INFO  c:\repo\sitecore82\sitecore82\bin\microsoft.odata.edm.dll (Microsoft® .NET Framework, Microsoft.OData.Edm.dll, 6.15.0.0)
12716 23:19:15 INFO  c:\repo\sitecore82\sitecore82\bin\microsoft.practices.servicelocation.dll (Microsoft.Practices.ServiceLocation, A simple facade that provides insulation from specific IoC containers)
12716 23:19:15 INFO  c:\repo\sitecore82\sitecore82\bin\microsoft.spatial.dll (Microsoft® .NET Framework, Microsoft.Spatial.dll, 6.15.0.0)
12716 23:19:15 INFO  c:\repo\sitecore82\sitecore82\bin\microsoft.sqlserver.connectioninfo.dll (Microsoft SQL Server, 10.50.2500.0)
12716 23:19:15 INFO  c:\repo\sitecore82\sitecore82\bin\microsoft.sqlserver.dmf.dll (Microsoft SQL Server, 10.50.2500.0)
12716 23:19:15 INFO  c:\repo\sitecore82\sitecore82\bin\microsoft.sqlserver.management.sdk.sfc.dll (Microsoft SQL Server, 10.50.2500.0)
12716 23:19:15 INFO  c:\repo\sitecore82\sitecore82\bin\microsoft.sqlserver.regsvrenum.dll (Microsoft SQL Server, 10.50.1600.1)
12716 23:19:15 INFO  c:\repo\sitecore82\sitecore82\bin\microsoft.sqlserver.servicebrokerenum.dll (Microsoft SQL Server, 10.50.1600.1)
12716 23:19:15 INFO  c:\repo\sitecore82\sitecore82\bin\microsoft.sqlserver.smo.dll (Microsoft SQL Server, 10.50.2500.0)
12716 23:19:15 INFO  c:\repo\sitecore82\sitecore82\bin\microsoft.sqlserver.smoextended.dll (Microsoft SQL Server, 10.50.2500.0)
12716 23:19:15 INFO  c:\repo\sitecore82\sitecore82\bin\microsoft.sqlserver.sqlenum.dll (Microsoft SQL Server, 10.50.2500.0)
12716 23:19:15 INFO  c:\repo\sitecore82\sitecore82\bin\microsoft.web.administration.dll (Internet Information Services)
12716 23:19:15 INFO  c:\repo\sitecore82\sitecore82\bin\microsoft.web.delegation.dll (Microsoft (R) Windows (R) Operating System)
12716 23:19:15 INFO  c:\repo\sitecore82\sitecore82\bin\microsoft.web.deployment.tracing.dll (Microsoft (R) Windows (R) Operating System)
12716 23:19:15 INFO  c:\repo\sitecore82\sitecore82\bin\microsoft.web.infrastructure.dll (Microsoft ASP.Net WebPages)
12716 23:19:15 INFO  c:\repo\sitecore82\sitecore82\bin\microsoft.windowsazure.serviceruntime.dll (Windows Azure Runtime, 2.7.1198.742 (rd_art_stable.151102-1219))
12716 23:19:15 INFO  c:\repo\sitecore82\sitecore82\bin\mongodb.bson.dll (MongoDB.Bson, Official MongoDB supported BSON library. See http://www.mongodb.org/display/DOCS/CSharp+Language+Center for more details, { version: '1.10.0.62', semver: '1.10.0', commit: '2df664a15859899b9bb0a457e237ec32c7d31e48', commitDate: '2015-01-29 15:41:46' })
12716 23:19:15 INFO  c:\repo\sitecore82\sitecore82\bin\mongodb.driver.dll (MongoDB.Driver, Official MongoDB supported driver for MongoDB.  See http://www.mongodb.org/display/DOCS/CSharp+Language+Center for more details, { version: '1.10.0.62', semver: '1.10.0', commit: '2df664a15859899b9bb0a457e237ec32c7d31e48', commitDate: '2015-01-29 15:41:46' })
12716 23:19:15 INFO  c:\repo\sitecore82\sitecore82\bin\mvp.xml.dll (MVP XML Library)
12716 23:19:15 INFO  c:\repo\sitecore82\sitecore82\bin\netbiscuits.onpremise.dll (OnPremise)
12716 23:19:15 INFO  c:\repo\sitecore82\sitecore82\bin\newtonsoft.json.dll (Json.NET, Json.NET is a popular high-performance JSON framework for .NET)
12716 23:19:15 INFO  c:\repo\sitecore82\sitecore82\bin\ninject.dll (Ninject: Lightweight dependency injection for .NET, IoC container)
12716 23:19:15 INFO  c:\repo\sitecore82\sitecore82\bin\ninject.web.common.dll (Ninject.Web.Common: Web Common Extension for Ninject, Bootstrapper for web projects)
12716 23:19:15 INFO  c:\repo\sitecore82\sitecore82\bin\ninject.web.mvc.dll (Ninject.Web.Mvc: Ninject support for MVC3, Extension for Ninject providing integration with ASP.NET MVC3)
12716 23:19:15 INFO  c:\repo\sitecore82\sitecore82\bin\oauthlinkedin.dll (OAuthLinkedIn)
12716 23:19:15 INFO  c:\repo\sitecore82\sitecore82\bin\protobuf-net.dll (protobuf-net, Protocol Buffers for .NET)
12716 23:19:15 INFO  c:\repo\sitecore82\sitecore82\bin\radeditor.net2.dll (RadEditor, Telerik RadEditor)
12716 23:19:15 INFO  c:\repo\sitecore82\sitecore82\bin\razorgenerator.mvc.dll (RazorGenerator, MVC View engine that supports precompiled Razor views, 2.4.2)
12716 23:19:15 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.abstractions.dll (Sitecore CMS, 10.0.6-r00427-7aa1a4e)
12716 23:19:15 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.analytics.aggregation.dll (Sitecore xDB, 10.0.3-r00151-50c3b36)
12716 23:19:15 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.analytics.automation.aggregation.dll (Sitecore Engagement Automation, 10.0.0 rev. 160623)
12716 23:19:15 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.analytics.automation.dll (Sitecore Engagement Automation, 10.0.0 rev. 160623)
12716 23:19:15 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.analytics.automation.mongodb.dll (Sitecore Engagement Automation, 10.0.0 rev. 160623)
12716 23:19:15 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.analytics.core.dll (Sitecore xDB, 10.0.3-r00151-50c3b36)
12716 23:19:15 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.analytics.dataaccess.dll (Sitecore xDB, 10.0.3-r00151-50c3b36)
12716 23:19:15 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.analytics.dll (Sitecore xDB, Sitecore xDB, 10.0.3-r00151-50c3b36)
12716 23:19:15 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.analytics.model.dll (Sitecore xDB, 10.0.3-r00151-50c3b36)
12716 23:19:15 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.analytics.mongodb.dll (Sitecore xDB, Sitecore xDB MongoDB Connector, 10.0.3-r00151-50c3b36)
12716 23:19:15 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.analytics.omnichannel.dll (Sitecore xDB, 10.0.3-r00151-50c3b36)
12716 23:19:15 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.analytics.outcome.dll (Sitecore xDB, 10.0.3-r00151-50c3b36)
12716 23:19:15 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.analytics.processing.dll (Sitecore xDB, 10.0.3-r00151-50c3b36)
12716 23:19:15 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.analytics.robotdetection.dll (Sitecore Robot Detection, 10.0.0 rev. 160614)
12716 23:19:15 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.analytics.sql.dll (Sitecore xDB, 10.0.3-r00151-50c3b36)
12716 23:19:15 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.apps.loader.dll (Sitecore.Apps.Loader, Sitecore.Apps.Loader, 1.1.1-r00027)
12716 23:19:15 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.buckets.client.dll (Sitecore Buckets, The assembly can be used to have Sitecore queries driven via a query, 2.0.3-r00059-172ac17)
12716 23:19:15 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.buckets.dll (Sitecore Buckets, The assembly can be used to have Sitecore queries driven via search providers, 2.0.3-r00059-172ac17)
12716 23:19:15 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.ces.devicedetection.dll (Sitecore DeviceDetection Client, 1.1.1-r00035-9c0de72)
12716 23:19:15 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.ces.devicedetection.rules.dll (Sitecore DeviceDetection Client, 1.1.1-r00035-9c0de72)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.ces.dll (Sitecore IP Geolocation Service Client, 1.4.0 rev. 160712)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.ces.geoip.dll (Sitecore IP Geolocation Service Client, 1.4.0 rev. 160712)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.ces.geoip.legacylocation.dll (Sitecore IP Geolocation Service Client, 1.4.0 rev. 160712)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.cintel.client.dll (Sitecore Experience Profile, 1.2.2-r00106-f2ca7b5)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.cintel.dll (Sitecore Experience Profile, 1.2.2-r00106-f2ca7b5)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.client.dll (Sitecore CMS, Sitecore Client Application, 10.0.6-r00427-7aa1a4e)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.client.licenseoptions.dll (Sitecore Speak Applications, 1.4.3-r00042-f6a50ff)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.cloud.nexus.dll (Sitecore Cloud Nexus, 2.3.0.59)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.cloud.restclient.dll (Sitecore Cloud RestClient, 6.3.0.50)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.commerce.dll (Sitecore Commerce Connect, 8.2.328-2789d2d)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.commerce.experienceanalytics.dll (Sitecore Commerce Connect, 8.2.328-2789d2d)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.commerce.experienceprofile.dll (Sitecore Commerce Connect, 8.2.328-2789d2d)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.contentsearch.analytics.client.dll (Sitecore ContactSegmentationIndex, 10.0.3-r00038-0270659)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.contentsearch.analytics.dll (Sitecore ContactSegmentationIndex, 10.0.3-r00038-0270659)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.contentsearch.azure.dll (Sitecore.ContentSearch.Azure, 1.1.1-r00181-3a41657)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.contentsearch.client.dll (Sitecore Content Search, 2.0.4-r00156-d42f546)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.contentsearch.dll (Sitecore Content Search, Sitecore CMS Search, 2.0.4-r00156-d42f546)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.contentsearch.linq.dll (Sitecore Content Search, Sitecore CMS Search, 2.0.4-r00156-d42f546)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.contentsearch.linq.lucene.dll (Sitecore Content Search, 2.0.4-r00156-d42f546)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.contentsearch.linq.solr.dll (Sitecore Content Search, 2.0.4-r00156-d42f546)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.contentsearch.luceneprovider.dll (Sitecore Content Search, Sitecore CMS Search, 2.0.4-r00156-d42f546)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.contentsearch.solrprovider.dll (Sitecore Content Search, 2.0.4-r00156-d42f546)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.contenttesting.dll (Sitecore Content Testing, 10.0.1-r0129-36eec12)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.contenttesting.intelligence.dll (Sitecore Content Testing, 10.0.1-r0129-36eec12)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.contenttesting.model.dll (Sitecore Content Testing, 10.0.1-r0129-36eec12)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.contenttesting.mvc.dll (Sitecore Content Testing, 10.0.1-r0129-36eec12)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.controlpanel.dll (Sitecore Speak Applications, 1.4.3-r00042-f6a50ff)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.experienceanalytics.aggregation.dll (Sitecore Experience Analytics, 2.0.3-r01092-309193e)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.experienceanalytics.api.dll (Sitecore Experience Analytics, 2.0.3-r01092-309193e)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.experienceanalytics.client.dll (Sitecore Experience Analytics, 2.0.3-r01092-309193e)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.experienceanalytics.core.dll (Sitecore Experience Analytics, 2.0.3-r01092-309193e)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.experienceanalytics.dll (Sitecore Experience Analytics, 2.0.3-r01092-309193e)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.experienceanalytics.reaggregation.dll (Sitecore Experience Analytics, 2.0.3-r01092-309193e)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.experienceanalytics.reduce.dll (Sitecore Experience Analytics, 2.0.3-r01092-309193e)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.experiencecontentmanagement.administration.dll (Sitecore ExperienceContentManagement Administration, 1.1.3-r00188-95f876f)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.experienceeditor.dll (Sitecore Experience Editor, 3.0.2 rev. 170201)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.experienceeditor.speak.dll (Sitecore Experience Editor, 3.0.2 rev. 170201)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.experienceeditor.speak.ribbon.dll (Sitecore Experience Editor, 3.0.2 rev. 170201)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.experienceexplorer.business.dll (Sitecore Experience Explorer, 2.1.1 rev. 161020)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.experienceexplorer.web.dll (Sitecore Experience Explorer, 2.1.1 rev. 161020)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.fxm.client.dll (Sitecore Federated Experience Manager, 2.2.1 rev. 161026 )
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.fxm.dll (Sitecore Federated Experience Manager, 2.2.1 rev. 161026 )
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.fxm.service.dll (Sitecore Federated Experience Manager, 2.2.1 rev. 161026 )
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.fxm.speak.dll (Sitecore Federated Experience Manager, 2.2.1 rev. 161026 )
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.itemwebapi.dll (Sitecore Item Web API, 1.3.0 rev. 160621)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.kernel.dll (Sitecore CMS, Sitecore CMS Kernel Library, 10.0.6-r00427-7aa1a4e)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.launchpad.dll (Sitecore LaunchPad, 1.1.2-r00016-f173885)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.listmanagement.analytics.dll (Sitecore.ListManager, 1.2.4-r01654-32bf3fa)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.listmanagement.client.dll (Sitecore.ListManager, 1.2.4-r01654-32bf3fa)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.listmanagement.contentsearch.dll (Sitecore.ListManager, 1.2.4-r01654-32bf3fa)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.listmanagement.dll (Sitecore.ListManager, 1.2.4-r01654-32bf3fa)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.listmanagement.services.dll (Sitecore.ListManager, 1.2.4-r01654-32bf3fa)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.logging.client.dll (Sitecore Logging, Lets you insert loggers in your JavaScript, and automatically sends the log messages to a server side component that stores them in your existing server side logs. Interfaces with Sitecore.Logging.

Ideal for logging JavaScript exceptions to the server, including a stack trace. Documentation and examples are at jsnlog.com, 10.0.3-r00009-708d10c)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.logging.dll (Sitecore Logging, Sitecore Logging Framework, 10.0.3-r00009-708d10c)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.marketing.campaigns.client.dll (Sitecore CampaignManager, 1.2.3-r00163-d432ce4)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.marketing.campaigns.services.dll (Sitecore CampaignManager, 1.2.3-r00163-d432ce4)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.marketing.client.dll (Sitecore Marketing Client, 10.0.1-r00063-beed883)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.marketing.core.dll (Sitecore Marketing Operations, 10.0.1-r00078-e3dc0ef)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.marketing.definitions.marketingassets.repositories.dll (Sitecore Marketing Asset Repositories, 10.0.1-r00076-4de1ed5)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.marketing.dll (Sitecore Marketing Operations, 10.0.1-r00078-e3dc0ef)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.marketing.search.dll (Sitecore Marketing Operations, 10.0.1-r00078-e3dc0ef)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.marketing.taxonomy.dll (Sitecore Marketing Operations, 10.0.1-r00078-e3dc0ef)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.mvc.analytics.dll (Sitecore Mvc Analytics, 10.0.0 rev. 160718)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.mvc.devicesimulator.dll (Sitecore Mvc Device Simulators, 1.1.1-r00016-448c8fa)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.mvc.dll (Sitecore Mvc, 1.2.1-r00105-7c6b4bf)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.mvc.experienceeditor.dll (Sitecore MVC Experience Editor, 2.1.1 rev. 161026)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.nexus.dll (Sitecore.Nexus, 1.0.4425)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.nvelocity.dll (Sitecore NVelocity, Sitecore Macro Expansion Library, 7.0.1-r00005-6c34393)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.oracle.dll (Sitecore Oracle, 10.0.4-r00017-a982934)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.pathanalyzer.client.dll (Sitecore Path Analyzer, 1.2.1-r01330-b85df3f)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.pathanalyzer.dll (Sitecore Path Analyzer, 1.2.1-r01330-b85df3f)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.pathanalyzer.services.dll (Sitecore Path Analyzer, 1.2.1-r01330-b85df3f)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.publishing.webdeploy.dll (Sitecore CMS, Sitecore publishing infrastructure based on Web Deployment Tool, 10.0.6-r00427-7aa1a4e)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.security.anticsrf.dll (Sitecore AntiCSRF Module, 1.1.1-r00011-e000b86)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.segmentbuilder.dll (Sitecore.SegmentBuilder, 1.1.4-r00041-4cfa4cf)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.sequenceanalyzer.dll (Sitecore Path Analyzer, 1.2.1-r01330-b85df3f)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.services.client.dll (Sitecore Services Client, Sitecore Services, 1.4.1-r1039-caca69c)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.services.core.dll (Sitecore Services Client Services, Sitecore Services, 1.4.1-r1027-c1fc0cb)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.services.infrastructure.dll (Sitecore Services Client Services, Sitecore Services, 1.4.1-r1027-c1fc0cb)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.services.infrastructure.sitecore.dll (Sitecore Services Client Services, Sitecore Services, 1.4.1-r1027-c1fc0cb)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.sessionprovider.dll (Sitecore Session Providers, 10.0.4-r00047-78f7434)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.sessionprovider.memory.dll (Sitecore Session Providers, 10.0.4-r00047-78f7434)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.sessionprovider.mongodb.dll (Sitecore Session Providers, 10.0.4-r00047-78f7434)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.sessionprovider.redis.dll (Sitecore Session Providers, 10.0.4-r00047-78f7434)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.sessionprovider.sql.dll (Sitecore Session Providers, 10.0.4-r00047-78f7434)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.shell.marketingautomation.dll (Sitecore Engagement Automation Suite, 10.0.0 rev. 160623)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.social.api.dll (Social Connected Module, 10.0.2-r03924-97f5950)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.social.client.api.dll (Social Connected Module, 10.0.2-r03924-97f5950)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.social.client.common.dll (Social Connected Module, 10.0.2-r03924-97f5950)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.social.client.dll (Social Connected Module, 10.0.2-r03924-97f5950)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.social.client.domain.dll (Social Connected Module, 10.0.2-r03924-97f5950)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.social.client.mvc.dll (Social Connected Module, 10.0.2-r03924-97f5950)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.social.client.publishingservice.dll (Social Connected Module, 10.0.2-r03924-97f5950)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.social.client.speak.dll (Social Connected Module, 10.0.2-r03924-97f5950)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.social.configuration.dll (Social Connected Module, 10.0.2-r03924-97f5950)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.social.dll (Social Connected Module, 10.0.2-r03924-97f5950)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.social.domain.dll (Social Connected Module, 10.0.2-r03924-97f5950)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.social.experienceprofile.client.dll (Social Connected Module, 10.0.2-r03924-97f5950)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.social.facebook.api.dll (Social Connected Module, 10.0.2-r03924-97f5950)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.social.facebook.client.dll (Social Connected Module, 10.0.2-r03924-97f5950)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.social.facebook.client.mvc.dll (Social Connected Module, 10.0.2-r03924-97f5950)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.social.facebook.dll (Social Connected Module, 10.0.2-r03924-97f5950)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.social.googleplus.client.dll (Social Connected Module, 10.0.2-r03924-97f5950)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.social.googleplus.client.mvc.dll (Social Connected Module, 10.0.2-r03924-97f5950)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.social.googleplus.dll (Social Connected Module, 10.0.2-r03924-97f5950)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.social.infrastructure.dll (Social Connected Module, 10.0.2-r03924-97f5950)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.social.infrastructure.logging.dll (Social Connected Module, 10.0.2-r03924-97f5950)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.social.installation.dll (Social Connected Module, 10.0.2-r03924-97f5950)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.social.klout.api.dll (Social Connected Module, 10.0.2-r03924-97f5950)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.social.klout.client.dll (Social Connected Module, 10.0.2-r03924-97f5950)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.social.linkedin.client.dll (Social Connected Module, 10.0.2-r03924-97f5950)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.social.linkedin.client.mvc.dll (Social Connected Module, 10.0.2-r03924-97f5950)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.social.linkedin.dll (Social Connected Module, 10.0.2-r03924-97f5950)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.social.networkproviders.dll (Social Connected Module, 10.0.2-r03924-97f5950)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.social.sitecoreaccess.dll (Social Connected Module, 10.0.2-r03924-97f5950)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.social.socialmarketer.api.dll (Social Connected Module, 10.0.2-r03924-97f5950)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.social.socialmarketer.client.dll (Social Connected Module, 10.0.2-r03924-97f5950)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.social.socialmarketer.dll (Social Connected Module, 10.0.2-r03924-97f5950)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.social.twitter.api.dll (Social Connected Module, 10.0.2-r03924-97f5950)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.social.twitter.client.dll (Social Connected Module, 10.0.2-r03924-97f5950)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.social.twitter.client.mvc.dll (Social Connected Module, 10.0.2-r03924-97f5950)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.social.twitter.dll (Social Connected Module, 10.0.2-r03924-97f5950)
12716 23:19:16 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.speak.applications.dll (Sitecore Speak Applications, 1.4.3-r00042-f6a50ff)
12716 23:19:17 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.speak.client.dll (Sitecore Speak, 2.1.4-r00019-ed0a7b1)
12716 23:19:17 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.speak.components.dll (Sitecore Speak Components, 2.1.4-r00039-315de3d)
12716 23:19:17 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.speak.components.guidance.dll (Sitecore Speak Components, 2.1.4-r00039-315de3d)
12716 23:19:17 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.speak.components.web.dll (Sitecore Speak Components, 2.1.4-r00039-315de3d)
12716 23:19:17 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.speak.itemwebapi.dll (Sitecore Speak, 2.1.4-r00019-ed0a7b1)
12716 23:19:17 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.speak.web.dll (Sitecore Speak, 2.1.4-r00019-ed0a7b1)
12716 23:19:17 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.update.dll (Sitecore Update Installation Wizard, 2.0.1-r00135-7060f87)
12716 23:19:17 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.web.dll (Sitecore.Web 1.2.0, 1.2.0 rev. 160603)
12716 23:19:17 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.xdb.client.dll (Sitecore xDB, 10.0.3-r00151-50c3b36)
12716 23:19:17 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.xdb.configuration.dll (Sitecore xDB, 10.0.3-r00151-50c3b36)
12716 23:19:17 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore.zip.dll (Sitecore Zip, ZIP support for Sitecore, 10.0.1-r00006-d7200ec)
12716 23:19:17 INFO  c:\repo\sitecore82\sitecore82\bin\sitecore82.dll (Sitecore82)
12716 23:19:17 INFO  c:\repo\sitecore82\sitecore82\bin\solrnet.dll (SolrNet, SolrNet, 17bf323fdcbbee137ca44af080426ea0b28cb626)
12716 23:19:17 INFO  c:\repo\sitecore82\sitecore82\bin\stackexchange.redis.strongname.dll (StackExchange.Redis, 1.0.488)
12716 23:19:17 INFO  c:\repo\sitecore82\sitecore82\bin\stimulsoft.base.dll (Stimulsoft Reports, Stimulsoft Base)
12716 23:19:17 INFO  c:\repo\sitecore82\sitecore82\bin\stimulsoft.database.dll (Stimulsoft Reports, Stimulsoft Reports Database Helper)
12716 23:19:17 INFO  c:\repo\sitecore82\sitecore82\bin\stimulsoft.report.dll (Stimulsoft Reports, Stimulsoft Reports Engine)
12716 23:19:17 INFO  c:\repo\sitecore82\sitecore82\bin\stimulsoft.report.web.dll (Stimulsoft Reports.Web, Stimulsoft Reports.Web Viewer)
12716 23:19:17 INFO  c:\repo\sitecore82\sitecore82\bin\stimulsoft.report.webdesign.dll (Stimulsoft Reports Designer.Web, Stimulsoft Reports Designer.Web)
12716 23:19:17 INFO  c:\repo\sitecore82\sitecore82\bin\system.identitymodel.tokens.jwt.dll (System.IdentityModel.Tokens.Jwt, .Net 4.5 support for JSON Web Security Tokens, 20622.1351.a95e76cc46fe08b6d46b5fbe2405d27269475a1a)
12716 23:19:17 INFO  c:\repo\sitecore82\sitecore82\bin\system.net.http.extensions.compression.core.dll (Core)
12716 23:19:17 INFO  c:\repo\sitecore82\sitecore82\bin\system.net.http.formatting.dll (Microsoft ASP.NET MVC, 5.2.3-30128 (0e974218e12a67d4b1f25422119e40cfe6953e46))
12716 23:19:17 INFO  c:\repo\sitecore82\sitecore82\bin\system.web.cors.dll (Microsoft ASP.NET MVC, 5.2.3-30128 (0e974218e12a67d4b1f25422119e40cfe6953e46))
12716 23:19:17 INFO  c:\repo\sitecore82\sitecore82\bin\system.web.helpers.dll (Microsoft ASP.NET Web Pages, 3.0.3-30128 (0e974218e12a67d4b1f25422119e40cfe6953e46))
12716 23:19:17 INFO  c:\repo\sitecore82\sitecore82\bin\system.web.http.cors.dll (Microsoft ASP.NET MVC, 5.2.3-30128 (0e974218e12a67d4b1f25422119e40cfe6953e46))
12716 23:19:17 INFO  c:\repo\sitecore82\sitecore82\bin\system.web.http.dll (Microsoft ASP.NET MVC, 5.2.3-30128 (0e974218e12a67d4b1f25422119e40cfe6953e46))
12716 23:19:17 INFO  c:\repo\sitecore82\sitecore82\bin\system.web.http.webhost.dll (Microsoft ASP.NET MVC, 5.2.3-30128 (0e974218e12a67d4b1f25422119e40cfe6953e46))
12716 23:19:17 INFO  c:\repo\sitecore82\sitecore82\bin\system.web.mvc.dll (Microsoft ASP.NET MVC, System.Web.Mvc.dll, 5.2.3-30128 (0e974218e12a67d4b1f25422119e40cfe6953e46))
12716 23:19:17 INFO  c:\repo\sitecore82\sitecore82\bin\system.web.odata.dll (Microsoft OData Web API, 5.9.0-40401)
12716 23:19:17 INFO  c:\repo\sitecore82\sitecore82\bin\system.web.optimization.dll (System.Web.Optimization)
12716 23:19:17 INFO  c:\repo\sitecore82\sitecore82\bin\system.web.razor.dll (Microsoft ASP.NET Web Pages, 3.0.3-30128 (0e974218e12a67d4b1f25422119e40cfe6953e46))
12716 23:19:17 INFO  c:\repo\sitecore82\sitecore82\bin\system.web.webpages.deployment.dll (Microsoft ASP.NET Web Pages, 3.0.3-30128 (0e974218e12a67d4b1f25422119e40cfe6953e46))
12716 23:19:17 INFO  c:\repo\sitecore82\sitecore82\bin\system.web.webpages.dll (Microsoft ASP.NET Web Pages, 3.0.3-30128 (0e974218e12a67d4b1f25422119e40cfe6953e46))
12716 23:19:17 INFO  c:\repo\sitecore82\sitecore82\bin\system.web.webpages.razor.dll (Microsoft ASP.NET Web Pages, 3.0.3-30128 (0e974218e12a67d4b1f25422119e40cfe6953e46))
12716 23:19:17 INFO  c:\repo\sitecore82\sitecore82\bin\telerik.web.ui.dll (Telerik.Web.UI, Telerik UI for ASP.NET AJAX)
12716 23:19:17 INFO  c:\repo\sitecore82\sitecore82\bin\telerik.web.ui.skins.dll (Telerik.Web.UI.Skins, Telerik UI for ASP.NET AJAX Ajax Skins)
12716 23:19:17 INFO  c:\repo\sitecore82\sitecore82\bin\tweetsharp.dll (TweetSharp)
12716 23:19:17 INFO  c:\repo\sitecore82\sitecore82\bin\webactivatorex.dll (WebActivator, A package that allows other packages to execute some startup code in web apps. This package should be used over the older WebActivator, which was not strong named)
12716 23:19:17 INFO  c:\repo\sitecore82\sitecore82\bin\webgrease.dll (WebGrease)
12716 23:19:17 INFO  c:\repo\sitecore82\sitecore82\bin\windowsazureeventsource.dll (Windows Azure Runtime, 2.7.1198.742 (rd_art_stable.151102-1219))
12716 23:19:17 INFO  c:\repo\sitecore82\sitecore82\bin\windowsazuretelemetryevents.dll (Windows Azure Runtime, 2.7.1198.742 (rd_art_stable.151102-1219))
12716 23:19:17 INFO  c:\repo\sitecore82\sitecore82\bin\yahoo.yui.compressor.dll (YUI Compressor, A .NET port of the Yahoo! YUI Compressor project)
12716 23:19:17 INFO  
12716 23:19:17 INFO  Operating system Microsoft Windows NT 6.3.9600.0
12716 23:19:17 INFO  
12716 23:19:17 INFO  Microsoft.NET version 4.0.30319.42000
12716 23:19:17 INFO  
12716 23:19:17 INFO  UTC offset: 01:00:00
12716 23:19:17 INFO  Machine name: win81qwerty
12716 23:19:17 INFO  App pool ID: sitecore82
12716 23:19:17 INFO  
12716 23:19:17 INFO  Process ID: 14432
12716 23:19:17 INFO  Windows identity used by the process: IIS APPPOOL\sitecore82. Impersonation: False
12716 23:19:17 INFO  Managed pipeline mode: Integrated
12716 23:19:17 INFO  
12716 23:19:17 INFO  EventQueues enabled: True
12716 23:19:17 INFO  Instance Name:WIN81QWERTY-sitecore82
12716 23:19:17 INFO  
12716 23:19:17 INFO  Threshold settings
12716 23:19:17 INFO    Show threshold warnings: False
12716 23:19:17 INFO  
12716 23:19:17 INFO  Databases
12716 23:19:17 INFO    core
12716 23:19:17 INFO    master
12716 23:19:17 INFO    web
12716 23:19:17 INFO    filesystem
12716 23:19:17 INFO  
12716 23:19:17 INFO  Domains
12716 23:19:17 INFO  Heartbeat - Initializing
12716 23:19:17 INFO  Heartbeat - Interval set to: 00:00:02
12716 23:19:17 INFO  Heartbeat - Worker thread started
12716 23:19:17 INFO  Trying to load XML configuration /App_Config/Security/Domains.config
12716 23:19:17 INFO    default
12716 23:19:17 INFO    extranet
12716 23:19:17 INFO    sitecore
12716 23:19:17 INFO  **********************************************************************
12716 23:19:17 INFO  **********************************************************************
ManagedPoolThread #0 23:19:17 WARN  Failed to create counter 'Sitecore.Jobs\Jobs | Jobs Executed / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #5 23:19:17 WARN  Failed to create counter 'Sitecore.Jobs\Pipelines | Pipelines Aborted / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #6 23:19:17 WARN  Failed to create counter 'Sitecore.Jobs\Pipelines | Pipelines Executed / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #7 23:19:17 WARN  Failed to create counter 'Sitecore.Jobs\Pipelines | Processors Executed / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #4 23:19:17 WARN  Failed to create counter 'Sitecore.Jobs\Publishing | Items Queued / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #8 23:19:17 WARN  Failed to create counter 'Sitecore.Jobs\Publishing | Replacements / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #9 23:19:17 WARN  Failed to create counter 'Sitecore.Jobs\Tasks | File Cleanups / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #10 23:19:17 WARN  Failed to create counter 'Sitecore.Jobs\Tasks | Html Cache Clearings / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #12 23:19:17 WARN  Failed to create counter 'Sitecore.Jobs\Tasks | Publishings / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #11 23:19:17 WARN  Failed to create counter 'Sitecore.Jobs\Tasks | Reminders Sent / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #13 23:19:17 WARN  Failed to create counter 'Sitecore.Jobs\Tasks | Tasks Executed / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
12716 23:19:17 INFO  
12716 23:19:17 INFO  **********************************************************************
12716 23:19:17 INFO  **********************************************************************
12716 23:19:17 INFO  
ManagedPoolThread #2 23:19:19 INFO  Trying to load XML configuration /App_Config/Security/Domains.config
12716 23:19:20 INFO  xDB is enabled.
12716 23:19:20 INFO  
12716 23:19:20 INFO  Tracking is enabled.
12716 23:19:20 INFO  
12716 23:19:20 INFO  Valid xDB license is present.
12716 23:19:20 INFO  
12716 23:19:20 INFO  **********************************************************************
12716 23:19:20 INFO  **********************************************************************
12716 23:19:20 INFO  [Path Analyzer](ApplicationContainer.RegisterType) Sitecore.SequenceAnalyzer.Data.ITreeStorage
12716 23:19:20 INFO  [Path Analyzer](ApplicationContainer.RegisterType) Sitecore.PathAnalyzer.Data.Storage.ITreeDefinitionStorage
12716 23:19:20 INFO  [Path Analyzer](ApplicationContainer.RegisterType) Sitecore.PathAnalyzer.Contracts.ITreeDefinitionService
12716 23:19:20 INFO  [Path Analyzer](ApplicationContainer.RegisterType) Sitecore.PathAnalyzer.Contracts.IMapItemRepository
12716 23:19:20 INFO  [Path Analyzer](ApplicationContainer.RegisterType) Sitecore.PathAnalyzer.Contracts.IMapStatusService
12716 23:19:20 INFO  [Path Analyzer](ApplicationContainer.RegisterType) Sitecore.PathAnalyzer.Contracts.IConfiguration
12716 23:19:20 INFO  [Path Analyzer](ApplicationContainer.RegisterType) Sitecore.SequenceAnalyzer.Configuration.IPruningConfig
12716 23:19:20 INFO  [Path Analyzer](ApplicationContainer.RegisterType) Sitecore.PathAnalyzer.Contracts.IContactReader
12716 23:19:20 INFO  [Path Analyzer](ApplicationContainer.RegisterType) Sitecore.PathAnalyzer.Localization.IResourceManager
12716 23:19:20 INFO  [Path Analyzer](ApplicationContainer.RegisterType) Sitecore.PathAnalyzer.Data.Caching.ICache
12716 23:19:20 INFO  [Path Analyzer](ApplicationContainer.RegisterType) Sitecore.PathAnalyzer.Contracts.ITreeProvider
12716 23:19:20 INFO  [Path Analyzer](ApplicationContainer.RegisterType) Sitecore.PathAnalyzer.Data.SitecoreData.IItemRepository
12716 23:19:20 INFO  [Path Analyzer](ApplicationContainer.RegisterType) Sitecore.PathAnalyzer.Contracts.IMapItemDeploymentManager
12716 23:19:20 INFO  [Path Analyzer](ApplicationContainer.RegisterType) Sitecore.PathAnalyzer.Data.Storage.ITreeStorageManager
12716 23:19:20 INFO  [Path Analyzer](ApplicationContainer.RegisterModelsForSerialization) Setting serialization info
12716 23:19:20 INFO  [Path Analyzer](ApplicationContainer.RegisterModelsForSerialization) Type 'Sitecore.PathAnalyzer.Data.Models.ExperienceNode, Sitecore.PathAnalyzer' was registered succesfully.
12716 23:19:20 INFO  [Path Analyzer](ApplicationContainer.RegisterModelsForSerialization) Type 'Sitecore.PathAnalyzer.Data.Models.ExperienceTree, Sitecore.PathAnalyzer' was registered succesfully.
12716 23:19:20 INFO  [Path Analyzer](ApplicationContainer.RegisterModelsForSerialization) Type 'Sitecore.PathAnalyzer.Data.Models.PageNode, Sitecore.PathAnalyzer' was registered succesfully.
12716 23:19:20 INFO  MemoryMonitor initialized. Threshold: 2 GB. Interval: 00:00:05
12716 23:19:20 INFO  [Analytics]: Started background service for 'maintenanceService'.
12716 23:19:20 INFO  [Analytics]: Started background service for 'aggregation/aggregator'.
12716 23:19:20 INFO  [Analytics]: Started background service for 'aggregation/contactProcessing'.
12716 23:19:20 INFO  [Analytics]: Started background service for 'aggregation/rebuildAgent'.
12716 23:19:20 INFO  [Analytics]: Started background service for 'aggregation/historyWorker'.
12716 23:19:20 INFO  [Analytics]: Started background service for 'aggregation/historyCompletionCheck'.
12716 23:19:20 INFO  [Analytics]: Started background service for 'aggregation/automationAggregator'.
12716 23:19:20 INFO  [Analytics]: Started background service for 'aggregation/automationRangeManager'.
12716 23:19:20 INFO  [Analytics]: Started background service for 'aggregation/automationCleanupService'.
12716 23:19:20 INFO  [Analytics]: Automation aggregation SubsystemLoader hook initialized.
12716 23:19:20 INFO  [Analytics]: Started background service for 'processing/taskAgent'.
12716 23:19:20 INFO  Cache created: 'rules' (max size: 800KB, running total: 800KB)
12716 23:19:20 INFO  Cache created: 'ProxyProvider' (max size: 2MB, running total: 3MB)
12716 23:19:20 INFO  Cache created: 'DeviceItemsCache' (max size: 50MB, running total: 53MB)
12716 23:19:20 INFO  Cache created: 'core[data]' (max size: 100MB, running total: 153MB)
12716 23:19:20 INFO  Cache created: 'core[items]' (max size: 50MB, running total: 203MB)
12716 23:19:20 INFO  Cache created: 'core[paths]' (max size: 2MB, running total: 205MB)
12716 23:19:20 INFO  Cache created: 'core[standardValues]' (max size: 2MB, running total: 208MB)
12716 23:19:20 INFO  Cache created: 'core[languageFallbackObsolete]' (max size: 20MB, running total: 228MB)
12716 23:19:20 INFO  Cache created: 'core[languageFallback]' (max size: 20MB, running total: 248MB)
12716 23:19:20 INFO  Cache created: 'core[isLanguageFallbackValid]' (max size: 100KB, running total: 248MB)
12716 23:19:20 INFO  Cache created: 'core[isLanguageFallbackValidObsolete]' (max size: 100KB, running total: 248MB)
12716 23:19:20 INFO  Cache created: 'core[itempaths]' (max size: 50MB, running total: 298MB)
12716 23:19:20 INFO  Cache created: 'core[blobIDs]' (max size: 5MB, running total: 303MB)
12716 23:19:20 INFO  Cache created: 'master[data]' (max size: 100MB, running total: 403MB)
12716 23:19:20 INFO  Cache created: 'master[items]' (max size: 50MB, running total: 453MB)
12716 23:19:20 INFO  Cache created: 'master[paths]' (max size: 2MB, running total: 455MB)
12716 23:19:20 INFO  Cache created: 'master[standardValues]' (max size: 2MB, running total: 458MB)
12716 23:19:20 INFO  Cache created: 'master[languageFallbackObsolete]' (max size: 20MB, running total: 478MB)
12716 23:19:20 INFO  Cache created: 'master[languageFallback]' (max size: 20MB, running total: 498MB)
12716 23:19:20 INFO  Cache created: 'master[isLanguageFallbackValid]' (max size: 100KB, running total: 498MB)
12716 23:19:20 INFO  Cache created: 'master[isLanguageFallbackValidObsolete]' (max size: 100KB, running total: 498MB)
12716 23:19:20 INFO  Cache created: 'master[itempaths]' (max size: 50MB, running total: 548MB)
12716 23:19:20 INFO  Cache created: 'master[blobIDs]' (max size: 5MB, running total: 553MB)
12716 23:19:20 INFO  Cache created: 'web[data]' (max size: 100MB, running total: 653MB)
12716 23:19:20 INFO  Cache created: 'web[items]' (max size: 50MB, running total: 703MB)
12716 23:19:20 INFO  Cache created: 'web[paths]' (max size: 2MB, running total: 705MB)
12716 23:19:20 INFO  Cache created: 'web[standardValues]' (max size: 2MB, running total: 708MB)
12716 23:19:20 INFO  Cache created: 'web[languageFallbackObsolete]' (max size: 20MB, running total: 728MB)
12716 23:19:20 INFO  Cache created: 'web[languageFallback]' (max size: 20MB, running total: 748MB)
12716 23:19:20 INFO  Cache created: 'web[isLanguageFallbackValid]' (max size: 100KB, running total: 748MB)
12716 23:19:20 INFO  Cache created: 'web[isLanguageFallbackValidObsolete]' (max size: 100KB, running total: 748MB)
12716 23:19:20 INFO  Cache created: 'web[itempaths]' (max size: 50MB, running total: 798MB)
12716 23:19:20 INFO  Cache created: 'web[blobIDs]' (max size: 5MB, running total: 803MB)
12716 23:19:20 INFO  Cache created: 'filesystem[data]' (max size: 0 bytes, running total: 803MB)
12716 23:19:20 INFO  Cache created: 'filesystem[items]' (max size: 0 bytes, running total: 803MB)
12716 23:19:20 INFO  Cache created: 'filesystem[paths]' (max size: 0 bytes, running total: 803MB)
12716 23:19:20 INFO  Cache created: 'filesystem[standardValues]' (max size: 0 bytes, running total: 803MB)
12716 23:19:20 INFO  Cache created: 'filesystem[languageFallbackObsolete]' (max size: 20MB, running total: 823MB)
12716 23:19:20 INFO  Cache created: 'filesystem[languageFallback]' (max size: 20MB, running total: 843MB)
12716 23:19:20 INFO  Cache created: 'filesystem[isLanguageFallbackValid]' (max size: 100KB, running total: 843MB)
12716 23:19:20 INFO  Cache created: 'filesystem[isLanguageFallbackValidObsolete]' (max size: 100KB, running total: 843MB)
12716 23:19:20 INFO  Cache created: 'filesystem[itempaths]' (max size: 50MB, running total: 893MB)
12716 23:19:20 INFO  Cache created: 'filesystem[blobIDs]' (max size: 5MB, running total: 898MB)
12716 23:19:21 INFO  Cache created: '[FieldReaderCache, Id: defaultFieldReaderMap]' (max size: 5MB, running total: 903MB)
12716 23:19:22 INFO  Cache created: 'SqlDataProvider - Property data(core)' (max size: 5MB, running total: 908MB)
ManagedPoolThread #0 23:19:22 WARN  Failed to create counter 'Sitecore.Caching\Cache Clearings / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #5 23:19:22 WARN  Failed to create counter 'Sitecore.Caching\Cache Hits / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #6 23:19:22 WARN  Failed to create counter 'Sitecore.Caching\Cache Misses / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #7 23:19:22 WARN  Failed to create counter 'Sitecore.Caching\Data Cache Clearings / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #4 23:19:22 WARN  Failed to create counter 'Sitecore.Caching\Data Cache Hits / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #8 23:19:22 WARN  Failed to create counter 'Sitecore.Caching\Data Cache Misses / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #9 23:19:22 WARN  Failed to create counter 'Sitecore.Caching\Html Cache Clearings / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #10 23:19:22 WARN  Failed to create counter 'Sitecore.Caching\Html Cache Hits / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #12 23:19:22 WARN  Failed to create counter 'Sitecore.Caching\Html Cache Misses / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #11 23:19:22 WARN  Failed to create counter 'Sitecore.Caching\Path Cache Clearings / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #13 23:19:22 WARN  Failed to create counter 'Sitecore.Caching\Path Cache Hits / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #1 23:19:22 WARN  Failed to create counter 'Sitecore.Caching\Path Cache Misses / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #2 23:19:22 WARN  Failed to create counter 'Sitecore.Caching\Registry Cache Clearings / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #3 23:19:22 WARN  Failed to create counter 'Sitecore.Caching\Registry Cache Hits / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #0 23:19:22 WARN  Failed to create counter 'Sitecore.Caching\Registry Cache Misses / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #5 23:19:22 WARN  Failed to create counter 'Sitecore.Caching\View State Cache Clearings / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #6 23:19:22 WARN  Failed to create counter 'Sitecore.Caching\View State Cache Hits / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #7 23:19:22 WARN  Failed to create counter 'Sitecore.Caching\View State Cache Misses / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #4 23:19:22 WARN  Failed to create counter 'Sitecore.Caching\XslCache Clearings / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #8 23:19:22 WARN  Failed to create counter 'Sitecore.Caching\XslCache Hits / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #9 23:19:22 WARN  Failed to create counter 'Sitecore.Caching\XslCache Misses / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #10 23:19:22 WARN  Failed to create counter 'Sitecore.Data\Data | Client Data Reads / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #12 23:19:22 WARN  Failed to create counter 'Sitecore.Data\Data | Client Data Writes / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #11 23:19:22 WARN  Failed to create counter 'Sitecore.Data\Data | Items Accessed / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #11 23:19:22 WARN  Failed to create counter 'Sitecore.Data\Data | Physical Reads / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #1 23:19:22 WARN  Failed to create counter 'Sitecore.Data\Data | Physical Writes / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #2 23:19:22 WARN  Failed to create counter 'Sitecore.Data\Globalization | Texts Translated / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #3 23:19:22 WARN  Failed to create counter 'Sitecore.Data\Globalization | Translate Failed / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #0 23:19:22 WARN  Failed to create counter 'Sitecore.Data\Links | Fields Examined / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #5 23:19:22 WARN  Failed to create counter 'Sitecore.Data\Links | Data Read / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #5 23:19:22 WARN  Failed to create counter 'Sitecore.Data\Links | Data Updated / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #5 23:19:22 WARN  Failed to create counter 'Sitecore.Data\SqlServerStream | Open Streams / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #4 23:19:22 WARN  Failed to create counter 'Sitecore.Data\StreamSharer | Open Streams / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #4 23:19:22 WARN  Failed to create counter 'Sitecore.Data\Workflow | Actions Executed / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #4 23:19:22 WARN  Failed to create counter 'Sitecore.Data\Workflow | Security Resolved / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #10 23:19:22 WARN  Failed to create counter 'Sitecore.Data\Workflow | State Changes / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
21228 23:19:22 INFO  Cache created: 'SqlDataProvider - Property data(master)' (max size: 5MB, running total: 913MB)
12716 23:19:23 INFO  Cache created: 'taxonomy.campaigngroups' (max size: 20MB, running total: 933MB)
12716 23:19:23 INFO  Cache created: 'taxonomy.channels' (max size: 20MB, running total: 953MB)
12716 23:19:23 INFO  Cache created: 'taxonomy.venues' (max size: 20MB, running total: 973MB)
12716 23:19:23 INFO  Cache created: 'taxonomy.assets' (max size: 20MB, running total: 993MB)
12716 23:19:23 INFO  Cache created: 'taxonomy.outcomeGroups' (max size: 20MB, running total: 1013MB)
12716 23:19:23 INFO  [Analytics]: Started background service for 'pathAnalyzer/newMapAgent'.
12716 23:19:23 INFO  [Analytics]: Started background service for 'pathAnalyzer/smartMergeAgent'.
12716 23:19:23 INFO  [Analytics]: Started background service for 'aggregation/pathAnalyzerLiveAgent'.
12716 23:19:23 INFO  [Analytics]: Started background service for 'aggregation/pathAnalyzerHistoryAgent'.
12716 23:19:23 INFO  [Analytics]: Started background service for 'pathAnalyzer/trailCleanupAgent'.
12716 23:19:23 INFO  [Analytics]: Started background service for 'pathAnalyzer/mapRebuildStatusCheckerAgent'.
12716 23:19:23 INFO  [Path Analyzer](.) Path Analyzer subsystem hook initialized.
21228 23:19:23 INFO  Cache created: 'SqlDataProvider - Property data(web)' (max size: 5MB, running total: 1018MB)
12716 23:19:23 WARN  Authentication on CES Discovery service failed.
Exception: System.Net.WebException
Message: The remote server returned an error: (403) Forbidden.
Source: System
   at System.Net.HttpWebRequest.GetResponse()
   at Sitecore.CES.Client.WebClient.ExecuteRequest(String requestUri)
   at Sitecore.CES.Client.ResourceConnector`1.Request(String endpoint, Object[] parameters)
   at Sitecore.CES.Discovery.EndpointSource.GetEndpoint(String serviceName)

12716 23:19:23 WARN  No subscription for Device Detection service. Could not load the database.
12716 23:19:23 WARN  Device detection component is disabled
12716 23:19:23 INFO  [Analytics]: Started background service for 'experienceAnalytics/reduce/agent'.
12716 23:19:23 INFO  [Experience Analytics]: Experience Analytics subsystem initialized.
12716 23:19:23 INFO  Cache created: 'LanguageProvider - Languages' (max size: 100KB, running total: 1018MB)
12716 23:19:23 INFO  Scheduler - Initializing
12716 23:19:23 INFO  Scheduler - Interval set to: 00:00:05
12716 23:19:23 INFO  Scheduler - Worker thread started
ManagedPoolThread #6 23:19:23 WARN  Failed to create counter 'Sitecore.Automation\State Transitions / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #7 23:19:23 WARN  Failed to create counter 'Sitecore.Automation\State Evaluations - Total / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #4 23:19:23 WARN  Failed to create counter 'Sitecore.Automation\State Evaluations - Page Events / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #8 23:19:23 WARN  Failed to create counter 'Sitecore.Automation\State Evaluations - Timeouts / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #9 23:19:23 WARN  Failed to create counter 'Sitecore.Automation\Emails Sent / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #10 23:19:23 WARN  Failed to create counter 'Sitecore.Automation\Average Evaluation Time'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #12 23:19:23 WARN  Failed to create counter 'Sitecore.Automation\Average Evaluation Time Average Base'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #13 23:19:23 WARN  Failed to create counter 'Sitecore.Automation\Average State Load Time - Contact'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #6 23:19:23 WARN  Failed to create counter 'Sitecore.Automation\Average State Load Time - Contact Average Base'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #7 23:19:23 WARN  Failed to create counter 'Sitecore.Automation\Monitor - Average Time to Load Data - ms'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #4 23:19:23 WARN  Failed to create counter 'Sitecore.Automation\Monitor - Average Time to Load Data - ms Average Base'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #8 23:19:23 WARN  Failed to create counter 'Sitecore.Automation\Aggregation | Automation Transitions Aggregated / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #9 23:19:23 WARN  Failed to create counter 'Sitecore.Automation\Aggregation | Contact States Aggregated / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #10 23:19:23 WARN  Failed to create counter 'Sitecore.Automation\Aggregation | Transition Aggregation Errors / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #12 23:19:23 WARN  Failed to create counter 'Sitecore.Automation\Aggregation | Contact State Aggregation Errors / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #13 23:19:23 WARN  Failed to create counter 'Sitecore.Automation\Aggregation | Average Automation Aggregation Pipeline Time / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #6 23:19:23 WARN  Failed to create counter 'Sitecore.Automation\Aggregation | Average Automation Aggregation Pipeline Time / sec Average Base'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #7 23:19:23 WARN  Failed to create counter 'Sitecore.Automation\Aggregation | Average Transition Store In Reporting / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #4 23:19:23 WARN  Failed to create counter 'Sitecore.Automation\Aggregation | Average Transition Store In Reporting / sec Average Base'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #8 23:19:23 WARN  Failed to create counter 'Sitecore.Automation\Aggregation | Average Contact States Store In Reporting / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #9 23:19:23 WARN  Failed to create counter 'Sitecore.Automation\Aggregation | Average Contact States Store In Reporting / sec Average Base'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #10 23:19:23 WARN  Failed to create counter 'Sitecore.Automation\Data | Average Delete Aggregated Transitions Time / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #12 23:19:23 WARN  Failed to create counter 'Sitecore.Automation\Data | Average Delete Aggregated Transitions Time / sec Average Base'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #13 23:19:23 WARN  Failed to create counter 'Sitecore.Automation\Data | Average Merge Transition Time/ sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #6 23:19:23 WARN  Failed to create counter 'Sitecore.Automation\Data | Average Merge Transition Time/ sec Average Base'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
12716 23:19:23 INFO  Sitecore.Analytics.Automation.Diagnostics.PerformanceCounters are initialized
ManagedPoolThread #7 23:19:23 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\Collection | Total Requests / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #4 23:19:23 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\Collection | Requests Tracked / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #8 23:19:23 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\Collection | Requests Ignored / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #9 23:19:23 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\Collection | Malicious Robot Requests / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #10 23:19:23 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\Collection | Robot Requests / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #12 23:19:23 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\Collection | Human Requests / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #13 23:19:23 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\Collection | Total Visits / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #6 23:19:23 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\Collection | Unique Visitors / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #7 23:19:23 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\Data | Dictionaries - Locations Reads / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #4 23:19:23 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\Data | Dictionaries - Locations Cache Hits / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #8 23:19:23 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\Data | Dictionaries - Locations Database Reads / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #9 23:19:23 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\Data | Dictionaries - Locations Writes / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #10 23:19:23 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\Data | Dictionaries - ReferringSites Reads / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #12 23:19:23 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\Data | Dictionaries - ReferringSites Cache Hits / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #13 23:19:23 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\Data | Dictionaries - ReferringSites Database Reads / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #6 23:19:23 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\Data | Dictionaries - ReferringSites Writes / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #7 23:19:23 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\Data | Dictionaries - UserAgents Reads / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #4 23:19:23 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\Data | Dictionaries - UserAgents Cache Hits / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #8 23:19:23 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\Data | Dictionaries - UserAgents Database Reads / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #9 23:19:23 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\Data | Dictionaries - UserAgents Writes / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #10 23:19:23 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\Data | Dictionaries - GeoIps Reads / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #12 23:19:23 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\Data | Dictionaries - GeoIps Cache Hits / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #13 23:19:23 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\Data | Dictionaries - GeoIps Database Reads / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #6 23:19:23 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\Data | Dictionaries - GeoIps Writes / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #7 23:19:23 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\GeoIP | Requests - Total / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #4 23:19:23 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\GeoIP | Requests - Pages / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #8 23:19:23 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\GeoIP | Requests - Background / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #9 23:19:23 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\GeoIP | Memory Lookups / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #10 23:19:23 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\GeoIP | Database Lookups / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #12 23:19:23 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\GeoIP | Provider Lookups / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #13 23:19:23 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\GeoIP | Failed Lookups / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #6 23:19:23 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\GeoIP | Unknown IPs / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #7 23:19:23 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\GeoIP | Average Resolve Time'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #4 23:19:23 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\GeoIP | Average Resolve Time Average Base'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #8 23:19:23 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\GeoIP | Cache Size'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #9 23:19:23 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\GeoIP | Visits Updated / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #10 23:19:23 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\GeoIP | Average Calls Before IP Resolved'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #12 23:19:23 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\GeoIP | Average Calls Before IP Resolved Average Base'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
12716 23:19:23 INFO  Sitecore.Analytics.Tracking.Diagnostics.PerformanceCounters are initialized
ManagedPoolThread #13 23:19:23 WARN  Failed to create counter 'Sitecore.Analytics\Data | Rows Saved - Total / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #6 23:19:23 WARN  Failed to create counter 'Sitecore.Analytics\Data | Rows Saved - Bulk Copy / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #7 23:19:23 WARN  Failed to create counter 'Sitecore.Analytics\Data | Rows Saved - Batch / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #4 23:19:23 WARN  Failed to create counter 'Sitecore.Analytics\Data | Rows Saved - Row By Row / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #8 23:19:23 WARN  Failed to create counter 'Sitecore.Analytics\Data | Rows Failed to Save / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #9 23:19:23 WARN  Failed to create counter 'Sitecore.Analytics\Data | Commit Queue Length'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #10 23:19:23 WARN  Failed to create counter 'Sitecore.Analytics\Data | Commit Queue Flush Length'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #12 23:19:23 WARN  Failed to create counter 'Sitecore.Analytics\Data | Tracker Flushes - Total / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #13 23:19:23 WARN  Failed to create counter 'Sitecore.Analytics\Data | Tracker Flushes - Explicit / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #6 23:19:23 WARN  Failed to create counter 'Sitecore.Analytics\Data | Tracker Flushes - Inline / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #7 23:19:23 WARN  Failed to create counter 'Sitecore.Analytics\Data | Tracker Flushes - Timeout / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #4 23:19:23 WARN  Failed to create counter 'Sitecore.Analytics\Data | Tracker Flushes - Capacity Overflow'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #8 23:19:23 WARN  Failed to create counter 'Sitecore.Analytics\Data | Average Tracker Flush Time'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #9 23:19:23 WARN  Failed to create counter 'Sitecore.Analytics\Data | Average Tracker Flush Time Average Base'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #10 23:19:23 WARN  Failed to create counter 'Sitecore.Analytics\Data | Last Tracker Flush Time'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #12 23:19:23 WARN  Failed to create counter 'Sitecore.Analytics\Data | Aggregation - Visits saved to reporting database / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #13 23:19:23 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Live Interactions Processed / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #6 23:19:23 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | History Interactions Processed / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #7 23:19:23 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Total Interactions Processed / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #4 23:19:23 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Live Aggregation Errors / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #8 23:19:23 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | History Aggregation Errors / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #9 23:19:23 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Total Aggregation Errors / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #10 23:19:23 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Contacts Processed / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #12 23:19:23 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Contact Processing Errors / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #13 23:19:23 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Average Batch Size - Live'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #6 23:19:23 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Average Batch Size - Live Average Base'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #7 23:19:23 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Average Batch Size - History'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #4 23:19:23 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Average Batch Size - History Average Base'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #8 23:19:23 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Number of Batches Containing Failing Items - Live'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #9 23:19:23 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Number of Batches Containing Failing Items - History'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #10 23:19:23 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Average Aggregation Pipeline Time (ms)'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #12 23:19:23 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Average Aggregation Pipeline Time (ms) Average Base'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #13 23:19:23 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Average Write Time (ms)'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #6 23:19:23 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Average Write Time (ms) Average Base'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #7 23:19:23 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Average Contact Processing Pipeline Time (ms)'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #4 23:19:23 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Average Contact Processing Pipeline Time (ms) Average Base'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #8 23:19:23 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Average Write Time - Primary (ms)'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #9 23:19:23 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Average Write Time - Primary (ms) Average Base'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #10 23:19:23 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Average Write Time - Secondary, Live (ms)'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #12 23:19:23 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Average Write Time - Secondary, Live (ms) Average Base'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #13 23:19:23 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Average Write Time - Secondary, History (ms)'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #6 23:19:23 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Average Write Time - Secondary, History (ms) Average Base'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #7 23:19:23 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Active Interaction Aggregators'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #4 23:19:23 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Average Check Out Time - Live (ms)'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #8 23:19:23 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Average Check Out Time - Live (ms) Average Base'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #9 23:19:23 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Average Check In Time - Live (ms)'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #10 23:19:23 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Average Check In Time - Live (ms) Average Base'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #12 23:19:23 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Average Check Out Time - History (ms)'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #13 23:19:23 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Average Check Out Time - History (ms) Average Base'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #6 23:19:23 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Average Check In Time - History (ms)'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #7 23:19:23 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Average Check In Time - History (ms) Average Base'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
12716 23:19:23 INFO  Sitecore.Analytics.Diagnostics.PerformanceCounters are initialized
12716 23:19:23 INFO  DumpConfigurationFiles: Started
11684 23:19:23 INFO  DumpConfigurationFiles: Dump folder is C:\Repo\Sitecore82\Sitecore82\data\diagnostics\configuration_history\20170714Z.221923Z
11684 23:19:24 INFO  DumpConfigurationFiles: C:\Repo\Sitecore82\Sitecore82\App_Config has been dumped
11684 23:19:24 INFO  DumpConfigurationFiles: C:\Repo\Sitecore82\Sitecore82\Web.config has been dumped
11684 23:19:24 INFO  DumpConfigurationFiles: C:\Repo\Sitecore82\Sitecore82\Global.asax has been dumped
11684 23:19:24 INFO  DumpConfigurationFiles: C:\Repo\Sitecore82\Sitecore82\sitecore\shell\sitecore.version.xml has been dumped
11684 23:19:24 INFO  DumpConfigurationFiles: Zipping of the dumped configuration files is enabled
ManagedPoolThread #11 23:19:24 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
11684 23:19:25 INFO  DumpConfigurationFiles: C:\Repo\Sitecore82\Sitecore82\data\diagnostics\configuration_history\20170714Z.221923Z.zip has been created
ManagedPoolThread #9 23:19:25 INFO  Job started: Update device detection DB
ManagedPoolThread #0 23:19:25 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
11684 23:19:26 INFO  DumpConfigurationFiles: C:\Repo\Sitecore82\Sitecore82\data\diagnostics\configuration_history\20170714Z.221923Z has been removed
11684 23:19:26 INFO  DumpConfigurationFiles: Completed
ManagedPoolThread #2 23:19:27 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 23:19:28 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
20176 23:19:28 INFO  Scheduler - Adding agents
20176 23:19:28 INFO  Scheduler - Adding agent: Sitecore.Tasks.UrlAgent (interval: 00:15:00)
20176 23:19:28 INFO  Scheduler - Adding agent: Sitecore.Tasks.TaskDatabaseAgent (interval: 00:10:00)
20176 23:19:28 INFO  Scheduler - Adding agent: Sitecore.Tasks.CompactClientDataAgent (interval: 04:00:00)
20176 23:19:28 INFO  Scheduler - Adding agent: Sitecore.Tasks.CleanupHistory (interval: 04:00:00)
20176 23:19:28 INFO  Scheduler - Adding agent: Sitecore.Tasks.CleanupPublishQueue (interval: 04:00:00)
20176 23:19:28 INFO  Scheduler - Adding agent: Sitecore.Tasks.CleanupEventQueue (interval: 04:00:00)
20176 23:19:28 INFO  Scheduler - Skipping inactive agent: Sitecore.Tasks.HtmlCacheClearAgent
20176 23:19:28 INFO  Scheduler - Adding agent: Sitecore.Tasks.CleanupAuthenticationTicketsAgent (interval: 04:00:00)
20176 23:19:28 INFO  Scheduler - Skipping inactive agent: Sitecore.Tasks.PublishAgent
20176 23:19:28 INFO  Scheduler - Adding agent: Sitecore.Tasks.CleanupAgent (interval: 06:00:00)
20176 23:19:28 INFO  Scheduler - Adding agent: Sitecore.Tasks.CounterDumpAgent (interval: 01:00:00)
20176 23:19:28 INFO  Scheduler - Adding agent: Sitecore.Tasks.CloneNotificationsCleanupAgent (interval: 1.00:00:00)
20176 23:19:28 INFO  Scheduler - Adding agent: Sitecore.Analytics.Tasks.EmailReportsTask (interval: 01:00:00)
20176 23:19:28 INFO  Scheduler - Adding agent: Sitecore.ContentSearch.Tasks.Optimize (interval: 12:00:00)
20176 23:19:28 INFO  Scheduler - Adding agent: Sitecore.PathAnalyzer.Client.Tasks.HelpUpdateAgent (interval: 03:00:00)
20176 23:19:28 INFO  Scheduler - Adding agent: Sitecore.PathAnalyzer.Client.Tasks.HelpUpdateAgent (interval: 03:00:00)
20176 23:19:28 INFO  Scheduler - Adding agent: Core_Database_Agent (interval: 00:10:00)
20176 23:19:28 INFO  Scheduler - Adding agent: Master_Database_Agent (interval: 00:10:00)
20176 23:19:28 INFO  Scheduler - Adding agent: Sitecore.Tasks.CleanupFDAObsoleteMediaData (interval: 1.00:00:00)
20176 23:19:28 INFO  Scheduler - Adding agent: Sitecore.Tasks.WebDAVOptionsCleanupAgent (interval: 1.00:00:00)
ManagedPoolThread #5 23:19:29 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
12716 23:19:29 INFO  Sitecore.Social: The Social MVC area is registered.
20176 23:19:29 INFO  Scheduler - Skipping inactive agent: Sitecore.Social.Client.Tasks.ManagePreExpiredAccounts
20176 23:19:29 INFO  Scheduler - Skipping inactive agent: Sitecore.Social.Client.Tasks.SynchronizeSocialMediaInfo
20176 23:19:29 INFO  Scheduler - Adding agent: Sitecore.Social.Client.Tasks.PostFlaggedMessages (interval: 01:00:00)
20176 23:19:29 INFO  Scheduler - Adding agent: Sitecore.Social.Client.Tasks.UpdateMessagesStatistics (interval: 01:00:00)
20176 23:19:29 INFO  Scheduler - Agents added
12716 23:19:29 INFO  [Sitecore Mvc]: Sitecore MVC IAssemblyResolver contains 178 assemblies
ManagedPoolThread #3 23:19:30 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
12716 23:19:30 INFO  Trace: BaseTypeProvider`1.GetTypes 110ms
12716 23:19:30 INFO  Trace: BaseTypeProvider`1.GetTypes 22ms
12716 23:19:30 INFO  Trace: BaseTypeProvider`1.GetTypes 20ms
12716 23:19:30 INFO  Trace: BaseTypeProvider`1.GetTypes 32ms
12716 23:19:31 INFO  Cache created: 'PathAnalyzer_ResponseCache' (max size: 10MB, running total: 1028MB)
12716 23:19:31 INFO  [Experience Analytics]: SyncSegmentsProcessor started the syncronization of segments
26076 23:19:31 INFO  [Experience Analytics]: Segment Deploy started.
12716 23:19:31 INFO  [Experience Analytics]: WebApiInitializer
12716 23:19:31 INFO  [Experience Analytics]: Filter (Sitecore.ExperienceAnalytics.Api.Http.Filters.CacheHeaderFilterAttribute) added
ManagedPoolThread #13 23:19:31 WARN  Failed to create counter 'Sitecore.Data\Data.ClientDataReads'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #4 23:19:31 WARN  Failed to create counter 'Sitecore.Data\Data.ClientDataWrites'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #8 23:19:31 WARN  Failed to create counter 'Sitecore.Data\Data.ItemsAccessed'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #7 23:19:31 WARN  Failed to create counter 'Sitecore.Data\Data.PhysicalReads'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #3 23:19:31 WARN  Failed to create counter 'Sitecore.Data\Data.PhysicalWrites'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #10 23:19:31 WARN  Failed to create counter 'Sitecore.Data\StreamSharer.OpenStreams'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #6 23:19:31 WARN  Failed to create counter 'Sitecore.Data\SqlServerStream.OpenStreams'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
12716 23:19:31 INFO  Sitecore.Social: The Social remote events are initialized.
21228 23:19:31 INFO  HttpModule is being initialized
21228 23:19:32 INFO  Cache created: 'SqlDataProvider - Prefetch data(web)' (max size: 50MB, running total: 1078MB)
21228 23:19:33 INFO  Cache created: 'clientData' (max size: 25MB, running total: 1103MB)
21228 23:19:33 INFO  Cache created: 'UserProfileCache' (max size: 5MB, running total: 1108MB)
21228 23:19:33 INFO  Cache created: 'AccessResultCache' (max size: 10MB, running total: 1118MB)
ManagedPoolThread #7 23:19:33 WARN  Failed to create counter 'Sitecore.Security\Access Denied / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #3 23:19:33 WARN  Failed to create counter 'Sitecore.Security\Access Granted / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #10 23:19:33 WARN  Failed to create counter 'Sitecore.Security\Access Resolved / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #6 23:19:33 WARN  Failed to create counter 'Sitecore.Security\Modify Requests / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #12 23:19:33 WARN  Failed to create counter 'Sitecore.Security\Programmatic Disabling / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #8 23:19:33 WARN  Failed to create counter 'Sitecore.Security\Programmatic Enabling / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #4 23:19:33 WARN  Failed to create counter 'Sitecore.Security\Programmatic User Switch / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #7 23:19:33 WARN  Failed to create counter 'Sitecore.Security\Read Requests / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #3 23:19:33 WARN  Failed to create counter 'Sitecore.Security\Virtual Users Built / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
21228 23:19:33 INFO  Cache created: 'shell[html]' (max size: 0 bytes, running total: 1118MB)
21228 23:19:33 INFO  Cache created: 'shell[registry]' (max size: 15MB, running total: 1133MB)
21228 23:19:33 INFO  Cache created: 'shell[viewstate]' (max size: 1MB, running total: 1134MB)
21228 23:19:33 INFO  Cache created: 'shell[xsl]' (max size: 25MB, running total: 1159MB)
21228 23:19:33 INFO  Cache created: 'shell[filtered items]' (max size: 10MB, running total: 1169MB)
21228 23:19:33 INFO  Cache created: 'login[html]' (max size: 0 bytes, running total: 1169MB)
21228 23:19:33 INFO  Cache created: 'login[registry]' (max size: 25MB, running total: 1194MB)
21228 23:19:33 INFO  Cache created: 'login[viewstate]' (max size: 25MB, running total: 1219MB)
21228 23:19:33 INFO  Cache created: 'login[xsl]' (max size: 50MB, running total: 1269MB)
21228 23:19:33 INFO  Cache created: 'login[filtered items]' (max size: 10MB, running total: 1279MB)
21228 23:19:33 INFO  Cache created: 'admin[html]' (max size: 0 bytes, running total: 1279MB)
21228 23:19:33 INFO  Cache created: 'admin[registry]' (max size: 25MB, running total: 1304MB)
21228 23:19:33 INFO  Cache created: 'admin[viewstate]' (max size: 25MB, running total: 1329MB)
21228 23:19:33 INFO  Cache created: 'admin[xsl]' (max size: 50MB, running total: 1379MB)
21228 23:19:33 INFO  Cache created: 'admin[filtered items]' (max size: 10MB, running total: 1389MB)
21228 23:19:33 INFO  Cache created: 'service[html]' (max size: 0 bytes, running total: 1389MB)
21228 23:19:33 INFO  Cache created: 'service[registry]' (max size: 25MB, running total: 1414MB)
21228 23:19:33 INFO  Cache created: 'service[viewstate]' (max size: 25MB, running total: 1439MB)
21228 23:19:33 INFO  Cache created: 'service[xsl]' (max size: 50MB, running total: 1489MB)
21228 23:19:33 INFO  Cache created: 'service[filtered items]' (max size: 10MB, running total: 1499MB)
21228 23:19:33 INFO  Cache created: 'modules_shell[html]' (max size: 0 bytes, running total: 1499MB)
21228 23:19:33 INFO  Cache created: 'modules_shell[registry]' (max size: 25MB, running total: 1524MB)
21228 23:19:33 INFO  Cache created: 'modules_shell[viewstate]' (max size: 25MB, running total: 1549MB)
21228 23:19:33 INFO  Cache created: 'modules_shell[xsl]' (max size: 50MB, running total: 1599MB)
21228 23:19:33 INFO  Cache created: 'modules_shell[filtered items]' (max size: 10MB, running total: 1609MB)
21228 23:19:33 INFO  Cache created: 'modules_website[html]' (max size: 25MB, running total: 1634MB)
21228 23:19:33 INFO  Cache created: 'modules_website[registry]' (max size: 25MB, running total: 1659MB)
21228 23:19:33 INFO  Cache created: 'modules_website[viewstate]' (max size: 25MB, running total: 1684MB)
21228 23:19:33 INFO  Cache created: 'modules_website[xsl]' (max size: 50MB, running total: 1734MB)
21228 23:19:33 INFO  Cache created: 'modules_website[filtered items]' (max size: 10MB, running total: 1744MB)
21228 23:19:33 INFO  Cache created: 'website[html]' (max size: 50MB, running total: 1794MB)
21228 23:19:33 INFO  Cache created: 'website[registry]' (max size: 0 bytes, running total: 1794MB)
21228 23:19:33 INFO  Cache created: 'website[viewstate]' (max size: 0 bytes, running total: 1794MB)
21228 23:19:33 INFO  Cache created: 'website[xsl]' (max size: 25MB, running total: 1819MB)
21228 23:19:33 INFO  Cache created: 'website[filtered items]' (max size: 10MB, running total: 1829MB)
21228 23:19:33 INFO  Cache created: 'website[renderingParameters]' (max size: 10MB, running total: 1839MB)
21228 23:19:33 INFO  Cache created: 'scheduler[html]' (max size: 0 bytes, running total: 1839MB)
21228 23:19:33 INFO  Cache created: 'scheduler[registry]' (max size: 25MB, running total: 1864MB)
21228 23:19:33 INFO  Cache created: 'scheduler[viewstate]' (max size: 25MB, running total: 1889MB)
21228 23:19:33 INFO  Cache created: 'scheduler[xsl]' (max size: 50MB, running total: 1939MB)
21228 23:19:33 INFO  Cache created: 'scheduler[filtered items]' (max size: 10MB, running total: 1949MB)
21228 23:19:33 INFO  Cache created: 'system[html]' (max size: 0 bytes, running total: 1949MB)
21228 23:19:33 INFO  Cache created: 'system[registry]' (max size: 25MB, running total: 1974MB)
21228 23:19:33 INFO  Cache created: 'system[viewstate]' (max size: 25MB, running total: 1999MB)
21228 23:19:33 INFO  Cache created: 'system[xsl]' (max size: 50MB, running total: 2049MB)
21228 23:19:33 INFO  Cache created: 'system[filtered items]' (max size: 10MB, running total: 2059MB)
21228 23:19:33 INFO  Cache created: 'publisher[html]' (max size: 0 bytes, running total: 2059MB)
21228 23:19:33 INFO  Cache created: 'publisher[registry]' (max size: 25MB, running total: 2084MB)
21228 23:19:33 INFO  Cache created: 'publisher[viewstate]' (max size: 25MB, running total: 2109MB)
21228 23:19:33 INFO  Cache created: 'publisher[xsl]' (max size: 50MB, running total: 2159MB)
21228 23:19:33 INFO  Cache created: 'publisher[filtered items]' (max size: 10MB, running total: 2169MB)
ManagedPoolThread #12 23:19:35 INFO  Cache created: '[IDTable]' (max size: 2MB, running total: 2172MB)
ManagedPoolThread #4 23:19:35 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

14852 23:19:35 INFO  Cache created: 'ExperienceAnalytics.Segments' (max size: 20MB, running total: 2192MB)
14852 23:19:35 INFO  Cache created: 'Task Manager - tasks' (max size: 100 bytes, running total: 2192MB)
23668 23:19:35 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:19:35 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:19:35 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:19:35 INFO  Cache created: 'ReportingStorageProviderProperties.Properties' (max size: 10MB, running total: 2202MB)
25212 23:19:35 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:19:35 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:19:35 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 23:19:36 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #10 23:19:37 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 23:19:38 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 23:19:40 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
26076 23:19:40 INFO  Cache created: 'SqlDataProvider - Prefetch data(master)' (max size: 100MB, running total: 2302MB)
24808 23:19:41 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
24808 23:19:41 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



21228 23:19:46 INFO  Cache created: 'Log singles' (max size: 100KB, running total: 2302MB)
21228 23:19:46 WARN  No session Id managers were found to manage the session Id for the current request. Default asp.net session manager will be used.
ManagedPoolThread #6 23:19:46 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

ManagedPoolThread #15 23:19:47 WARN  Failed to create counter 'Sitecore.Presentation\Context | Site Changed / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #6 23:19:47 WARN  Failed to create counter 'Sitecore.Presentation\Rendering | Controls Rendered / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #14 23:19:47 WARN  Failed to create counter 'Sitecore.Presentation\Rendering | Controls Rendered From Cache / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #7 23:19:47 WARN  Failed to create counter 'Sitecore.Presentation\Rendering | Pages Generated / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #15 23:19:47 WARN  Failed to create counter 'Sitecore.Presentation\Rendering | Renderings Rendered / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #6 23:19:47 WARN  Failed to create counter 'Sitecore.Presentation\Rendering | Sublayouts Rendered / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #14 23:19:47 WARN  Failed to create counter 'Sitecore.Presentation\Rendering | XmlControls Compiled / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #7 23:19:47 WARN  Failed to create counter 'Sitecore.Presentation\Rendering | Xsl Transforms Rendered / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #15 23:19:47 WARN  Failed to create counter 'Sitecore.Presentation\Rendering | Xaml Controls Compiled / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
26076 23:19:48 INFO  Cache created: 'ItemCloningRelations' (max size: 50MB, running total: 2352MB)
ManagedPoolThread #9 23:19:48 INFO  Cache created: 'SqlDataProvider - Prefetch data(core)' (max size: 50MB, running total: 2402MB)
ManagedPoolThread #9 23:19:48 INFO  Loading Dictionary from cache
ManagedPoolThread #9 23:19:48 WARN  No subscription for Device Detection service. Could not check for updates.
ManagedPoolThread #9 23:19:48 INFO  Job ended: Update device detection DB (units processed: )
26076 23:19:48 INFO  Cache created: 'IsUserInRoleCache' (max size: 5MB, running total: 2407MB)
26076 23:19:48 INFO  Trying to load XML configuration /App_Config/Security/GlobalRoles.config
26076 23:19:48 INFO  Cache created: 'scripts' (max size: 800KB, running total: 2408MB)
26076 23:19:49 INFO  Cache created: 'ReportDataCache' (max size: 50MB, running total: 2458MB)
26076 23:19:49 INFO  [Experience Analytics]: Segment Deploy complete.
23668 23:19:50 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:19:50 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:19:50 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25212 23:19:50 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:19:50 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:19:50 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 23:19:52 INFO  Trying to load XML configuration /App_Config/Security/GlobalRoles.config
24808 23:19:56 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 23:19:56 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

23668 23:20:05 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:20:05 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:20:05 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25212 23:20:05 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:20:05 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:20:05 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 23:20:06 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

24808 23:20:11 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #18 23:20:16 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

23668 23:20:20 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:20:20 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:20:20 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25212 23:20:20 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:20:20 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:20:20 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #18 23:20:22 INFO  Cache created: 'LocationsDictionaryCache' (max size: 976KB, running total: 2459MB)
ManagedPoolThread #18 23:20:22 INFO  Cache created: 'ReferringSitesDictionaryCache' (max size: 976KB, running total: 2459MB)
ManagedPoolThread #18 23:20:22 INFO  Cache created: 'GeoIpDataDictionaryCache' (max size: 976KB, running total: 2460MB)
ManagedPoolThread #18 23:20:22 INFO  Cache created: 'UserAgentDictionaryCache' (max size: 976KB, running total: 2461MB)
ManagedPoolThread #18 23:20:22 INFO  Cache created: 'DeviceDictionaryCache' (max size: 976KB, running total: 2462MB)
ManagedPoolThread #16 23:20:22 WARN  Failed to create counter 'Sitecore.Analytics.MongoDb\Reads / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #17 23:20:22 WARN  Failed to create counter 'Sitecore.Analytics.MongoDb\Writes / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #9 23:20:22 WARN  Failed to create counter 'Sitecore.Analytics.MongoDb\Documents fetched / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #19 23:20:22 WARN  Failed to create counter 'Sitecore.Analytics.MongoDb\Data | Aggregation - Add (Visits scheduled for aggregation) / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #16 23:20:22 WARN  Failed to create counter 'Sitecore.Analytics.MongoDb\Data | Aggregation - Check out calls / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #17 23:20:22 WARN  Failed to create counter 'Sitecore.Analytics.MongoDb\Data | Aggregation - Check out (Visits checked out) / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #9 23:20:22 WARN  Failed to create counter 'Sitecore.Analytics.MongoDb\Data | Aggregation - Check in (Visits checked in) / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #19 23:20:22 WARN  Failed to create counter 'Sitecore.Analytics.MongoDb\Data | Aggregation - Pool Recovery calls / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #18 23:20:22 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

24808 23:20:26 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 23:20:26 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

ManagedPoolThread #0 23:20:31 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #11 23:20:32 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #2 23:20:33 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 23:20:34 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 23:20:35 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
23668 23:20:35 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:20:35 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:20:35 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:20:35 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25212 23:20:35 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:20:35 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 23:20:36 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

ManagedPoolThread #6 23:20:36 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #14 23:20:37 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 23:20:38 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #15 23:20:39 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 23:20:40 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 23:20:41 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 23:20:42 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
24808 23:20:43 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
24808 23:20:43 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



ManagedPoolThread #18 23:20:46 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

23668 23:20:50 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:20:50 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:20:50 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:20:50 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25212 23:20:50 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:20:50 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 23:20:56 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

24808 23:20:58 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

23668 23:21:05 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:21:05 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:21:05 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:21:05 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25212 23:21:05 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:21:05 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 23:21:06 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

24808 23:21:13 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 23:21:16 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

23668 23:21:20 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:21:20 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:21:20 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:21:20 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25212 23:21:20 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:21:20 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 23:21:26 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

24808 23:21:28 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

23668 23:21:35 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:21:35 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:21:35 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:21:35 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25212 23:21:35 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:21:35 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 23:21:36 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

ManagedPoolThread #7 23:21:42 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 23:21:43 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #14 23:21:44 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #15 23:21:45 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #17 23:21:46 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

ManagedPoolThread #1 23:21:46 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #2 23:21:47 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 23:21:48 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #11 23:21:49 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 23:21:50 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
23668 23:21:50 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:21:50 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:21:50 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:21:50 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25212 23:21:50 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:21:50 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #12 23:21:51 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 23:21:52 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 23:21:53 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #16 23:21:54 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
24808 23:21:55 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
24808 23:21:55 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



ManagedPoolThread #9 23:21:56 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

ManagedPoolThread #10 23:21:56 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #4 23:21:57 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
23668 23:22:05 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:22:05 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:22:05 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:22:05 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25212 23:22:05 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:22:05 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #18 23:22:06 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

24808 23:22:10 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 23:22:16 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

23668 23:22:20 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:22:20 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:22:20 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:22:20 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25212 23:22:20 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:22:20 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 23:22:22 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

24808 23:22:25 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #18 23:22:26 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

23668 23:22:35 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:22:35 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:22:35 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:22:35 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25212 23:22:35 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:22:36 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 23:22:36 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

24808 23:22:40 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 23:22:46 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

23668 23:22:50 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:22:50 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:22:50 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:22:50 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25212 23:22:50 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:22:51 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #11 23:22:52 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 23:22:53 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 23:22:54 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
24808 23:22:55 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #14 23:22:55 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #19 23:22:56 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

ManagedPoolThread #15 23:22:56 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #2 23:22:57 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 23:22:58 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 23:22:59 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 23:23:00 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 23:23:01 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 23:23:02 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #16 23:23:03 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #4 23:23:04 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 23:23:05 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
23668 23:23:05 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:23:05 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:23:05 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:23:05 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25212 23:23:05 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:23:06 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 23:23:06 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

24808 23:23:10 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 23:23:16 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

23668 23:23:20 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:23:20 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:23:20 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:23:20 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25212 23:23:20 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:23:21 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24808 23:23:25 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #18 23:23:26 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

23668 23:23:35 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:23:35 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:23:35 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:23:35 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25212 23:23:35 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:23:36 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #18 23:23:36 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

24808 23:23:40 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #18 23:23:46 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

23668 23:23:50 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:23:50 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:23:50 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:23:50 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25212 23:23:50 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:23:51 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24808 23:23:55 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 23:23:56 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

ManagedPoolThread #0 23:24:02 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #11 23:24:03 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #14 23:24:04 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
23668 23:24:05 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:24:05 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:24:05 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:24:05 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25212 23:24:05 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #15 23:24:05 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
24072 23:24:06 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 23:24:06 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

ManagedPoolThread #2 23:24:06 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 23:24:07 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 23:24:08 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 23:24:10 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 23:24:11 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 23:24:12 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 23:24:13 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #4 23:24:14 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 23:24:15 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #10 23:24:16 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #19 23:24:16 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

24808 23:24:17 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
24808 23:24:17 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



ManagedPoolThread #16 23:24:18 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
23668 23:24:20 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:24:20 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:24:20 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:24:20 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25212 23:24:20 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:24:21 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 23:24:22 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

26064 23:24:23 INFO  [Path Analyzer](.) Running trail cleanup agent
26064 23:24:23 INFO  [Path Analyzer](.) Running trail cleanup on database
26064 23:24:23 WARN  [Path Analyzer](.) SqlStorage ConnectionString 'reporting.secondary' cannot be found
ManagedPoolThread #17 23:24:26 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

24808 23:24:32 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

23668 23:24:35 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:24:35 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:24:35 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:24:35 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25212 23:24:35 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:24:36 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 23:24:36 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

ManagedPoolThread #19 23:24:46 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

24808 23:24:47 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

23668 23:24:50 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:24:50 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:24:50 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:24:50 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25212 23:24:50 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:24:51 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 23:24:56 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

24808 23:25:02 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

23668 23:25:05 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:25:05 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:25:05 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:25:05 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25212 23:25:05 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:25:06 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 23:25:06 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

ManagedPoolThread #2 23:25:13 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 23:25:15 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #14 23:25:16 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #18 23:25:16 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

ManagedPoolThread #11 23:25:17 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 23:25:18 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #15 23:25:19 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
23668 23:25:20 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:25:20 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:25:20 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:25:20 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25212 23:25:20 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 23:25:20 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
24072 23:25:21 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #5 23:25:21 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #18 23:25:22 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

ManagedPoolThread #6 23:25:23 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 23:25:24 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 23:25:25 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
24808 23:25:26 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
24808 23:25:26 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



ManagedPoolThread #18 23:25:26 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

ManagedPoolThread #16 23:25:27 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #4 23:25:29 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 23:25:30 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
23668 23:25:35 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:25:35 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:25:35 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:25:35 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25212 23:25:35 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:25:36 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 23:25:36 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

24808 23:25:41 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 23:25:46 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

20692 23:25:50 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

23668 23:25:50 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:25:50 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:25:50 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25212 23:25:50 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:25:51 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24808 23:25:56 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 23:25:56 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

20692 23:26:05 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

23668 23:26:05 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:26:05 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:26:05 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25212 23:26:05 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:26:06 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #18 23:26:06 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

24808 23:26:11 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 23:26:16 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

20692 23:26:20 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

23668 23:26:20 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:26:20 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:26:20 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25212 23:26:20 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:26:21 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #1 23:26:25 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 23:26:26 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
24808 23:26:26 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 23:26:26 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

ManagedPoolThread #11 23:26:27 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 23:26:28 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #14 23:26:29 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 23:26:30 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 23:26:31 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #2 23:26:32 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #15 23:26:33 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 23:26:34 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 23:26:35 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
20692 23:26:35 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

23668 23:26:35 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:26:35 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:26:35 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25212 23:26:35 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:26:36 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 23:26:36 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #18 23:26:36 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

ManagedPoolThread #8 23:26:37 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
24808 23:26:41 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 23:26:47 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

20692 23:26:50 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

23668 23:26:50 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:26:50 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:26:50 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25212 23:26:50 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:26:51 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24808 23:26:57 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 23:26:57 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

20692 23:27:05 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

23668 23:27:05 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:27:05 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:27:05 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25212 23:27:05 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:27:06 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #18 23:27:07 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

24808 23:27:12 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 23:27:17 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

20692 23:27:20 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

23668 23:27:20 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:27:20 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:27:20 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25212 23:27:20 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:27:21 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24808 23:27:27 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 23:27:27 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

ManagedPoolThread #5 23:27:36 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
24072 23:27:36 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #1 23:27:37 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #18 23:27:37 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

ManagedPoolThread #14 23:27:38 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #2 23:27:39 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #15 23:27:40 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #11 23:27:41 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 23:27:42 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 23:27:43 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 23:27:44 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 23:27:45 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 23:27:46 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
14852 23:27:47 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #9 23:27:47 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

ManagedPoolThread #3 23:27:48 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
24920 23:27:49 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
26276 23:27:50 ERROR Exception when executing agent aggregation/automationAggregator
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Buffer`1..ctor(IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


24072 23:27:51 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25212 23:27:51 ERROR Exception when executing agent aggregation/automationAggregator
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Buffer`1..ctor(IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


23668 23:27:52 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Enumerable.FirstOrDefault[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


20692 23:27:53 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Enumerable.FirstOrDefault[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


1044 23:27:54 ERROR Exception when executing agent aggregation/automationAggregator
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Buffer`1..ctor(IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


ManagedPoolThread #4 23:27:55 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #10 23:27:56 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 23:27:57 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #16 23:27:58 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #18 23:27:59 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

24808 23:27:59 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
24808 23:27:59 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



26276 23:28:05 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:28:06 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25212 23:28:06 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

23668 23:28:07 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:28:08 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:28:09 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 23:28:09 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

24808 23:28:14 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 23:28:19 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

26276 23:28:20 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:28:21 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25212 23:28:21 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

23668 23:28:22 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:28:23 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 23:28:23 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

1044 23:28:24 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24808 23:28:29 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #18 23:28:29 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

26276 23:28:35 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:28:36 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25212 23:28:36 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

23668 23:28:37 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:28:38 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:28:39 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 23:28:39 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

24808 23:28:44 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 23:28:47 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
24920 23:28:50 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
26276 23:28:50 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:28:51 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25212 23:28:51 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #2 23:28:51 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
23668 23:28:52 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #5 23:28:52 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #11 23:28:53 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
20692 23:28:53 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 23:28:54 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
1044 23:28:54 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #6 23:28:55 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 23:28:56 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #15 23:28:57 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 23:28:58 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #17 23:28:59 ERROR Cannot process Automation states.
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Enumerable.WhereSelectEnumerableIterator`2.MoveNext()
   at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)
   at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


ManagedPoolThread #9 23:28:59 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

ManagedPoolThread #1 23:29:00 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #14 23:29:01 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #16 23:29:02 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
24808 23:29:03 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
24808 23:29:03 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



26276 23:29:05 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:29:06 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25212 23:29:06 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

23668 23:29:07 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:29:08 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:29:09 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 23:29:09 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

24808 23:29:18 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 23:29:19 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

26276 23:29:20 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:29:21 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25212 23:29:21 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 23:29:21 INFO  Health.PrivateBytes: 914,198,528
ManagedPoolThread #19 23:29:21 INFO  Health.CacheInstances: 125
ManagedPoolThread #19 23:29:21 INFO  Health.CacheTotalCount: 12,693
ManagedPoolThread #19 23:29:21 INFO  Health.CacheTotalSize: 25,575,099
ManagedPoolThread #19 23:29:21 WARN  Could not register counter in HealthMonitor. Category: Process, Name: Private Bytes, Instance: , InstanceType: Windows
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #19 23:29:21 WARN  Could not register counter in HealthMonitor. Category: Process, Name: Virtual Bytes, Instance: , InstanceType: Windows
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #19 23:29:21 WARN  Could not register counter in HealthMonitor. Category: Process, Name: Page File Bytes, Instance: , InstanceType: Windows
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #19 23:29:21 WARN  Could not register counter in HealthMonitor. Category: .NET CLR Memory, Name: # Bytes in all Heaps, Instance: , InstanceType: CLR
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #19 23:29:21 WARN  Could not register counter in HealthMonitor. Category: .NET CLR Memory, Name: % Time in GC, Instance: , InstanceType: CLR
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #19 23:29:21 WARN  Could not register counter in HealthMonitor. Category: .NET CLR Memory, Name: Large Object Heap size, Instance: , InstanceType: CLR
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #19 23:29:21 WARN  Could not register counter in HealthMonitor. Category: .NET CLR Loading, Name: Bytes in Loader Heap, Instance: , InstanceType: CLR
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #19 23:29:21 WARN  Could not register counter in HealthMonitor. Category: .NET CLR Loading, Name: Current Assemblies, Instance: , InstanceType: CLR
		Message: Access to the registry key 'Global' is denied.
23668 23:29:22 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26064 23:29:23 INFO  [Path Analyzer](.) Running trail cleanup agent
26064 23:29:23 INFO  [Path Analyzer](.) Running trail cleanup on database
20692 23:29:23 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:29:24 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #18 23:29:25 INFO  Job started: Update device detection DB
ManagedPoolThread #18 23:29:25 WARN  No subscription for Device Detection service. Could not check for updates.
ManagedPoolThread #18 23:29:25 INFO  Job ended: Update device detection DB (units processed: )
ManagedPoolThread #19 23:29:26 INFO  Job started: Sitecore.Tasks.TaskDatabaseAgent
ManagedPoolThread #19 23:29:26 INFO  Processing tasks (count: 0)
ManagedPoolThread #19 23:29:26 INFO  Job ended: Sitecore.Tasks.TaskDatabaseAgent (units processed: )
ManagedPoolThread #17 23:29:26 INFO  Job started: Core_Database_Agent
ManagedPoolThread #17 23:29:26 INFO  Scheduling.DatabaseAgent started. Database: core
ManagedPoolThread #17 23:29:26 INFO  Examining schedules (count: 0)
ManagedPoolThread #17 23:29:26 INFO  Job ended: Core_Database_Agent (units processed: )
ManagedPoolThread #18 23:29:26 INFO  Job started: Master_Database_Agent
ManagedPoolThread #18 23:29:26 INFO  Scheduling.DatabaseAgent started. Database: master
ManagedPoolThread #18 23:29:26 INFO  Examining schedules (count: 5)
ManagedPoolThread #18 23:29:26 INFO  Starting: __Task Schedule
ManagedPoolThread #18 23:29:26 INFO  Ended: __Task Schedule
ManagedPoolThread #18 23:29:26 INFO  Not due: Calculate Statistical Relevancy
ManagedPoolThread #18 23:29:26 INFO  Not due: Rebuild Suggested Tests Index
ManagedPoolThread #18 23:29:26 INFO  Not due: Suspend Corrupted Tests
ManagedPoolThread #18 23:29:26 INFO  Not due: Try Finish Test
ManagedPoolThread #18 23:29:26 INFO  Job ended: Master_Database_Agent (units processed: 5)
ManagedPoolThread #9 23:29:29 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

24808 23:29:33 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:29:35 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:29:36 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25212 23:29:36 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

23668 23:29:37 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:29:38 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:29:39 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #18 23:29:39 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

ManagedPoolThread #13 23:29:48 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
24808 23:29:48 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #18 23:29:49 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

26276 23:29:50 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:29:51 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25212 23:29:51 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

23668 23:29:52 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:29:53 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:29:54 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #18 23:30:00 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

ManagedPoolThread #14 23:30:03 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 23:30:04 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #2 23:30:05 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
26276 23:30:05 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:30:06 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #5 23:30:06 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
25212 23:30:06 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #11 23:30:07 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
23668 23:30:07 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #6 23:30:08 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
20692 23:30:08 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #1 23:30:09 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
1044 23:30:09 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 23:30:10 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

ManagedPoolThread #15 23:30:10 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 23:30:11 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 23:30:12 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #16 23:30:13 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
14852 23:30:14 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
24808 23:30:15 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
24808 23:30:15 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



ManagedPoolThread #4 23:30:16 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #10 23:30:17 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 23:30:18 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #19 23:30:20 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

26276 23:30:20 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:30:21 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25212 23:30:21 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

23668 23:30:22 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:30:23 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 23:30:24 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

1044 23:30:24 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24808 23:30:30 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 23:30:30 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

26276 23:30:35 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:30:36 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25212 23:30:36 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

23668 23:30:37 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:30:38 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:30:39 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #18 23:30:40 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

24808 23:30:45 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 23:30:49 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #9 23:30:50 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

26276 23:30:50 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:30:51 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25212 23:30:51 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

23668 23:30:52 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:30:53 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:30:54 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24808 23:31:00 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 23:31:00 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

26276 23:31:05 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:31:06 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25212 23:31:06 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

23668 23:31:07 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:31:08 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:31:09 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 23:31:10 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

24808 23:31:15 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

14852 23:31:15 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #2 23:31:16 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 23:31:17 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 23:31:18 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 23:31:19 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #14 23:31:20 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #9 23:31:20 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

26276 23:31:20 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:31:21 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25212 23:31:21 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #11 23:31:21 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
23668 23:31:22 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #15 23:31:22 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 23:31:23 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
20692 23:31:23 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:31:24 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 23:31:24 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #17 23:31:24 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

ManagedPoolThread #12 23:31:25 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #10 23:31:26 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 23:31:27 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #16 23:31:28 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
24808 23:31:30 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 23:31:30 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

26276 23:31:35 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:31:36 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25212 23:31:36 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

23668 23:31:37 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:31:38 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:31:39 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #18 23:31:40 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

24808 23:31:45 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 23:31:50 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #17 23:31:50 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

26276 23:31:50 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:31:51 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25212 23:31:51 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

23668 23:31:52 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:31:53 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:31:54 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24808 23:32:00 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #18 23:32:00 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

26276 23:32:05 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:32:06 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25212 23:32:06 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

23668 23:32:07 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:32:08 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:32:09 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 23:32:10 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

24808 23:32:15 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:32:20 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 23:32:20 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

24072 23:32:21 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25212 23:32:21 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

23668 23:32:22 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:32:23 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:32:24 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #14 23:32:26 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 23:32:27 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 23:32:28 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #11 23:32:29 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 23:32:30 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #19 23:32:30 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

ManagedPoolThread #7 23:32:31 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #15 23:32:32 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #2 23:32:33 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 23:32:34 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 23:32:35 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
26276 23:32:35 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:32:36 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25212 23:32:36 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #10 23:32:36 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
23668 23:32:37 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 23:32:37 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
20692 23:32:38 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #16 23:32:38 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
1044 23:32:39 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24808 23:32:39 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
24808 23:32:39 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



ManagedPoolThread #19 23:32:40 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

ManagedPoolThread #8 23:32:40 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
26276 23:32:50 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 23:32:50 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

24072 23:32:51 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25212 23:32:51 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 23:32:51 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
23668 23:32:52 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:32:53 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:32:54 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24808 23:32:54 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 23:33:00 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

26276 23:33:05 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:33:06 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25212 23:33:06 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

23668 23:33:07 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:33:08 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:33:09 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24808 23:33:09 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #18 23:33:10 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

26276 23:33:20 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #18 23:33:21 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

24072 23:33:21 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25212 23:33:21 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

23668 23:33:22 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:33:23 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:33:24 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24808 23:33:24 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 23:33:25 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

ManagedPoolThread #19 23:33:31 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

24920 23:33:36 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
23668 23:33:37 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:33:37 ERROR Exception when executing agent aggregation/automationAggregator
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Buffer`1..ctor(IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


24072 23:33:38 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Enumerable.FirstOrDefault[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


20692 23:33:39 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:33:39 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #15 23:33:40 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 23:33:41 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #19 23:33:41 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

ManagedPoolThread #6 23:33:42 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 23:33:43 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #14 23:33:44 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #2 23:33:45 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 23:33:46 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #11 23:33:47 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 23:33:48 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
25212 23:33:49 ERROR Exception when executing agent aggregation/automationAggregator
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Buffer`1..ctor(IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


ManagedPoolThread #12 23:33:50 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
24808 23:33:51 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
24808 23:33:51 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



ManagedPoolThread #19 23:33:51 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

ManagedPoolThread #8 23:33:52 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
23668 23:33:52 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:33:52 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #10 23:33:53 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
24072 23:33:53 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 23:33:54 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
20692 23:33:54 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:33:54 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #16 23:33:55 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 23:33:56 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #9 23:34:01 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

25212 23:34:04 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24808 23:34:06 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

23668 23:34:07 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:34:07 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:34:08 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:34:09 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:34:09 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 23:34:11 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

25212 23:34:19 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24808 23:34:21 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 23:34:21 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

23668 23:34:22 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:34:22 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26064 23:34:23 INFO  [Path Analyzer](.) Running trail cleanup agent
26064 23:34:23 INFO  [Path Analyzer](.) Running trail cleanup on database
14232 23:34:23 WARN  [Path Analyzer](.) SmartMergeAgent.Execute() returns. No missing date ranges to merge.
20692 23:34:24 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:34:24 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:34:24 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 23:34:27 INFO  Job started: Sitecore.Tasks.UrlAgent
ManagedPoolThread #17 23:34:27 INFO  Scheduling.UrlAgent started. Url: http://localhost:91/sitecore/service/keepalive.aspx
ManagedPoolThread #17 23:34:27 INFO  Scheduling.UrlAgent done (received: 589 bytes)
ManagedPoolThread #17 23:34:27 INFO  Job ended: Sitecore.Tasks.UrlAgent (units processed: )
ManagedPoolThread #18 23:34:31 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

25212 23:34:34 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24808 23:34:36 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

23668 23:34:37 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:34:37 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:34:39 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:34:39 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:34:39 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #18 23:34:41 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

25212 23:34:49 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24808 23:34:51 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #5 23:34:51 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
23668 23:34:52 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #6 23:34:52 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
26276 23:34:52 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #15 23:34:53 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
20692 23:34:54 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:34:54 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:34:54 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #2 23:34:54 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 23:34:55 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #14 23:34:56 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 23:34:57 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 23:34:58 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #11 23:34:59 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 23:35:00 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #17 23:35:01 ERROR Cannot process Automation states.
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Enumerable.WhereSelectEnumerableIterator`2.MoveNext()
   at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)
   at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


ManagedPoolThread #4 23:35:02 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #16 23:35:03 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
25212 23:35:04 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 23:35:04 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 23:35:05 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
24808 23:35:06 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

23668 23:35:07 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:35:07 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:35:09 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:35:09 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:35:09 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 23:35:11 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

25212 23:35:19 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24808 23:35:21 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #18 23:35:21 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

23668 23:35:22 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:35:22 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:35:24 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:35:24 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:35:24 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #18 23:35:25 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

ManagedPoolThread #19 23:35:31 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

25212 23:35:34 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24808 23:35:36 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

23668 23:35:37 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:35:37 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:35:39 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:35:39 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:35:39 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 23:35:41 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

25212 23:35:49 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24808 23:35:51 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 23:35:51 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

23668 23:35:52 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:35:52 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:35:54 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:35:54 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:35:54 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

14852 23:36:01 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 23:36:02 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #2 23:36:03 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
25212 23:36:04 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #1 23:36:04 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 23:36:05 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #14 23:36:06 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
23668 23:36:07 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #11 23:36:07 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
26276 23:36:07 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #15 23:36:08 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
20692 23:36:09 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:36:09 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:36:09 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #6 23:36:09 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 23:36:10 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 23:36:11 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #9 23:36:12 ERROR Cannot process Automation states.
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Enumerable.WhereSelectEnumerableIterator`2.MoveNext()
   at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)
   at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


ManagedPoolThread #4 23:36:13 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #10 23:36:14 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 23:36:15 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 23:36:16 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
24808 23:36:17 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
24808 23:36:17 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



ManagedPoolThread #16 23:36:18 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
25212 23:36:19 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 23:36:21 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

23668 23:36:22 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:36:22 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:36:24 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:36:24 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:36:24 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 23:36:25 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

ManagedPoolThread #18 23:36:31 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

24808 23:36:32 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25212 23:36:34 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

23668 23:36:37 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:36:37 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:36:39 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:36:39 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:36:39 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 23:36:41 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

24808 23:36:47 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25212 23:36:49 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 23:36:51 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

23668 23:36:52 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:36:52 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:36:54 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:36:54 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:36:54 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 23:37:01 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

24808 23:37:02 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25212 23:37:04 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

23668 23:37:07 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:37:07 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:37:09 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:37:09 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:37:09 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 23:37:12 ERROR Cannot process Automation states.
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Enumerable.WhereSelectEnumerableIterator`2.MoveNext()
   at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)
   at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


ManagedPoolThread #15 23:37:13 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #14 23:37:15 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 23:37:16 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 23:37:17 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 23:37:18 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #11 23:37:19 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
25212 23:37:19 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #6 23:37:20 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #2 23:37:21 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 23:37:22 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #19 23:37:22 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

23668 23:37:22 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:37:22 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #12 23:37:23 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 23:37:24 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
20692 23:37:24 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:37:24 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:37:24 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24808 23:37:25 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
24808 23:37:25 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



ManagedPoolThread #16 23:37:26 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #4 23:37:27 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #10 23:37:28 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #18 23:37:32 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

25212 23:37:34 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

23668 23:37:37 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:37:37 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:37:39 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:37:39 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:37:39 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24808 23:37:40 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 23:37:42 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

25212 23:37:49 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #18 23:37:52 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

23668 23:37:52 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:37:52 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:37:54 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:37:54 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:37:54 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24808 23:37:55 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 23:38:02 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

25212 23:38:04 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

23668 23:38:07 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:38:08 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:38:09 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:38:09 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:38:09 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24808 23:38:10 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 23:38:12 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

25212 23:38:19 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 23:38:22 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

23668 23:38:22 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:38:23 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #11 23:38:24 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
20692 23:38:24 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:38:24 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:38:24 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24808 23:38:25 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #14 23:38:25 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 23:38:26 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 23:38:27 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 23:38:28 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 23:38:29 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #15 23:38:30 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 23:38:31 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #17 23:38:32 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

ManagedPoolThread #2 23:38:32 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 23:38:33 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
25212 23:38:34 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 23:38:34 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #16 23:38:35 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 23:38:36 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #10 23:38:37 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
23668 23:38:37 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:38:38 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 23:38:38 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
20692 23:38:39 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:38:39 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:38:39 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24808 23:38:40 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #18 23:38:42 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

25212 23:38:49 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #18 23:38:52 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

23668 23:38:52 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:38:53 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:38:54 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:38:54 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:38:54 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24808 23:38:55 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 23:39:02 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

25212 23:39:04 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

23668 23:39:07 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:39:08 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:39:09 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:39:09 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:39:09 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24808 23:39:10 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #18 23:39:12 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

25212 23:39:19 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 23:39:22 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

ManagedPoolThread #19 23:39:22 INFO  Health.PrivateBytes: 996,519,936
ManagedPoolThread #19 23:39:22 INFO  Health.CacheInstances: 125
ManagedPoolThread #19 23:39:22 INFO  Health.CacheTotalCount: 12,729
ManagedPoolThread #19 23:39:22 INFO  Health.CacheTotalSize: 25,638,965
23668 23:39:22 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:39:23 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26064 23:39:23 INFO  [Path Analyzer](.) Running trail cleanup agent
26064 23:39:23 INFO  [Path Analyzer](.) Running trail cleanup on database
20692 23:39:24 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:39:24 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:39:24 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24808 23:39:25 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 23:39:26 INFO  Job started: Update device detection DB
ManagedPoolThread #19 23:39:26 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

ManagedPoolThread #17 23:39:26 WARN  Authentication on CES Discovery service failed.
Exception: System.Net.WebException
Message: The remote server returned an error: (403) Forbidden.
Source: System
   at System.Net.HttpWebRequest.GetResponse()
   at Sitecore.CES.Client.WebClient.ExecuteRequest(String requestUri)
   at Sitecore.CES.Client.ResourceConnector`1.Request(String endpoint, Object[] parameters)
   at Sitecore.CES.Discovery.EndpointSource.GetEndpoint(String serviceName)

ManagedPoolThread #17 23:39:26 WARN  No subscription for Device Detection service. Could not check for updates.
ManagedPoolThread #17 23:39:26 INFO  Job ended: Update device detection DB (units processed: )
ManagedPoolThread #9 23:39:28 INFO  Job started: Sitecore.Tasks.TaskDatabaseAgent
ManagedPoolThread #9 23:39:28 INFO  Processing tasks (count: 0)
ManagedPoolThread #9 23:39:28 INFO  Job ended: Sitecore.Tasks.TaskDatabaseAgent (units processed: )
ManagedPoolThread #18 23:39:28 INFO  Job started: Core_Database_Agent
ManagedPoolThread #18 23:39:28 INFO  Scheduling.DatabaseAgent started. Database: core
ManagedPoolThread #18 23:39:28 INFO  Examining schedules (count: 0)
ManagedPoolThread #18 23:39:28 INFO  Job ended: Core_Database_Agent (units processed: )
ManagedPoolThread #19 23:39:28 INFO  Job started: Master_Database_Agent
ManagedPoolThread #19 23:39:28 INFO  Scheduling.DatabaseAgent started. Database: master
ManagedPoolThread #19 23:39:28 INFO  Examining schedules (count: 5)
ManagedPoolThread #19 23:39:28 INFO  Starting: __Task Schedule
ManagedPoolThread #19 23:39:28 INFO  Ended: __Task Schedule
ManagedPoolThread #19 23:39:28 INFO  Not due: Calculate Statistical Relevancy
ManagedPoolThread #19 23:39:28 INFO  Not due: Rebuild Suggested Tests Index
ManagedPoolThread #19 23:39:28 INFO  Not due: Suspend Corrupted Tests
ManagedPoolThread #19 23:39:28 INFO  Not due: Try Finish Test
ManagedPoolThread #19 23:39:28 INFO  Job ended: Master_Database_Agent (units processed: 5)
ManagedPoolThread #19 23:39:32 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

ManagedPoolThread #6 23:39:34 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 23:39:35 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 23:39:36 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #14 23:39:37 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
23668 23:39:37 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:39:38 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #2 23:39:38 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 23:39:39 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
20692 23:39:39 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:39:39 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:39:39 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #11 23:39:40 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #15 23:39:41 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #18 23:39:42 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

ManagedPoolThread #5 23:39:42 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 23:39:43 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 23:39:44 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
25212 23:39:45 ERROR Exception when executing agent aggregation/automationAggregator
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Buffer`1..ctor(IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


ManagedPoolThread #8 23:39:46 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #4 23:39:47 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
24808 23:39:48 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
24808 23:39:48 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



ManagedPoolThread #16 23:39:49 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #10 23:39:50 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #9 23:39:52 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

23668 23:39:52 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:39:53 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:39:54 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:39:54 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:39:54 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25212 23:40:00 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 23:40:02 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

24808 23:40:03 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

23668 23:40:07 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:40:08 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:40:09 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:40:09 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:40:09 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #18 23:40:12 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

25212 23:40:15 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24808 23:40:18 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 23:40:22 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

23668 23:40:22 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:40:23 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:40:25 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:40:25 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:40:25 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25212 23:40:30 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 23:40:32 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

24808 23:40:33 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

23668 23:40:37 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:40:38 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:40:40 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:40:40 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:40:40 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #18 23:40:42 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

ManagedPoolThread #14 23:40:44 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
25212 23:40:45 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #6 23:40:45 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 23:40:46 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 23:40:47 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #2 23:40:48 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
24808 23:40:48 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 23:40:49 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #11 23:40:50 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #15 23:40:51 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #18 23:40:52 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

ManagedPoolThread #5 23:40:52 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
23668 23:40:52 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:40:53 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #12 23:40:53 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 23:40:54 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
20692 23:40:55 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:40:55 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:40:55 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #16 23:40:55 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #10 23:40:56 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
25212 23:41:00 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 23:41:02 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

24808 23:41:03 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

23668 23:41:07 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:41:08 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:41:10 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:41:10 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:41:10 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 23:41:12 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

25212 23:41:15 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24808 23:41:18 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 23:41:22 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

23668 23:41:22 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:41:23 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:41:25 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:41:25 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:41:25 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 23:41:26 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

25212 23:41:30 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 23:41:32 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

24808 23:41:33 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

23668 23:41:37 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:41:38 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:41:40 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:41:40 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:41:40 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 23:41:42 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

25212 23:41:45 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24808 23:41:48 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 23:41:52 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

23668 23:41:52 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:41:53 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #2 23:41:54 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
20692 23:41:55 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:41:55 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:41:55 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #11 23:41:55 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 23:41:56 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 23:41:57 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #15 23:41:58 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 23:41:59 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
25212 23:42:00 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #14 23:42:00 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 23:42:01 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #17 23:42:02 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

ManagedPoolThread #6 23:42:02 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 23:42:03 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 23:42:04 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #16 23:42:05 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 23:42:06 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
23668 23:42:07 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #10 23:42:07 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
26276 23:42:08 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 23:42:08 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
24808 23:42:09 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
24808 23:42:09 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



20692 23:42:10 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:42:10 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:42:10 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 23:42:12 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

25212 23:42:15 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 23:42:22 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

23668 23:42:22 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:42:23 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24808 23:42:24 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:42:25 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:42:25 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:42:25 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 23:42:26 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

25212 23:42:30 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #18 23:42:32 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

23668 23:42:37 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:42:38 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24808 23:42:39 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:42:40 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:42:40 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:42:40 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 23:42:42 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

25212 23:42:45 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 23:42:52 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

23668 23:42:52 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:42:53 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24808 23:42:54 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:42:55 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:42:55 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:42:55 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25212 23:43:00 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 23:43:02 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

ManagedPoolThread #2 23:43:04 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #11 23:43:05 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 23:43:06 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
23668 23:43:07 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #5 23:43:07 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
26276 23:43:08 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #15 23:43:08 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 23:43:09 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
20692 23:43:10 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:43:10 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:43:10 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #14 23:43:10 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 23:43:11 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #9 23:43:12 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

ManagedPoolThread #6 23:43:12 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 23:43:13 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 23:43:14 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
25212 23:43:15 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 23:43:15 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
24808 23:43:16 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
24808 23:43:16 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



ManagedPoolThread #16 23:43:17 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
23668 23:43:22 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 23:43:22 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

26276 23:43:23 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:43:25 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:43:25 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:43:25 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25212 23:43:30 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24808 23:43:31 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 23:43:32 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

23668 23:43:37 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:43:38 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:43:40 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:43:40 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:43:40 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 23:43:42 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

25212 23:43:45 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24808 23:43:46 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

23668 23:43:52 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 23:43:52 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

26276 23:43:53 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:43:55 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:43:55 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:43:55 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25212 23:44:00 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24808 23:44:01 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 23:44:02 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

23668 23:44:07 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:44:08 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:44:10 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:44:10 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:44:10 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #18 23:44:12 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

ManagedPoolThread #14 23:44:14 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
25212 23:44:15 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 23:44:15 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #15 23:44:16 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #11 23:44:17 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 23:44:18 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 23:44:19 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #2 23:44:20 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 23:44:21 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
23668 23:44:22 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #18 23:44:22 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

ManagedPoolThread #7 23:44:22 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
26276 23:44:23 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26064 23:44:23 INFO  [Path Analyzer](.) Running trail cleanup agent
26064 23:44:23 INFO  [Path Analyzer](.) Running trail cleanup on database
ManagedPoolThread #12 23:44:23 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 23:44:24 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
20692 23:44:25 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:44:25 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:44:25 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24808 23:44:25 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
24808 23:44:25 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



ManagedPoolThread #17 23:44:26 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

ManagedPoolThread #10 23:44:26 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #16 23:44:27 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #4 23:44:28 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 23:44:29 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
25212 23:44:30 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #18 23:44:32 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

23668 23:44:37 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:44:38 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:44:40 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:44:40 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:44:40 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24808 23:44:40 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 23:44:42 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

25212 23:44:45 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

23668 23:44:52 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 23:44:52 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

26276 23:44:53 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:44:55 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:44:55 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:44:55 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24808 23:44:55 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25212 23:45:00 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 23:45:02 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

23668 23:45:07 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:45:08 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:45:10 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:45:10 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:45:10 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24808 23:45:10 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 23:45:12 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

25212 23:45:15 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

23668 23:45:22 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 23:45:22 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

26276 23:45:23 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #6 23:45:24 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
20692 23:45:25 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:45:25 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:45:25 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24808 23:45:25 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 23:45:25 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 23:45:26 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #14 23:45:27 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #11 23:45:28 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #15 23:45:29 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
25212 23:45:30 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 23:45:30 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 23:45:31 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #9 23:45:32 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

ManagedPoolThread #2 23:45:32 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 23:45:33 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 23:45:34 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #4 23:45:35 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 23:45:36 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
23668 23:45:37 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:45:38 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:45:40 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:45:40 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:45:40 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24808 23:45:40 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 23:45:42 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

25212 23:45:45 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

23668 23:45:52 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #18 23:45:52 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

26276 23:45:53 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:45:55 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:45:55 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24808 23:45:55 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:45:55 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25212 23:46:00 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #18 23:46:02 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

23668 23:46:07 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:46:08 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:46:10 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:46:10 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24808 23:46:10 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:46:10 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 23:46:12 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

25212 23:46:15 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

23668 23:46:22 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #18 23:46:23 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

26276 23:46:23 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:46:25 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:46:25 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24808 23:46:25 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:46:25 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #18 23:46:27 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

25212 23:46:30 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 23:46:33 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

ManagedPoolThread #5 23:46:35 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #15 23:46:36 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #11 23:46:37 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
23668 23:46:37 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #14 23:46:38 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
26276 23:46:38 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #2 23:46:39 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 23:46:40 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
20692 23:46:40 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:46:40 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:46:40 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 23:46:41 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 23:46:42 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #19 23:46:43 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

ManagedPoolThread #0 23:46:43 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 23:46:44 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 23:46:45 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
25212 23:46:45 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 23:46:46 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #10 23:46:47 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 23:46:48 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #16 23:46:49 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
24808 23:46:50 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
24808 23:46:50 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



23668 23:46:52 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 23:46:53 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

26276 23:46:53 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:46:56 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:46:56 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:46:56 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25212 23:47:00 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 23:47:03 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

24808 23:47:05 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

23668 23:47:07 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:47:08 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:47:11 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:47:11 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:47:11 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 23:47:13 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

25212 23:47:15 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24808 23:47:20 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

23668 23:47:22 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 23:47:23 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

26276 23:47:23 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:47:26 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:47:26 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:47:26 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 23:47:27 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

25212 23:47:30 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 23:47:33 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

24808 23:47:35 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

23668 23:47:38 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:47:38 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:47:41 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:47:41 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:47:41 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #18 23:47:43 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

ManagedPoolThread #11 23:47:45 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
25212 23:47:45 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #15 23:47:46 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #14 23:47:47 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #2 23:47:48 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 23:47:49 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 23:47:50 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 23:47:51 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 23:47:52 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
23668 23:47:53 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 23:47:53 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

26276 23:47:53 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #12 23:47:53 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 23:47:54 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 23:47:55 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
20692 23:47:56 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:47:56 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:47:56 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #16 23:47:56 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
24808 23:47:57 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
24808 23:47:57 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



ManagedPoolThread #4 23:47:58 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #10 23:47:59 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
25212 23:48:00 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #18 23:48:03 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

23668 23:48:08 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:48:08 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:48:11 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:48:11 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:48:11 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24808 23:48:12 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #18 23:48:13 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

25212 23:48:15 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

23668 23:48:23 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:48:23 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 23:48:23 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

20692 23:48:26 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:48:26 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:48:26 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24808 23:48:27 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25212 23:48:30 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 23:48:33 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

23668 23:48:38 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:48:38 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:48:41 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:48:41 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:48:41 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24808 23:48:42 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 23:48:43 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

25212 23:48:45 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

23668 23:48:53 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:48:53 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 23:48:53 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

ManagedPoolThread #1 23:48:55 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
20692 23:48:56 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:48:56 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:48:56 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 23:48:56 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
24808 23:48:57 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #2 23:48:57 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 23:48:58 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #15 23:48:59 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 23:49:00 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
25212 23:49:00 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #14 23:49:01 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #11 23:49:02 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #9 23:49:03 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

ManagedPoolThread #5 23:49:03 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 23:49:04 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 23:49:05 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #16 23:49:06 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 23:49:07 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
23668 23:49:08 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:49:08 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #10 23:49:08 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #4 23:49:09 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
20692 23:49:11 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:49:11 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:49:11 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24808 23:49:12 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 23:49:13 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

25212 23:49:15 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

23668 23:49:23 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26064 23:49:23 INFO  [Path Analyzer](.) Running trail cleanup agent
26064 23:49:23 INFO  [Path Analyzer](.) Running trail cleanup on database
14232 23:49:23 WARN  [Path Analyzer](.) SmartMergeAgent.Execute() returns. No missing date ranges to merge.
26276 23:49:23 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 23:49:23 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

ManagedPoolThread #19 23:49:23 INFO  Health.PrivateBytes: 996,511,744
ManagedPoolThread #19 23:49:23 INFO  Health.CacheInstances: 125
ManagedPoolThread #19 23:49:23 INFO  Health.CacheTotalCount: 12,729
ManagedPoolThread #19 23:49:23 INFO  Health.CacheTotalSize: 25,638,965
20692 23:49:26 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:49:26 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:49:26 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24808 23:49:27 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #18 23:49:27 INFO  Job started: Update device detection DB
ManagedPoolThread #18 23:49:27 WARN  Authentication on CES Discovery service failed.
Exception: System.Net.WebException
Message: The remote server returned an error: (403) Forbidden.
Source: System
   at System.Net.HttpWebRequest.GetResponse()
   at Sitecore.CES.Client.WebClient.ExecuteRequest(String requestUri)
   at Sitecore.CES.Client.ResourceConnector`1.Request(String endpoint, Object[] parameters)
   at Sitecore.CES.Discovery.EndpointSource.GetEndpoint(String serviceName)

ManagedPoolThread #18 23:49:27 WARN  No subscription for Device Detection service. Could not check for updates.
ManagedPoolThread #18 23:49:27 INFO  Job ended: Update device detection DB (units processed: )
ManagedPoolThread #17 23:49:29 INFO  Job started: Sitecore.Tasks.UrlAgent
ManagedPoolThread #17 23:49:29 INFO  Scheduling.UrlAgent started. Url: http://localhost:91/sitecore/service/keepalive.aspx
ManagedPoolThread #17 23:49:29 INFO  Scheduling.UrlAgent done (received: 589 bytes)
ManagedPoolThread #17 23:49:29 INFO  Job ended: Sitecore.Tasks.UrlAgent (units processed: )
ManagedPoolThread #19 23:49:29 INFO  Job started: Sitecore.Tasks.TaskDatabaseAgent
ManagedPoolThread #19 23:49:29 INFO  Processing tasks (count: 0)
ManagedPoolThread #19 23:49:29 INFO  Job ended: Sitecore.Tasks.TaskDatabaseAgent (units processed: )
ManagedPoolThread #18 23:49:29 INFO  Job started: Core_Database_Agent
ManagedPoolThread #18 23:49:29 INFO  Scheduling.DatabaseAgent started. Database: core
ManagedPoolThread #18 23:49:29 INFO  Examining schedules (count: 0)
ManagedPoolThread #18 23:49:29 INFO  Job ended: Core_Database_Agent (units processed: )
ManagedPoolThread #9 23:49:29 INFO  Job started: Master_Database_Agent
ManagedPoolThread #9 23:49:29 INFO  Scheduling.DatabaseAgent started. Database: master
ManagedPoolThread #9 23:49:29 INFO  Examining schedules (count: 5)
ManagedPoolThread #9 23:49:29 INFO  Starting: __Task Schedule
ManagedPoolThread #9 23:49:29 INFO  Ended: __Task Schedule
ManagedPoolThread #9 23:49:29 INFO  Not due: Calculate Statistical Relevancy
ManagedPoolThread #9 23:49:29 INFO  Not due: Rebuild Suggested Tests Index
ManagedPoolThread #9 23:49:29 INFO  Not due: Suspend Corrupted Tests
ManagedPoolThread #9 23:49:29 INFO  Not due: Try Finish Test
ManagedPoolThread #9 23:49:29 INFO  Job ended: Master_Database_Agent (units processed: 5)
25212 23:49:30 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 23:49:33 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

23668 23:49:38 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:49:38 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:49:41 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:49:41 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:49:41 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24808 23:49:42 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 23:49:43 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

25212 23:49:45 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

23668 23:49:53 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:49:53 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 23:49:53 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

20692 23:49:56 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:49:56 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:49:56 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24808 23:49:57 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25212 23:50:00 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 23:50:03 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

ManagedPoolThread #14 23:50:05 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 23:50:06 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 23:50:07 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
23668 23:50:08 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:50:08 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #5 23:50:08 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #11 23:50:09 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 23:50:10 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
20692 23:50:11 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:50:11 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:50:11 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #6 23:50:11 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #2 23:50:12 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #9 23:50:13 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

ManagedPoolThread #15 23:50:13 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 23:50:14 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 23:50:15 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
25212 23:50:15 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 23:50:16 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #4 23:50:17 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
24808 23:50:18 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
24808 23:50:18 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



ManagedPoolThread #16 23:50:19 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
23668 23:50:23 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:50:23 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 23:50:23 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

20692 23:50:26 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:50:26 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:50:26 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #18 23:50:27 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

25212 23:50:30 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 23:50:33 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

24808 23:50:33 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

23668 23:50:38 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:50:38 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:50:41 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:50:41 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:50:41 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 23:50:43 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

25212 23:50:45 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24808 23:50:48 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

23668 23:50:53 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:50:53 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 23:50:53 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

20692 23:50:56 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:50:56 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:50:56 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25212 23:51:00 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 23:51:03 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

24808 23:51:03 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

23668 23:51:08 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:51:08 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:51:11 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:51:11 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:51:11 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 23:51:13 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

ManagedPoolThread #14 23:51:15 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
25212 23:51:15 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #1 23:51:16 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 23:51:17 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 23:51:18 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #11 23:51:19 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 23:51:20 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #2 23:51:21 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 23:51:22 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
23668 23:51:23 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:51:23 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 23:51:23 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

ManagedPoolThread #15 23:51:23 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 23:51:24 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 23:51:25 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
20692 23:51:26 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:51:26 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:51:26 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24808 23:51:26 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
24808 23:51:26 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



ManagedPoolThread #16 23:51:27 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 23:51:28 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
25212 23:51:30 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 23:51:33 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

23668 23:51:38 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:51:38 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:51:41 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:51:41 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:51:41 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24808 23:51:41 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 23:51:43 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

25212 23:51:45 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

23668 23:51:53 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:51:53 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 23:51:53 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

20692 23:51:56 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:51:56 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:51:56 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24808 23:51:56 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25212 23:52:00 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 23:52:03 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

23668 23:52:08 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:52:08 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:52:11 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:52:11 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:52:11 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24808 23:52:11 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 23:52:13 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

25212 23:52:15 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

23668 23:52:23 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:52:23 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #18 23:52:23 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

ManagedPoolThread #6 23:52:26 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
20692 23:52:26 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:52:26 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:52:26 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #1 23:52:27 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #18 23:52:27 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

ManagedPoolThread #0 23:52:28 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 23:52:29 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #11 23:52:30 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
25212 23:52:30 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #2 23:52:31 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 23:52:32 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #14 23:52:33 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #18 23:52:33 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

ManagedPoolThread #15 23:52:34 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 23:52:35 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 23:52:36 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
24808 23:52:37 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
24808 23:52:37 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



23668 23:52:38 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:52:38 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 23:52:38 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #10 23:52:39 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 23:52:40 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
20692 23:52:41 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:52:41 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:52:41 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #16 23:52:41 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #17 23:52:43 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

25212 23:52:45 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24808 23:52:52 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

23668 23:52:53 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:52:53 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #18 23:52:53 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

20692 23:52:56 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:52:56 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:52:56 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25212 23:53:00 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #18 23:53:03 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

24808 23:53:07 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

23668 23:53:08 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:53:08 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:53:11 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:53:11 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:53:11 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 23:53:13 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

25212 23:53:15 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24808 23:53:22 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

23668 23:53:23 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:53:23 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 23:53:23 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

20692 23:53:26 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:53:26 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:53:26 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 23:53:28 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

25212 23:53:30 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 23:53:33 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

ManagedPoolThread #7 23:53:36 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
24808 23:53:37 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 23:53:37 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
23668 23:53:38 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:53:38 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #11 23:53:38 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 23:53:39 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 23:53:40 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
20692 23:53:41 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:53:41 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:53:41 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #2 23:53:41 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #15 23:53:42 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 23:53:43 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #19 23:53:43 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

ManagedPoolThread #14 23:53:44 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
25212 23:53:45 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #12 23:53:46 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 23:53:47 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #10 23:53:48 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #16 23:53:49 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
24808 23:53:52 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

23668 23:53:53 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:53:53 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 23:53:54 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

20692 23:53:56 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:53:56 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:53:56 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25212 23:54:00 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 23:54:04 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

24808 23:54:07 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

23668 23:54:08 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:54:08 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:54:11 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:54:11 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:54:11 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 23:54:14 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

25212 23:54:15 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24808 23:54:22 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26064 23:54:23 INFO  [Path Analyzer](.) Running trail cleanup agent
26064 23:54:23 INFO  [Path Analyzer](.) Running trail cleanup on database
23668 23:54:23 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:54:23 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 23:54:24 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

20692 23:54:26 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:54:26 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:54:26 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25212 23:54:30 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 23:54:34 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

24808 23:54:37 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

23668 23:54:38 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:54:38 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:54:41 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:54:41 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:54:41 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #18 23:54:44 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

25212 23:54:45 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #14 23:54:47 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 23:54:48 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 23:54:49 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 23:54:50 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 23:54:51 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #2 23:54:52 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
23668 23:54:53 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:54:53 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #15 23:54:53 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #18 23:54:54 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

ManagedPoolThread #11 23:54:54 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 23:54:55 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
20692 23:54:56 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:54:56 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:54:56 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #12 23:54:56 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 23:54:57 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
14852 23:54:58 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #10 23:54:59 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
25212 23:55:00 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 23:55:00 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #16 23:55:01 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 23:55:02 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
24808 23:55:03 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
24808 23:55:03 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



ManagedPoolThread #17 23:55:04 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

23668 23:55:08 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:55:08 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:55:11 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:55:11 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:55:11 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #18 23:55:14 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

25212 23:55:15 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24808 23:55:18 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

23668 23:55:23 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:55:23 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 23:55:24 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

20692 23:55:26 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:55:26 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:55:26 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 23:55:28 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

25212 23:55:30 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24808 23:55:33 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 23:55:34 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

23668 23:55:38 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:55:38 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:55:41 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:55:41 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:55:41 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 23:55:44 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

25212 23:55:45 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24808 23:55:48 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

23668 23:55:53 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:55:53 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 23:55:54 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

20692 23:55:56 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:55:56 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:55:56 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 23:55:58 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 23:55:59 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
25212 23:56:00 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #14 23:56:00 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 23:56:01 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
14852 23:56:02 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 23:56:03 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #18 23:56:04 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

ManagedPoolThread #7 23:56:04 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #2 23:56:05 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 23:56:06 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #15 23:56:07 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
23668 23:56:08 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:56:08 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #11 23:56:08 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 23:56:09 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 23:56:10 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
20692 23:56:11 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:56:11 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:56:11 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24808 23:56:11 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
24808 23:56:11 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



ManagedPoolThread #10 23:56:12 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #4 23:56:13 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #19 23:56:14 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

25212 23:56:15 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

23668 23:56:23 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:56:23 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 23:56:24 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

20692 23:56:26 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:56:26 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:56:26 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24808 23:56:26 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25212 23:56:30 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 23:56:34 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

23668 23:56:38 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:56:38 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:56:41 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:56:41 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:56:41 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24808 23:56:41 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 23:56:44 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

25212 23:56:45 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

23668 23:56:53 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:56:53 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 23:56:54 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

20692 23:56:56 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:56:56 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:56:56 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24808 23:56:56 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 23:56:59 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
25212 23:57:00 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #18 23:57:04 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

23668 23:57:08 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:57:08 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #14 23:57:10 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
20692 23:57:11 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:57:11 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:57:11 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24808 23:57:11 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #5 23:57:11 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 23:57:12 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 23:57:13 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #18 23:57:14 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

ManagedPoolThread #7 23:57:14 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
25212 23:57:15 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #2 23:57:15 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 23:57:16 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #15 23:57:17 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #11 23:57:18 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 23:57:19 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 23:57:20 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 23:57:21 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
23668 23:57:23 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:57:23 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #16 23:57:23 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #4 23:57:24 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #18 23:57:24 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

ManagedPoolThread #10 23:57:25 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
20692 23:57:26 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:57:26 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:57:26 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24808 23:57:26 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 23:57:28 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

25212 23:57:30 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #18 23:57:34 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

23668 23:57:38 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:57:38 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:57:41 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:57:41 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:57:41 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24808 23:57:41 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 23:57:44 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

25212 23:57:45 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

23668 23:57:53 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:57:53 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 23:57:54 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

20692 23:57:56 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:57:56 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:57:56 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24808 23:57:56 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25212 23:58:00 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 23:58:00 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #9 23:58:04 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

23668 23:58:08 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:58:08 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:58:11 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:58:11 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:58:11 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24808 23:58:11 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 23:58:14 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

25212 23:58:15 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #3 23:58:21 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 23:58:22 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
23668 23:58:23 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:58:23 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #14 23:58:23 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 23:58:24 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #17 23:58:25 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

ManagedPoolThread #2 23:58:25 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
20692 23:58:26 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:58:26 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:58:26 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #6 23:58:26 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #15 23:58:27 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #18 23:58:28 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

ManagedPoolThread #7 23:58:28 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #11 23:58:29 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
25212 23:58:30 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #1 23:58:30 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 23:58:31 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #16 23:58:32 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #10 23:58:33 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #18 23:58:34 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

24808 23:58:35 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
24808 23:58:35 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



ManagedPoolThread #8 23:58:36 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
23668 23:58:38 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:58:38 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:58:41 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:58:41 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:58:41 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #18 23:58:44 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

25212 23:58:45 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24808 23:58:50 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

23668 23:58:53 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:58:53 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #18 23:58:54 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

20692 23:58:56 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:58:56 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:58:56 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25212 23:59:00 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 23:59:01 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #17 23:59:04 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

24808 23:59:05 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

23668 23:59:08 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:59:08 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

20692 23:59:11 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:59:11 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:59:11 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #18 23:59:14 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

25212 23:59:15 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24808 23:59:20 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26064 23:59:23 INFO  [Path Analyzer](.) Running trail cleanup agent
26064 23:59:23 INFO  [Path Analyzer](.) Running trail cleanup on database
23668 23:59:23 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:59:23 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 23:59:24 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

ManagedPoolThread #18 23:59:24 INFO  Health.PrivateBytes: 996,630,528
ManagedPoolThread #18 23:59:24 INFO  Health.CacheInstances: 125
ManagedPoolThread #18 23:59:24 INFO  Health.CacheTotalCount: 12,729
ManagedPoolThread #18 23:59:24 INFO  Health.CacheTotalSize: 25,638,965
20692 23:59:26 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:59:26 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:59:26 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 23:59:28 INFO  Job started: Update device detection DB
ManagedPoolThread #9 23:59:29 WARN  Authentication on CES Discovery service failed.
Exception: System.Net.WebException
Message: The remote server returned an error: (403) Forbidden.
Source: System
   at System.Net.HttpWebRequest.GetResponse()
   at Sitecore.CES.Client.WebClient.ExecuteRequest(String requestUri)
   at Sitecore.CES.Client.ResourceConnector`1.Request(String endpoint, Object[] parameters)
   at Sitecore.CES.Discovery.EndpointSource.GetEndpoint(String serviceName)

ManagedPoolThread #9 23:59:29 WARN  No subscription for Device Detection service. Could not check for updates.
ManagedPoolThread #9 23:59:29 INFO  Job ended: Update device detection DB (units processed: )
25212 23:59:30 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #18 23:59:30 INFO  Job started: Sitecore.Tasks.TaskDatabaseAgent
ManagedPoolThread #18 23:59:30 INFO  Processing tasks (count: 0)
ManagedPoolThread #18 23:59:30 INFO  Job ended: Sitecore.Tasks.TaskDatabaseAgent (units processed: )
ManagedPoolThread #19 23:59:30 INFO  Job started: Core_Database_Agent
ManagedPoolThread #19 23:59:30 INFO  Scheduling.DatabaseAgent started. Database: core
ManagedPoolThread #19 23:59:30 INFO  Examining schedules (count: 0)
ManagedPoolThread #19 23:59:30 INFO  Job ended: Core_Database_Agent (units processed: )
ManagedPoolThread #17 23:59:30 INFO  Job started: Master_Database_Agent
ManagedPoolThread #17 23:59:30 INFO  Scheduling.DatabaseAgent started. Database: master
ManagedPoolThread #17 23:59:30 INFO  Examining schedules (count: 5)
ManagedPoolThread #17 23:59:30 INFO  Starting: __Task Schedule
ManagedPoolThread #17 23:59:30 INFO  Ended: __Task Schedule
ManagedPoolThread #17 23:59:30 INFO  Not due: Calculate Statistical Relevancy
ManagedPoolThread #17 23:59:30 INFO  Not due: Rebuild Suggested Tests Index
ManagedPoolThread #17 23:59:30 INFO  Not due: Suspend Corrupted Tests
ManagedPoolThread #17 23:59:30 INFO  Not due: Try Finish Test
ManagedPoolThread #17 23:59:30 INFO  Job ended: Master_Database_Agent (units processed: 5)
14852 23:59:33 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #14 23:59:34 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #17 23:59:34 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

ManagedPoolThread #11 23:59:35 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 23:59:36 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #2 23:59:37 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
23668 23:59:38 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:59:38 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #1 23:59:38 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 23:59:39 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #15 23:59:40 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
20692 23:59:41 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:59:41 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:59:41 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #6 23:59:41 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 23:59:42 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 23:59:43 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
24808 23:59:44 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
24808 23:59:44 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



ManagedPoolThread #17 23:59:44 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

25212 23:59:45 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 23:59:45 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #16 23:59:46 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #10 23:59:47 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #4 23:59:48 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
23668 23:59:53 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26276 23:59:53 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 23:59:54 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

20692 23:59:56 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1044 23:59:56 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24072 23:59:56 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

24808 23:59:59 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

