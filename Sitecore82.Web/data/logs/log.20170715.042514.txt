ManagedPoolThread #0 04:25:14 WARN  Failed to create counter 'Sitecore.System\Events | Events Raised / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #1 04:25:14 WARN  Failed to create counter 'Sitecore.System\IO | File Watcher Events / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #2 04:25:14 WARN  Failed to create counter 'Sitecore.System\Logging | Errors Logged / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #3 04:25:14 WARN  Failed to create counter 'Sitecore.System\Logging | Fatals Logged / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #4 04:25:14 WARN  Failed to create counter 'Sitecore.System\Logging | Informations Logged / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #5 04:25:14 WARN  Failed to create counter 'Sitecore.System\Logging | Warnings Logged / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #6 04:25:15 WARN  Failed to create counter 'Sitecore.System\Logging | Audits Logged / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #7 04:25:15 WARN  Failed to create counter 'Sitecore.System\Reflection | Methods Invoked / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #8 04:25:16 WARN  Failed to create counter 'Sitecore.System\Reflection | Objects Created / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #9 04:25:16 WARN  Failed to create counter 'Sitecore.System\Reflection | Objects Not Created / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #10 04:25:16 WARN  Failed to create counter 'Sitecore.System\Reflection | Types Resolved / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #11 04:25:16 WARN  Failed to create counter 'Sitecore.System\Reflection | Types Not Resolved / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #12 04:25:16 WARN  Failed to create counter 'Sitecore.System\Threading | Background Threads Started / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #13 04:25:16 WARN  Failed to create counter 'Sitecore.System\Xml | Packets Created / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
20692 04:25:16 INFO  HttpModule is being initialized
20692 04:25:16 INFO  
20692 04:25:16 INFO  **********************************************************************
20692 04:25:16 INFO  **********************************************************************
20692 04:25:16 INFO  Sitecore started
20692 04:25:16 INFO  Sitecore.NET 8.2 (rev. 170614)
20692 04:25:16 INFO  
20692 04:25:16 INFO  c:\repo\sitecore82\sitecore82.web\bin\antlr3.runtime.dll (Antlr3.Runtime)
20692 04:25:16 INFO  c:\repo\sitecore82\sitecore82.web\bin\castle.core.dll (Castle Core, Castle Core, including DynamicProxy, Logging Abstractions and DictionaryAdapter, 4.1.1)
20692 04:25:16 INFO  c:\repo\sitecore82\sitecore82.web\bin\componentart.web.ui.dll ()
20692 04:25:16 INFO  c:\repo\sitecore82\sitecore82.web\bin\dotnetopenauth.dll (DotNetOpenAuth, 1c99bf16c5b570cadcf27d0b9ce3d598d06b34ca)
20692 04:25:16 INFO  c:\repo\sitecore82\sitecore82.web\bin\ecmascript.net.dll (Modified version of the EcmaScript.NET assembly)
20692 04:25:16 INFO  c:\repo\sitecore82\sitecore82.web\bin\facebook.dll (Facebook C# SDK, Facebook C# SDK)
20692 04:25:16 INFO  c:\repo\sitecore82\sitecore82.web\bin\facebookapi.dll (FacebookAPI)
20692 04:25:16 INFO  c:\repo\sitecore82\sitecore82.web\bin\glass.mapper.dll (Glass.Mapper, 4.4.0.199)
20692 04:25:16 INFO  c:\repo\sitecore82\sitecore82.web\bin\glass.mapper.sc.dll (Glass.Mapper.Sc, 4.4.0.199)
20692 04:25:16 INFO  c:\repo\sitecore82\sitecore82.web\bin\glass.mapper.sc.mvc.dll (Glass.Mapper.Sc.Mvc)
20692 04:25:16 INFO  c:\repo\sitecore82\sitecore82.web\bin\google.apis.authentication.oauth2.dll (OAuth2 Authentication Library)
20692 04:25:16 INFO  c:\repo\sitecore82\sitecore82.web\bin\google.apis.dll ()
20692 04:25:16 INFO  c:\repo\sitecore82\sitecore82.web\bin\google.apis.plus.v1.dll (Google.Apis.Plus.v1)
20692 04:25:16 INFO  c:\repo\sitecore82\sitecore82.web\bin\hammock.clientprofile.dll (Hammock)
20692 04:25:16 INFO  c:\repo\sitecore82\sitecore82.web\bin\htmlagilitypack.dll (Html Agility Pack, 1.4.6.0)
20692 04:25:16 INFO  c:\repo\sitecore82\sitecore82.web\bin\icsharpcode.sharpziplib.dll (#ZipLibrary, A free C# compression library, 0.86.0)
20692 04:25:16 INFO  c:\repo\sitecore82\sitecore82.web\bin\iesi.collections.dll (Iesi.Collections, Enhanced Collections for .NET.  Code was published at http://www.codeproject.com/csharp/sets.asp, 1.0)
20692 04:25:16 INFO  c:\repo\sitecore82\sitecore82.web\bin\ithit.webdav.server.dll (WebDav Server .Net v2, IT Hit WebDAV Server .Net v2)
20692 04:25:16 INFO  c:\repo\sitecore82\sitecore82.web\bin\lucene.net.contrib.analyzers.dll (Lucene.Net.Contrib.Analyzers)
20692 04:25:16 INFO  c:\repo\sitecore82\sitecore82.web\bin\lucene.net.contrib.core.dll (Lucene.Net.Contrib.Core, Contributions to the Lucene.Net core library)
20692 04:25:16 INFO  c:\repo\sitecore82\sitecore82.web\bin\lucene.net.contrib.fastvectorhighlighter.dll (Lucene.Net.Contrib.FastVectorHighlighter, FastVectorHighlighter for Lucene.Net)
20692 04:25:16 INFO  c:\repo\sitecore82\sitecore82.web\bin\lucene.net.contrib.highlighter.dll (Lucene.Net.Contrib.Highlighter, The Apache Software Foundation Lucene.Net a full-text search engine library, 2.3.2)
20692 04:25:16 INFO  c:\repo\sitecore82\sitecore82.web\bin\lucene.net.contrib.memory.dll (Contrib.Memory)
20692 04:25:16 INFO  c:\repo\sitecore82\sitecore82.web\bin\lucene.net.contrib.queries.dll (Lucene.Net.Contrib.Queries)
20692 04:25:16 INFO  c:\repo\sitecore82\sitecore82.web\bin\lucene.net.contrib.regex.dll (Lucene.Net.Contrib.Regex)
20692 04:25:16 INFO  c:\repo\sitecore82\sitecore82.web\bin\lucene.net.contrib.simplefacetedsearch.dll (Lucene.Net.SimpleFacetedSearch, SimpleFacetedSearch for Lucene.Net)
20692 04:25:16 INFO  c:\repo\sitecore82\sitecore82.web\bin\lucene.net.contrib.snowball.dll (Lucene.Net.Contrib.Snowball, The Apache Software Foundation Lucene.Net a full-text search engine library, 2.0)
20692 04:25:16 INFO  c:\repo\sitecore82\sitecore82.web\bin\lucene.net.contrib.spellchecker.dll (SpellChecker.Net, The Apache Software Foundation Lucene.Net a full-text search engine library, 3.0.3)
20692 04:25:16 INFO  c:\repo\sitecore82\sitecore82.web\bin\lucene.net.dll (Lucene.Net, The Apache Software Foundation Lucene.Net a full-text search engine library, 3.0.3)
20692 04:25:16 INFO  c:\repo\sitecore82\sitecore82.web\bin\markdownsharp.dll (Markdown processor)
20692 04:25:16 INFO  c:\repo\sitecore82\sitecore82.web\bin\microsoft.ai.agent.intercept.dll (Microsoft.AI.Agent.Intercept)
20692 04:25:16 INFO  c:\repo\sitecore82\sitecore82.web\bin\microsoft.ai.dependencycollector.dll ()
20692 04:25:16 INFO  c:\repo\sitecore82\sitecore82.web\bin\microsoft.ai.perfcountercollector.dll ()
20692 04:25:16 INFO  c:\repo\sitecore82\sitecore82.web\bin\microsoft.ai.servertelemetrychannel.dll ()
20692 04:25:16 INFO  c:\repo\sitecore82\sitecore82.web\bin\microsoft.ai.web.dll (Application Insights .NET SDK, Application Insights for Web Applications)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\microsoft.ai.windowsserver.dll ()
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\microsoft.analysisservices.adomdclient.dll (Microsoft SQL Server, ADOMD.NET, 10.50.1600.1)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\microsoft.applicationinsights.dll ()
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\microsoft.aspnet.telemetrycorrelation.dll (Microsoft.AspNet.TelemetryCorrelation, 1.0.0-10628)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\microsoft.aspnet.webapi.extensions.compression.server.dll (Microsoft.AspNet.WebApi.Extensions.Compression.Server, Module for ASP.NET WebApi that enables GZip and Deflate support for incoming and outgoing requests)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\microsoft.codedom.providers.dotnetcompilerplatform.dll (Microsoft.CodeDom.Providers.DotNetCompilerPlatform, 1.0.5-40505)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\microsoft.extensions.dependencyinjection.abstractions.dll (Microsoft .NET Extensions, Abstractions for dependency injection.
Commonly used types:
Microsoft.Extensions.DependencyInjection.IServiceCollection
Microsoft.Extensions.DependencyInjection.ServiceCollectionExtensions, 1.0.0-rtm-21431)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\microsoft.extensions.dependencyinjection.dll (Microsoft .NET Extensions, Default implementation of dependency injection for Microsoft.Extensions.DependencyInjection, 1.0.0-rtm-21431)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\microsoft.odata.core.dll (Microsoft® .NET Framework, Microsoft.OData.Core.dll, 6.15.0.0)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\microsoft.odata.edm.dll (Microsoft® .NET Framework, Microsoft.OData.Edm.dll, 6.15.0.0)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\microsoft.practices.servicelocation.dll (Microsoft.Practices.ServiceLocation, A simple facade that provides insulation from specific IoC containers)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\microsoft.spatial.dll (Microsoft® .NET Framework, Microsoft.Spatial.dll, 6.15.0.0)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\microsoft.sqlserver.connectioninfo.dll (Microsoft SQL Server, 10.50.2500.0)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\microsoft.sqlserver.dmf.dll (Microsoft SQL Server, 10.50.2500.0)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\microsoft.sqlserver.management.sdk.sfc.dll (Microsoft SQL Server, 10.50.2500.0)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\microsoft.sqlserver.regsvrenum.dll (Microsoft SQL Server, 10.50.1600.1)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\microsoft.sqlserver.servicebrokerenum.dll (Microsoft SQL Server, 10.50.1600.1)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\microsoft.sqlserver.smo.dll (Microsoft SQL Server, 10.50.2500.0)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\microsoft.sqlserver.smoextended.dll (Microsoft SQL Server, 10.50.2500.0)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\microsoft.sqlserver.sqlenum.dll (Microsoft SQL Server, 10.50.2500.0)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\microsoft.web.administration.dll (Internet Information Services)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\microsoft.web.delegation.dll (Microsoft (R) Windows (R) Operating System)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\microsoft.web.deployment.tracing.dll (Microsoft (R) Windows (R) Operating System)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\microsoft.web.infrastructure.dll (Microsoft ASP.Net WebPages)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\microsoft.windowsazure.serviceruntime.dll (Windows Azure Runtime, 2.7.1198.742 (rd_art_stable.151102-1219))
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\mongodb.bson.dll (MongoDB.Bson, Official MongoDB supported BSON library. See http://www.mongodb.org/display/DOCS/CSharp+Language+Center for more details, { version: '1.10.0.62', semver: '1.10.0', commit: '2df664a15859899b9bb0a457e237ec32c7d31e48', commitDate: '2015-01-29 15:41:46' })
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\mongodb.driver.dll (MongoDB.Driver, Official MongoDB supported driver for MongoDB.  See http://www.mongodb.org/display/DOCS/CSharp+Language+Center for more details, { version: '1.10.0.62', semver: '1.10.0', commit: '2df664a15859899b9bb0a457e237ec32c7d31e48', commitDate: '2015-01-29 15:41:46' })
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\mvp.xml.dll (MVP XML Library)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\netbiscuits.onpremise.dll (OnPremise)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\newtonsoft.json.dll (Json.NET, Json.NET is a popular high-performance JSON framework for .NET)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\ninject.dll (Ninject: Lightweight dependency injection for .NET, IoC container)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\ninject.web.common.dll (Ninject.Web.Common: Web Common Extension for Ninject, Bootstrapper for web projects)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\ninject.web.mvc.dll (Ninject.Web.Mvc: Ninject support for MVC3, Extension for Ninject providing integration with ASP.NET MVC3)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\oauthlinkedin.dll (OAuthLinkedIn)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\protobuf-net.dll (protobuf-net, Protocol Buffers for .NET)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\radeditor.net2.dll (RadEditor, Telerik RadEditor)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\razorgenerator.mvc.dll (RazorGenerator, MVC View engine that supports precompiled Razor views, 2.4.2)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.abstractions.dll (Sitecore CMS, 10.0.6-r00427-7aa1a4e)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.analytics.aggregation.dll (Sitecore xDB, 10.0.3-r00151-50c3b36)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.analytics.automation.aggregation.dll (Sitecore Engagement Automation, 10.0.0 rev. 160623)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.analytics.automation.dll (Sitecore Engagement Automation, 10.0.0 rev. 160623)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.analytics.automation.mongodb.dll (Sitecore Engagement Automation, 10.0.0 rev. 160623)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.analytics.core.dll (Sitecore xDB, 10.0.3-r00151-50c3b36)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.analytics.dataaccess.dll (Sitecore xDB, 10.0.3-r00151-50c3b36)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.analytics.dll (Sitecore xDB, Sitecore xDB, 10.0.3-r00151-50c3b36)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.analytics.model.dll (Sitecore xDB, 10.0.3-r00151-50c3b36)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.analytics.mongodb.dll (Sitecore xDB, Sitecore xDB MongoDB Connector, 10.0.3-r00151-50c3b36)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.analytics.omnichannel.dll (Sitecore xDB, 10.0.3-r00151-50c3b36)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.analytics.outcome.dll (Sitecore xDB, 10.0.3-r00151-50c3b36)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.analytics.processing.dll (Sitecore xDB, 10.0.3-r00151-50c3b36)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.analytics.robotdetection.dll (Sitecore Robot Detection, 10.0.0 rev. 160614)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.analytics.sql.dll (Sitecore xDB, 10.0.3-r00151-50c3b36)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.apps.loader.dll (Sitecore.Apps.Loader, Sitecore.Apps.Loader, 1.1.1-r00027)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.buckets.client.dll (Sitecore Buckets, The assembly can be used to have Sitecore queries driven via a query, 2.0.3-r00059-172ac17)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.buckets.dll (Sitecore Buckets, The assembly can be used to have Sitecore queries driven via search providers, 2.0.3-r00059-172ac17)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.ces.devicedetection.dll (Sitecore DeviceDetection Client, 1.1.1-r00035-9c0de72)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.ces.devicedetection.rules.dll (Sitecore DeviceDetection Client, 1.1.1-r00035-9c0de72)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.ces.dll (Sitecore IP Geolocation Service Client, 1.4.0 rev. 160712)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.ces.geoip.dll (Sitecore IP Geolocation Service Client, 1.4.0 rev. 160712)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.ces.geoip.legacylocation.dll (Sitecore IP Geolocation Service Client, 1.4.0 rev. 160712)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.cintel.client.dll (Sitecore Experience Profile, 1.2.2-r00106-f2ca7b5)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.cintel.dll (Sitecore Experience Profile, 1.2.2-r00106-f2ca7b5)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.client.dll (Sitecore CMS, Sitecore Client Application, 10.0.6-r00427-7aa1a4e)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.client.licenseoptions.dll (Sitecore Speak Applications, 1.4.3-r00042-f6a50ff)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.cloud.nexus.dll (Sitecore Cloud Nexus, 2.3.0.59)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.cloud.restclient.dll (Sitecore Cloud RestClient, 6.3.0.50)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.commerce.dll (Sitecore Commerce Connect, 8.2.328-2789d2d)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.commerce.experienceanalytics.dll (Sitecore Commerce Connect, 8.2.328-2789d2d)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.commerce.experienceprofile.dll (Sitecore Commerce Connect, 8.2.328-2789d2d)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.contentsearch.analytics.client.dll (Sitecore ContactSegmentationIndex, 10.0.3-r00038-0270659)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.contentsearch.analytics.dll (Sitecore ContactSegmentationIndex, 10.0.3-r00038-0270659)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.contentsearch.azure.dll (Sitecore.ContentSearch.Azure, 1.1.1-r00181-3a41657)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.contentsearch.client.dll (Sitecore Content Search, 2.0.4-r00156-d42f546)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.contentsearch.dll (Sitecore Content Search, Sitecore CMS Search, 2.0.4-r00156-d42f546)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.contentsearch.linq.dll (Sitecore Content Search, Sitecore CMS Search, 2.0.4-r00156-d42f546)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.contentsearch.linq.lucene.dll (Sitecore Content Search, 2.0.4-r00156-d42f546)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.contentsearch.linq.solr.dll (Sitecore Content Search, 2.0.4-r00156-d42f546)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.contentsearch.luceneprovider.dll (Sitecore Content Search, Sitecore CMS Search, 2.0.4-r00156-d42f546)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.contentsearch.solrprovider.dll (Sitecore Content Search, 2.0.4-r00156-d42f546)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.contenttesting.dll (Sitecore Content Testing, 10.0.1-r0129-36eec12)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.contenttesting.intelligence.dll (Sitecore Content Testing, 10.0.1-r0129-36eec12)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.contenttesting.model.dll (Sitecore Content Testing, 10.0.1-r0129-36eec12)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.contenttesting.mvc.dll (Sitecore Content Testing, 10.0.1-r0129-36eec12)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.controlpanel.dll (Sitecore Speak Applications, 1.4.3-r00042-f6a50ff)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.experienceanalytics.aggregation.dll (Sitecore Experience Analytics, 2.0.3-r01092-309193e)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.experienceanalytics.api.dll (Sitecore Experience Analytics, 2.0.3-r01092-309193e)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.experienceanalytics.client.dll (Sitecore Experience Analytics, 2.0.3-r01092-309193e)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.experienceanalytics.core.dll (Sitecore Experience Analytics, 2.0.3-r01092-309193e)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.experienceanalytics.dll (Sitecore Experience Analytics, 2.0.3-r01092-309193e)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.experienceanalytics.reaggregation.dll (Sitecore Experience Analytics, 2.0.3-r01092-309193e)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.experienceanalytics.reduce.dll (Sitecore Experience Analytics, 2.0.3-r01092-309193e)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.experiencecontentmanagement.administration.dll (Sitecore ExperienceContentManagement Administration, 1.1.3-r00188-95f876f)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.experienceeditor.dll (Sitecore Experience Editor, 3.0.2 rev. 170201)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.experienceeditor.speak.dll (Sitecore Experience Editor, 3.0.2 rev. 170201)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.experienceeditor.speak.ribbon.dll (Sitecore Experience Editor, 3.0.2 rev. 170201)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.experienceexplorer.business.dll (Sitecore Experience Explorer, 2.1.1 rev. 161020)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.experienceexplorer.web.dll (Sitecore Experience Explorer, 2.1.1 rev. 161020)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.fxm.client.dll (Sitecore Federated Experience Manager, 2.2.1 rev. 161026 )
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.fxm.dll (Sitecore Federated Experience Manager, 2.2.1 rev. 161026 )
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.fxm.service.dll (Sitecore Federated Experience Manager, 2.2.1 rev. 161026 )
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.fxm.speak.dll (Sitecore Federated Experience Manager, 2.2.1 rev. 161026 )
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.itemwebapi.dll (Sitecore Item Web API, 1.3.0 rev. 160621)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.kernel.dll (Sitecore CMS, Sitecore CMS Kernel Library, 10.0.6-r00427-7aa1a4e)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.launchpad.dll (Sitecore LaunchPad, 1.1.2-r00016-f173885)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.listmanagement.analytics.dll (Sitecore.ListManager, 1.2.4-r01654-32bf3fa)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.listmanagement.client.dll (Sitecore.ListManager, 1.2.4-r01654-32bf3fa)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.listmanagement.contentsearch.dll (Sitecore.ListManager, 1.2.4-r01654-32bf3fa)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.listmanagement.dll (Sitecore.ListManager, 1.2.4-r01654-32bf3fa)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.listmanagement.services.dll (Sitecore.ListManager, 1.2.4-r01654-32bf3fa)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.logging.client.dll (Sitecore Logging, Lets you insert loggers in your JavaScript, and automatically sends the log messages to a server side component that stores them in your existing server side logs. Interfaces with Sitecore.Logging.

Ideal for logging JavaScript exceptions to the server, including a stack trace. Documentation and examples are at jsnlog.com, 10.0.3-r00009-708d10c)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.logging.dll (Sitecore Logging, Sitecore Logging Framework, 10.0.3-r00009-708d10c)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.marketing.campaigns.client.dll (Sitecore CampaignManager, 1.2.3-r00163-d432ce4)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.marketing.campaigns.services.dll (Sitecore CampaignManager, 1.2.3-r00163-d432ce4)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.marketing.client.dll (Sitecore Marketing Client, 10.0.1-r00063-beed883)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.marketing.core.dll (Sitecore Marketing Operations, 10.0.1-r00078-e3dc0ef)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.marketing.definitions.marketingassets.repositories.dll (Sitecore Marketing Asset Repositories, 10.0.1-r00076-4de1ed5)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.marketing.dll (Sitecore Marketing Operations, 10.0.1-r00078-e3dc0ef)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.marketing.search.dll (Sitecore Marketing Operations, 10.0.1-r00078-e3dc0ef)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.marketing.taxonomy.dll (Sitecore Marketing Operations, 10.0.1-r00078-e3dc0ef)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.models.dll (Sitecore.Models)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.mvc.analytics.dll (Sitecore Mvc Analytics, 10.0.0 rev. 160718)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.mvc.devicesimulator.dll (Sitecore Mvc Device Simulators, 1.1.1-r00016-448c8fa)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.mvc.dll (Sitecore Mvc, 1.2.1-r00105-7c6b4bf)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.mvc.experienceeditor.dll (Sitecore MVC Experience Editor, 2.1.1 rev. 161026)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.nexus.dll (Sitecore.Nexus, 1.0.4425)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.nvelocity.dll (Sitecore NVelocity, Sitecore Macro Expansion Library, 7.0.1-r00005-6c34393)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.oracle.dll (Sitecore Oracle, 10.0.4-r00017-a982934)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.pathanalyzer.client.dll (Sitecore Path Analyzer, 1.2.1-r01330-b85df3f)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.pathanalyzer.dll (Sitecore Path Analyzer, 1.2.1-r01330-b85df3f)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.pathanalyzer.services.dll (Sitecore Path Analyzer, 1.2.1-r01330-b85df3f)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.publishing.webdeploy.dll (Sitecore CMS, Sitecore publishing infrastructure based on Web Deployment Tool, 10.0.6-r00427-7aa1a4e)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.security.anticsrf.dll (Sitecore AntiCSRF Module, 1.1.1-r00011-e000b86)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.segmentbuilder.dll (Sitecore.SegmentBuilder, 1.1.4-r00041-4cfa4cf)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.sequenceanalyzer.dll (Sitecore Path Analyzer, 1.2.1-r01330-b85df3f)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.services.client.dll (Sitecore Services Client, Sitecore Services, 1.4.1-r1039-caca69c)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.services.core.dll (Sitecore Services Client Services, Sitecore Services, 1.4.1-r1027-c1fc0cb)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.services.infrastructure.dll (Sitecore Services Client Services, Sitecore Services, 1.4.1-r1027-c1fc0cb)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.services.infrastructure.sitecore.dll (Sitecore Services Client Services, Sitecore Services, 1.4.1-r1027-c1fc0cb)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.sessionprovider.dll (Sitecore Session Providers, 10.0.4-r00047-78f7434)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.sessionprovider.memory.dll (Sitecore Session Providers, 10.0.4-r00047-78f7434)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.sessionprovider.mongodb.dll (Sitecore Session Providers, 10.0.4-r00047-78f7434)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.sessionprovider.redis.dll (Sitecore Session Providers, 10.0.4-r00047-78f7434)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.sessionprovider.sql.dll (Sitecore Session Providers, 10.0.4-r00047-78f7434)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.shell.marketingautomation.dll (Sitecore Engagement Automation Suite, 10.0.0 rev. 160623)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.social.api.dll (Social Connected Module, 10.0.2-r03924-97f5950)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.social.client.api.dll (Social Connected Module, 10.0.2-r03924-97f5950)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.social.client.common.dll (Social Connected Module, 10.0.2-r03924-97f5950)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.social.client.dll (Social Connected Module, 10.0.2-r03924-97f5950)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.social.client.domain.dll (Social Connected Module, 10.0.2-r03924-97f5950)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.social.client.mvc.dll (Social Connected Module, 10.0.2-r03924-97f5950)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.social.client.publishingservice.dll (Social Connected Module, 10.0.2-r03924-97f5950)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.social.client.speak.dll (Social Connected Module, 10.0.2-r03924-97f5950)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.social.configuration.dll (Social Connected Module, 10.0.2-r03924-97f5950)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.social.dll (Social Connected Module, 10.0.2-r03924-97f5950)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.social.domain.dll (Social Connected Module, 10.0.2-r03924-97f5950)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.social.experienceprofile.client.dll (Social Connected Module, 10.0.2-r03924-97f5950)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.social.facebook.api.dll (Social Connected Module, 10.0.2-r03924-97f5950)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.social.facebook.client.dll (Social Connected Module, 10.0.2-r03924-97f5950)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.social.facebook.client.mvc.dll (Social Connected Module, 10.0.2-r03924-97f5950)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.social.facebook.dll (Social Connected Module, 10.0.2-r03924-97f5950)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.social.googleplus.client.dll (Social Connected Module, 10.0.2-r03924-97f5950)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.social.googleplus.client.mvc.dll (Social Connected Module, 10.0.2-r03924-97f5950)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.social.googleplus.dll (Social Connected Module, 10.0.2-r03924-97f5950)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.social.infrastructure.dll (Social Connected Module, 10.0.2-r03924-97f5950)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.social.infrastructure.logging.dll (Social Connected Module, 10.0.2-r03924-97f5950)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.social.installation.dll (Social Connected Module, 10.0.2-r03924-97f5950)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.social.klout.api.dll (Social Connected Module, 10.0.2-r03924-97f5950)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.social.klout.client.dll (Social Connected Module, 10.0.2-r03924-97f5950)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.social.linkedin.client.dll (Social Connected Module, 10.0.2-r03924-97f5950)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.social.linkedin.client.mvc.dll (Social Connected Module, 10.0.2-r03924-97f5950)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.social.linkedin.dll (Social Connected Module, 10.0.2-r03924-97f5950)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.social.networkproviders.dll (Social Connected Module, 10.0.2-r03924-97f5950)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.social.sitecoreaccess.dll (Social Connected Module, 10.0.2-r03924-97f5950)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.social.socialmarketer.api.dll (Social Connected Module, 10.0.2-r03924-97f5950)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.social.socialmarketer.client.dll (Social Connected Module, 10.0.2-r03924-97f5950)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.social.socialmarketer.dll (Social Connected Module, 10.0.2-r03924-97f5950)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.social.twitter.api.dll (Social Connected Module, 10.0.2-r03924-97f5950)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.social.twitter.client.dll (Social Connected Module, 10.0.2-r03924-97f5950)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.social.twitter.client.mvc.dll (Social Connected Module, 10.0.2-r03924-97f5950)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.social.twitter.dll (Social Connected Module, 10.0.2-r03924-97f5950)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.speak.applications.dll (Sitecore Speak Applications, 1.4.3-r00042-f6a50ff)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.speak.client.dll (Sitecore Speak, 2.1.4-r00019-ed0a7b1)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.speak.components.dll (Sitecore Speak Components, 2.1.4-r00039-315de3d)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.speak.components.guidance.dll (Sitecore Speak Components, 2.1.4-r00039-315de3d)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.speak.components.web.dll (Sitecore Speak Components, 2.1.4-r00039-315de3d)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.speak.itemwebapi.dll (Sitecore Speak, 2.1.4-r00019-ed0a7b1)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.speak.web.dll (Sitecore Speak, 2.1.4-r00019-ed0a7b1)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.update.dll (Sitecore Update Installation Wizard, 2.0.1-r00135-7060f87)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.web.dll (Sitecore.Web 1.2.0, 1.2.0 rev. 160603)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.xdb.client.dll (Sitecore xDB, 10.0.3-r00151-50c3b36)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.xdb.configuration.dll (Sitecore xDB, 10.0.3-r00151-50c3b36)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore.zip.dll (Sitecore Zip, ZIP support for Sitecore, 10.0.1-r00006-d7200ec)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore82.controllers.dll (Sitecore82.Controllers)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\sitecore82.web.dll (Sitecore82.Web)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\solrnet.dll (SolrNet, SolrNet, 17bf323fdcbbee137ca44af080426ea0b28cb626)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\stackexchange.redis.strongname.dll (StackExchange.Redis, 1.0.488)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\stimulsoft.base.dll (Stimulsoft Reports, Stimulsoft Base)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\stimulsoft.database.dll (Stimulsoft Reports, Stimulsoft Reports Database Helper)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\stimulsoft.report.dll (Stimulsoft Reports, Stimulsoft Reports Engine)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\stimulsoft.report.web.dll (Stimulsoft Reports.Web, Stimulsoft Reports.Web Viewer)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\stimulsoft.report.webdesign.dll (Stimulsoft Reports Designer.Web, Stimulsoft Reports Designer.Web)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\system.collections.concurrent.dll (Microsoft® .NET Framework, System.Collections.Concurrent, 4.7.2053.0)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\system.collections.dll (Microsoft® .NET Framework, System.Collections, 4.7.2053.0)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\system.componentmodel.annotations.dll (Microsoft® .NET Framework, System.ComponentModel.Annotations, 4.7.2053.0)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\system.componentmodel.eventbasedasync.dll (Microsoft® .NET Framework, System.ComponentModel.EventBasedAsync, 4.7.2053.0)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\system.diagnostics.debug.dll (Microsoft® .NET Framework, System.Diagnostics.Debug, 4.7.2053.0)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\system.diagnostics.diagnosticsource.dll (Microsoft® .NET Framework, System.Diagnostics.DiagnosticSource, 4.6.25427.03 built by: dlab-DDVSOWINAGE026. Commit Hash: d6210f5a6924725f855bbeda567d6a9fcf9caf1c)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\system.diagnostics.tracing.dll (Microsoft® .NET Framework, System.Diagnostics.Tracing, 4.7.2053.0)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\system.dynamic.runtime.dll (Microsoft® .NET Framework, System.Dynamic.Runtime, 4.7.2053.0)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\system.globalization.dll (Microsoft® .NET Framework, System.Globalization, 4.7.2053.0)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\system.identitymodel.tokens.jwt.dll (System.IdentityModel.Tokens.Jwt, .Net 4.5 support for JSON Web Security Tokens, 20622.1351.a95e76cc46fe08b6d46b5fbe2405d27269475a1a)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\system.io.dll (Microsoft® .NET Framework, System.IO, 4.7.2053.0)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\system.linq.expressions.dll (Microsoft® .NET Framework, System.Linq.Expressions, 4.7.2053.0)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\system.net.http.extensions.compression.core.dll (Core)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\system.net.http.formatting.dll (Microsoft ASP.NET MVC, 5.2.3-30128 (0e974218e12a67d4b1f25422119e40cfe6953e46))
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\system.net.networkinformation.dll (Microsoft® .NET Framework, System.Net.NetworkInformation, 4.7.2053.0)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\system.net.primitives.dll (Microsoft® .NET Framework, System.Net.Primitives, 4.7.2053.0)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\system.net.requests.dll (Microsoft® .NET Framework, System.Net.Requests, 4.7.2053.0)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\system.objectmodel.dll (Microsoft® .NET Framework, System.ObjectModel, 4.7.2053.0)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\system.reflection.dll (Microsoft® .NET Framework, System.Reflection, 4.7.2053.0)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\system.runtime.dll (Microsoft® .NET Framework, System.Runtime, 4.7.2053.0)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\system.runtime.extensions.dll (Microsoft® .NET Framework, System.Runtime.Extensions, 4.7.2053.0)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\system.runtime.interopservices.dll (Microsoft® .NET Framework, System.Runtime.InteropServices, 4.7.2053.0)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\system.runtime.serialization.primitives.dll (Microsoft® .NET Framework, System.Runtime.Serialization.Primitives, 4.7.2053.0)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\system.runtime.serialization.xml.dll (Microsoft® .NET Framework, System.Runtime.Serialization.Xml, 4.7.2053.0)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\system.servicemodel.http.dll (Microsoft® .NET Framework, System.ServiceModel.Http, 4.7.2053.0)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\system.text.encoding.dll (Microsoft® .NET Framework, System.Text.Encoding, 4.7.2053.0)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\system.text.encoding.extensions.dll (Microsoft® .NET Framework, System.Text.Encoding.Extensions, 4.7.2053.0)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\system.text.regularexpressions.dll (Microsoft® .NET Framework, System.Text.RegularExpressions, 4.7.2053.0)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\system.threading.dll (Microsoft® .NET Framework, System.Threading, 4.7.2053.0)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\system.threading.tasks.dll (Microsoft® .NET Framework, System.Threading.Tasks, 4.7.2053.0)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\system.web.cors.dll (Microsoft ASP.NET MVC, 5.2.3-30128 (0e974218e12a67d4b1f25422119e40cfe6953e46))
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\system.web.helpers.dll (Microsoft ASP.NET Web Pages, 3.0.3-30128 (0e974218e12a67d4b1f25422119e40cfe6953e46))
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\system.web.http.cors.dll (Microsoft ASP.NET MVC, 5.2.3-30128 (0e974218e12a67d4b1f25422119e40cfe6953e46))
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\system.web.http.dll (Microsoft ASP.NET MVC, 5.2.3-30128 (0e974218e12a67d4b1f25422119e40cfe6953e46))
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\system.web.http.webhost.dll (Microsoft ASP.NET MVC, 5.2.3-30128 (0e974218e12a67d4b1f25422119e40cfe6953e46))
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\system.web.mvc.dll (Microsoft ASP.NET MVC, System.Web.Mvc.dll, 5.2.3-30128 (0e974218e12a67d4b1f25422119e40cfe6953e46))
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\system.web.odata.dll (Microsoft OData Web API, 5.9.0-40401)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\system.web.optimization.dll (System.Web.Optimization)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\system.web.razor.dll (Microsoft ASP.NET Web Pages, 3.0.3-30128 (0e974218e12a67d4b1f25422119e40cfe6953e46))
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\system.web.webpages.deployment.dll (Microsoft ASP.NET Web Pages, 3.0.3-30128 (0e974218e12a67d4b1f25422119e40cfe6953e46))
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\system.web.webpages.dll (Microsoft ASP.NET Web Pages, 3.0.3-30128 (0e974218e12a67d4b1f25422119e40cfe6953e46))
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\system.web.webpages.razor.dll (Microsoft ASP.NET Web Pages, 3.0.3-30128 (0e974218e12a67d4b1f25422119e40cfe6953e46))
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\system.xml.readerwriter.dll (Microsoft® .NET Framework, System.Xml.ReaderWriter, 4.7.2053.0)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\system.xml.xdocument.dll (Microsoft® .NET Framework, System.Xml.XDocument, 4.7.2053.0)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\system.xml.xmlserializer.dll (Microsoft® .NET Framework, System.Xml.XmlSerializer, 4.7.2053.0)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\telerik.web.ui.dll (Telerik.Web.UI, Telerik UI for ASP.NET AJAX)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\telerik.web.ui.skins.dll (Telerik.Web.UI.Skins, Telerik UI for ASP.NET AJAX Ajax Skins)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\tweetsharp.dll (TweetSharp)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\webactivatorex.dll (WebActivator, A package that allows other packages to execute some startup code in web apps. This package should be used over the older WebActivator, which was not strong named)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\webgrease.dll (WebGrease)
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\windowsazureeventsource.dll (Windows Azure Runtime, 2.7.1198.742 (rd_art_stable.151102-1219))
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\windowsazuretelemetryevents.dll (Windows Azure Runtime, 2.7.1198.742 (rd_art_stable.151102-1219))
20692 04:25:17 INFO  c:\repo\sitecore82\sitecore82.web\bin\yahoo.yui.compressor.dll (YUI Compressor, A .NET port of the Yahoo! YUI Compressor project)
20692 04:25:17 INFO  
20692 04:25:17 INFO  Operating system Microsoft Windows NT 6.3.9600.0
20692 04:25:17 INFO  
20692 04:25:17 INFO  Microsoft.NET version 4.0.30319.42000
20692 04:25:17 INFO  
20692 04:25:17 INFO  UTC offset: 01:00:00
20692 04:25:17 INFO  Machine name: win81qwerty
20692 04:25:17 INFO  App pool ID: sitecore82
20692 04:25:17 INFO  
20692 04:25:17 INFO  Process ID: 26956
20692 04:25:17 INFO  Windows identity used by the process: IIS APPPOOL\sitecore82. Impersonation: False
20692 04:25:17 INFO  Managed pipeline mode: Integrated
20692 04:25:17 INFO  
20692 04:25:17 INFO  EventQueues enabled: True
20692 04:25:17 INFO  Instance Name:WIN81QWERTY-sitecore82
20692 04:25:17 INFO  
20692 04:25:17 INFO  Threshold settings
20692 04:25:17 INFO    Show threshold warnings: False
20692 04:25:17 INFO  
20692 04:25:17 INFO  Databases
20692 04:25:17 INFO    core
20692 04:25:17 INFO    master
20692 04:25:17 INFO    web
20692 04:25:17 INFO    filesystem
20692 04:25:17 INFO  
20692 04:25:17 INFO  Domains
20692 04:25:17 INFO  Heartbeat - Initializing
20692 04:25:17 INFO  Heartbeat - Interval set to: 00:00:02
20692 04:25:17 INFO  Heartbeat - Worker thread started
20692 04:25:17 INFO  Trying to load XML configuration /App_Config/Security/Domains.config
20692 04:25:17 INFO    default
20692 04:25:17 INFO    extranet
20692 04:25:17 INFO    sitecore
20692 04:25:17 INFO  **********************************************************************
20692 04:25:17 INFO  **********************************************************************
ManagedPoolThread #0 04:25:17 WARN  Failed to create counter 'Sitecore.Jobs\Jobs | Jobs Executed / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #10 04:25:17 WARN  Failed to create counter 'Sitecore.Jobs\Pipelines | Pipelines Aborted / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #11 04:25:17 WARN  Failed to create counter 'Sitecore.Jobs\Pipelines | Pipelines Executed / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #12 04:25:17 WARN  Failed to create counter 'Sitecore.Jobs\Pipelines | Processors Executed / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #8 04:25:17 WARN  Failed to create counter 'Sitecore.Jobs\Publishing | Items Queued / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #13 04:25:17 WARN  Failed to create counter 'Sitecore.Jobs\Publishing | Replacements / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #9 04:25:17 WARN  Failed to create counter 'Sitecore.Jobs\Tasks | File Cleanups / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #1 04:25:17 WARN  Failed to create counter 'Sitecore.Jobs\Tasks | Html Cache Clearings / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #3 04:25:17 WARN  Failed to create counter 'Sitecore.Jobs\Tasks | Publishings / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #2 04:25:17 WARN  Failed to create counter 'Sitecore.Jobs\Tasks | Reminders Sent / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #4 04:25:17 WARN  Failed to create counter 'Sitecore.Jobs\Tasks | Tasks Executed / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
20692 04:25:17 INFO  
20692 04:25:17 INFO  **********************************************************************
20692 04:25:17 INFO  **********************************************************************
20692 04:25:17 INFO  
20692 04:25:17 INFO  xDB is enabled.
20692 04:25:17 INFO  
20692 04:25:17 INFO  Tracking is enabled.
20692 04:25:17 INFO  
20692 04:25:17 INFO  Valid xDB license is present.
20692 04:25:17 INFO  
20692 04:25:17 INFO  **********************************************************************
20692 04:25:17 INFO  **********************************************************************
20692 04:25:17 INFO  [Path Analyzer](ApplicationContainer.RegisterType) Sitecore.SequenceAnalyzer.Data.ITreeStorage
20692 04:25:17 INFO  [Path Analyzer](ApplicationContainer.RegisterType) Sitecore.PathAnalyzer.Data.Storage.ITreeDefinitionStorage
20692 04:25:17 INFO  [Path Analyzer](ApplicationContainer.RegisterType) Sitecore.PathAnalyzer.Contracts.ITreeDefinitionService
20692 04:25:17 INFO  [Path Analyzer](ApplicationContainer.RegisterType) Sitecore.PathAnalyzer.Contracts.IMapItemRepository
20692 04:25:17 INFO  [Path Analyzer](ApplicationContainer.RegisterType) Sitecore.PathAnalyzer.Contracts.IMapStatusService
20692 04:25:17 INFO  [Path Analyzer](ApplicationContainer.RegisterType) Sitecore.PathAnalyzer.Contracts.IConfiguration
20692 04:25:17 INFO  [Path Analyzer](ApplicationContainer.RegisterType) Sitecore.SequenceAnalyzer.Configuration.IPruningConfig
20692 04:25:17 INFO  [Path Analyzer](ApplicationContainer.RegisterType) Sitecore.PathAnalyzer.Contracts.IContactReader
20692 04:25:17 INFO  [Path Analyzer](ApplicationContainer.RegisterType) Sitecore.PathAnalyzer.Localization.IResourceManager
20692 04:25:17 INFO  [Path Analyzer](ApplicationContainer.RegisterType) Sitecore.PathAnalyzer.Data.Caching.ICache
20692 04:25:17 INFO  [Path Analyzer](ApplicationContainer.RegisterType) Sitecore.PathAnalyzer.Contracts.ITreeProvider
20692 04:25:17 INFO  [Path Analyzer](ApplicationContainer.RegisterType) Sitecore.PathAnalyzer.Data.SitecoreData.IItemRepository
20692 04:25:17 INFO  [Path Analyzer](ApplicationContainer.RegisterType) Sitecore.PathAnalyzer.Contracts.IMapItemDeploymentManager
20692 04:25:17 INFO  [Path Analyzer](ApplicationContainer.RegisterType) Sitecore.PathAnalyzer.Data.Storage.ITreeStorageManager
20692 04:25:17 INFO  [Path Analyzer](ApplicationContainer.RegisterModelsForSerialization) Setting serialization info
20692 04:25:17 INFO  [Path Analyzer](ApplicationContainer.RegisterModelsForSerialization) Type 'Sitecore.PathAnalyzer.Data.Models.ExperienceNode, Sitecore.PathAnalyzer' was registered succesfully.
20692 04:25:17 INFO  [Path Analyzer](ApplicationContainer.RegisterModelsForSerialization) Type 'Sitecore.PathAnalyzer.Data.Models.ExperienceTree, Sitecore.PathAnalyzer' was registered succesfully.
20692 04:25:17 INFO  [Path Analyzer](ApplicationContainer.RegisterModelsForSerialization) Type 'Sitecore.PathAnalyzer.Data.Models.PageNode, Sitecore.PathAnalyzer' was registered succesfully.
20692 04:25:17 INFO  MemoryMonitor initialized. Threshold: 2 GB. Interval: 00:00:05
20692 04:25:17 INFO  [Analytics]: Started background service for 'maintenanceService'.
20692 04:25:17 INFO  [Analytics]: Started background service for 'aggregation/aggregator'.
20692 04:25:17 INFO  [Analytics]: Started background service for 'aggregation/contactProcessing'.
20692 04:25:17 INFO  [Analytics]: Started background service for 'aggregation/rebuildAgent'.
20692 04:25:17 INFO  [Analytics]: Started background service for 'aggregation/historyWorker'.
20692 04:25:17 INFO  [Analytics]: Started background service for 'aggregation/historyCompletionCheck'.
20692 04:25:17 INFO  [Analytics]: Started background service for 'aggregation/automationAggregator'.
20692 04:25:17 INFO  [Analytics]: Started background service for 'aggregation/automationRangeManager'.
20692 04:25:17 INFO  [Analytics]: Started background service for 'aggregation/automationCleanupService'.
20692 04:25:17 INFO  [Analytics]: Automation aggregation SubsystemLoader hook initialized.
20692 04:25:17 INFO  [Analytics]: Started background service for 'processing/taskAgent'.
20692 04:25:17 INFO  Cache created: 'rules' (max size: 800KB, running total: 800KB)
20692 04:25:17 INFO  Cache created: 'ProxyProvider' (max size: 2MB, running total: 3MB)
20692 04:25:17 INFO  Cache created: 'DeviceItemsCache' (max size: 50MB, running total: 53MB)
20692 04:25:17 INFO  Cache created: 'core[data]' (max size: 100MB, running total: 153MB)
20692 04:25:17 INFO  Cache created: 'core[items]' (max size: 50MB, running total: 203MB)
20692 04:25:17 INFO  Cache created: 'core[paths]' (max size: 2MB, running total: 205MB)
20692 04:25:17 INFO  Cache created: 'core[standardValues]' (max size: 2MB, running total: 208MB)
20692 04:25:17 INFO  Cache created: 'core[languageFallbackObsolete]' (max size: 20MB, running total: 228MB)
20692 04:25:17 INFO  Cache created: 'core[languageFallback]' (max size: 20MB, running total: 248MB)
20692 04:25:17 INFO  Cache created: 'core[isLanguageFallbackValid]' (max size: 100KB, running total: 248MB)
20692 04:25:17 INFO  Cache created: 'core[isLanguageFallbackValidObsolete]' (max size: 100KB, running total: 248MB)
20692 04:25:17 INFO  Cache created: 'core[itempaths]' (max size: 50MB, running total: 298MB)
20692 04:25:17 INFO  Cache created: 'core[blobIDs]' (max size: 5MB, running total: 303MB)
20692 04:25:17 INFO  Cache created: 'master[data]' (max size: 100MB, running total: 403MB)
20692 04:25:17 INFO  Cache created: 'master[items]' (max size: 50MB, running total: 453MB)
20692 04:25:17 INFO  Cache created: 'master[paths]' (max size: 2MB, running total: 455MB)
20692 04:25:17 INFO  Cache created: 'master[standardValues]' (max size: 2MB, running total: 458MB)
20692 04:25:17 INFO  Cache created: 'master[languageFallbackObsolete]' (max size: 20MB, running total: 478MB)
20692 04:25:17 INFO  Cache created: 'master[languageFallback]' (max size: 20MB, running total: 498MB)
20692 04:25:17 INFO  Cache created: 'master[isLanguageFallbackValid]' (max size: 100KB, running total: 498MB)
20692 04:25:17 INFO  Cache created: 'master[isLanguageFallbackValidObsolete]' (max size: 100KB, running total: 498MB)
20692 04:25:17 INFO  Cache created: 'master[itempaths]' (max size: 50MB, running total: 548MB)
20692 04:25:17 INFO  Cache created: 'master[blobIDs]' (max size: 5MB, running total: 553MB)
20692 04:25:17 INFO  Cache created: 'web[data]' (max size: 100MB, running total: 653MB)
20692 04:25:17 INFO  Cache created: 'web[items]' (max size: 50MB, running total: 703MB)
20692 04:25:17 INFO  Cache created: 'web[paths]' (max size: 2MB, running total: 705MB)
20692 04:25:17 INFO  Cache created: 'web[standardValues]' (max size: 2MB, running total: 708MB)
20692 04:25:17 INFO  Cache created: 'web[languageFallbackObsolete]' (max size: 20MB, running total: 728MB)
20692 04:25:17 INFO  Cache created: 'web[languageFallback]' (max size: 20MB, running total: 748MB)
20692 04:25:17 INFO  Cache created: 'web[isLanguageFallbackValid]' (max size: 100KB, running total: 748MB)
20692 04:25:17 INFO  Cache created: 'web[isLanguageFallbackValidObsolete]' (max size: 100KB, running total: 748MB)
20692 04:25:17 INFO  Cache created: 'web[itempaths]' (max size: 50MB, running total: 798MB)
20692 04:25:17 INFO  Cache created: 'web[blobIDs]' (max size: 5MB, running total: 803MB)
20692 04:25:17 INFO  Cache created: 'filesystem[data]' (max size: 0 bytes, running total: 803MB)
20692 04:25:17 INFO  Cache created: 'filesystem[items]' (max size: 0 bytes, running total: 803MB)
20692 04:25:17 INFO  Cache created: 'filesystem[paths]' (max size: 0 bytes, running total: 803MB)
20692 04:25:17 INFO  Cache created: 'filesystem[standardValues]' (max size: 0 bytes, running total: 803MB)
20692 04:25:17 INFO  Cache created: 'filesystem[languageFallbackObsolete]' (max size: 20MB, running total: 823MB)
20692 04:25:17 INFO  Cache created: 'filesystem[languageFallback]' (max size: 20MB, running total: 843MB)
20692 04:25:17 INFO  Cache created: 'filesystem[isLanguageFallbackValid]' (max size: 100KB, running total: 843MB)
20692 04:25:17 INFO  Cache created: 'filesystem[isLanguageFallbackValidObsolete]' (max size: 100KB, running total: 843MB)
20692 04:25:17 INFO  Cache created: 'filesystem[itempaths]' (max size: 50MB, running total: 893MB)
20692 04:25:17 INFO  Cache created: 'filesystem[blobIDs]' (max size: 5MB, running total: 898MB)
20692 04:25:17 INFO  Cache created: '[FieldReaderCache, Id: defaultFieldReaderMap]' (max size: 5MB, running total: 903MB)
ManagedPoolThread #5 04:25:19 INFO  Trying to load XML configuration /App_Config/Security/Domains.config
20692 04:25:19 INFO  Cache created: 'SqlDataProvider - Property data(core)' (max size: 5MB, running total: 908MB)
ManagedPoolThread #7 04:25:19 WARN  Failed to create counter 'Sitecore.Caching\Cache Clearings / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #0 04:25:19 WARN  Failed to create counter 'Sitecore.Caching\Cache Hits / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #10 04:25:19 WARN  Failed to create counter 'Sitecore.Caching\Cache Misses / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #11 04:25:19 WARN  Failed to create counter 'Sitecore.Caching\Data Cache Clearings / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #12 04:25:19 WARN  Failed to create counter 'Sitecore.Caching\Data Cache Hits / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #8 04:25:19 WARN  Failed to create counter 'Sitecore.Caching\Data Cache Misses / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #13 04:25:19 WARN  Failed to create counter 'Sitecore.Caching\Html Cache Clearings / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #9 04:25:19 WARN  Failed to create counter 'Sitecore.Caching\Html Cache Hits / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #1 04:25:19 WARN  Failed to create counter 'Sitecore.Caching\Html Cache Misses / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #3 04:25:19 WARN  Failed to create counter 'Sitecore.Caching\Path Cache Clearings / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #2 04:25:19 WARN  Failed to create counter 'Sitecore.Caching\Path Cache Hits / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #4 04:25:19 WARN  Failed to create counter 'Sitecore.Caching\Path Cache Misses / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #6 04:25:19 WARN  Failed to create counter 'Sitecore.Caching\Registry Cache Clearings / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #5 04:25:19 WARN  Failed to create counter 'Sitecore.Caching\Registry Cache Hits / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #7 04:25:19 WARN  Failed to create counter 'Sitecore.Caching\Registry Cache Misses / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #0 04:25:19 WARN  Failed to create counter 'Sitecore.Caching\View State Cache Clearings / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #10 04:25:19 WARN  Failed to create counter 'Sitecore.Caching\View State Cache Hits / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #11 04:25:19 WARN  Failed to create counter 'Sitecore.Caching\View State Cache Misses / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #12 04:25:19 WARN  Failed to create counter 'Sitecore.Caching\XslCache Clearings / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #8 04:25:19 WARN  Failed to create counter 'Sitecore.Caching\XslCache Hits / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #13 04:25:19 WARN  Failed to create counter 'Sitecore.Caching\XslCache Misses / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #9 04:25:19 WARN  Failed to create counter 'Sitecore.Data\Data | Client Data Reads / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #1 04:25:19 WARN  Failed to create counter 'Sitecore.Data\Data | Client Data Writes / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #3 04:25:19 WARN  Failed to create counter 'Sitecore.Data\Data | Items Accessed / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #2 04:25:19 WARN  Failed to create counter 'Sitecore.Data\Data | Physical Reads / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #4 04:25:19 WARN  Failed to create counter 'Sitecore.Data\Data | Physical Writes / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #6 04:25:19 WARN  Failed to create counter 'Sitecore.Data\Globalization | Texts Translated / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #5 04:25:19 WARN  Failed to create counter 'Sitecore.Data\Globalization | Translate Failed / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #7 04:25:19 WARN  Failed to create counter 'Sitecore.Data\Links | Fields Examined / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #0 04:25:19 WARN  Failed to create counter 'Sitecore.Data\Links | Data Read / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #10 04:25:19 WARN  Failed to create counter 'Sitecore.Data\Links | Data Updated / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #11 04:25:19 WARN  Failed to create counter 'Sitecore.Data\SqlServerStream | Open Streams / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #12 04:25:19 WARN  Failed to create counter 'Sitecore.Data\StreamSharer | Open Streams / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #8 04:25:19 WARN  Failed to create counter 'Sitecore.Data\Workflow | Actions Executed / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #13 04:25:19 WARN  Failed to create counter 'Sitecore.Data\Workflow | Security Resolved / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #9 04:25:19 WARN  Failed to create counter 'Sitecore.Data\Workflow | State Changes / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
6408 04:25:19 INFO  Cache created: 'SqlDataProvider - Property data(master)' (max size: 5MB, running total: 913MB)
6408 04:25:19 INFO  Cache created: 'SqlDataProvider - Property data(web)' (max size: 5MB, running total: 918MB)
20692 04:25:19 INFO  Cache created: 'taxonomy.campaigngroups' (max size: 20MB, running total: 938MB)
20692 04:25:19 INFO  Cache created: 'taxonomy.channels' (max size: 20MB, running total: 958MB)
20692 04:25:19 INFO  Cache created: 'taxonomy.venues' (max size: 20MB, running total: 978MB)
20692 04:25:19 INFO  Cache created: 'taxonomy.assets' (max size: 20MB, running total: 998MB)
20692 04:25:19 INFO  Cache created: 'taxonomy.outcomeGroups' (max size: 20MB, running total: 1018MB)
20692 04:25:19 INFO  [Analytics]: Started background service for 'pathAnalyzer/newMapAgent'.
20692 04:25:19 INFO  [Analytics]: Started background service for 'pathAnalyzer/smartMergeAgent'.
20692 04:25:19 INFO  [Analytics]: Started background service for 'aggregation/pathAnalyzerLiveAgent'.
20692 04:25:19 INFO  [Analytics]: Started background service for 'aggregation/pathAnalyzerHistoryAgent'.
20692 04:25:19 INFO  [Analytics]: Started background service for 'pathAnalyzer/trailCleanupAgent'.
20692 04:25:19 INFO  [Analytics]: Started background service for 'pathAnalyzer/mapRebuildStatusCheckerAgent'.
20692 04:25:19 INFO  [Path Analyzer](.) Path Analyzer subsystem hook initialized.
20692 04:25:19 WARN  Authentication on CES Discovery service failed.
Exception: System.Net.WebException
Message: The remote server returned an error: (403) Forbidden.
Source: System
   at System.Net.HttpWebRequest.GetResponse()
   at Sitecore.CES.Client.WebClient.ExecuteRequest(String requestUri)
   at Sitecore.CES.Client.ResourceConnector`1.Request(String endpoint, Object[] parameters)
   at Sitecore.CES.Discovery.EndpointSource.GetEndpoint(String serviceName)

20692 04:25:19 WARN  No subscription for Device Detection service. Could not load the database.
20692 04:25:19 WARN  Device detection component is disabled
20692 04:25:19 INFO  [Analytics]: Started background service for 'experienceAnalytics/reduce/agent'.
20692 04:25:19 INFO  [Experience Analytics]: Experience Analytics subsystem initialized.
20692 04:25:19 INFO  Cache created: 'LanguageProvider - Languages' (max size: 100KB, running total: 1018MB)
20692 04:25:19 INFO  Scheduler - Initializing
20692 04:25:19 INFO  Scheduler - Interval set to: 00:00:05
20692 04:25:19 INFO  Scheduler - Worker thread started
ManagedPoolThread #7 04:25:20 WARN  Failed to create counter 'Sitecore.Automation\State Transitions / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #0 04:25:20 WARN  Failed to create counter 'Sitecore.Automation\State Evaluations - Total / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #10 04:25:20 WARN  Failed to create counter 'Sitecore.Automation\State Evaluations - Page Events / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #11 04:25:20 WARN  Failed to create counter 'Sitecore.Automation\State Evaluations - Timeouts / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #12 04:25:20 WARN  Failed to create counter 'Sitecore.Automation\Emails Sent / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #8 04:25:20 WARN  Failed to create counter 'Sitecore.Automation\Average Evaluation Time'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #13 04:25:20 WARN  Failed to create counter 'Sitecore.Automation\Average Evaluation Time Average Base'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #9 04:25:20 WARN  Failed to create counter 'Sitecore.Automation\Average State Load Time - Contact'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #7 04:25:20 WARN  Failed to create counter 'Sitecore.Automation\Average State Load Time - Contact Average Base'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #0 04:25:20 WARN  Failed to create counter 'Sitecore.Automation\Monitor - Average Time to Load Data - ms'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #10 04:25:20 WARN  Failed to create counter 'Sitecore.Automation\Monitor - Average Time to Load Data - ms Average Base'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #11 04:25:20 WARN  Failed to create counter 'Sitecore.Automation\Aggregation | Automation Transitions Aggregated / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #12 04:25:20 WARN  Failed to create counter 'Sitecore.Automation\Aggregation | Contact States Aggregated / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #8 04:25:20 WARN  Failed to create counter 'Sitecore.Automation\Aggregation | Transition Aggregation Errors / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #13 04:25:20 WARN  Failed to create counter 'Sitecore.Automation\Aggregation | Contact State Aggregation Errors / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #9 04:25:20 WARN  Failed to create counter 'Sitecore.Automation\Aggregation | Average Automation Aggregation Pipeline Time / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #7 04:25:20 WARN  Failed to create counter 'Sitecore.Automation\Aggregation | Average Automation Aggregation Pipeline Time / sec Average Base'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #0 04:25:20 WARN  Failed to create counter 'Sitecore.Automation\Aggregation | Average Transition Store In Reporting / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #10 04:25:20 WARN  Failed to create counter 'Sitecore.Automation\Aggregation | Average Transition Store In Reporting / sec Average Base'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #11 04:25:20 WARN  Failed to create counter 'Sitecore.Automation\Aggregation | Average Contact States Store In Reporting / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #12 04:25:20 WARN  Failed to create counter 'Sitecore.Automation\Aggregation | Average Contact States Store In Reporting / sec Average Base'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #8 04:25:20 WARN  Failed to create counter 'Sitecore.Automation\Data | Average Delete Aggregated Transitions Time / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #13 04:25:20 WARN  Failed to create counter 'Sitecore.Automation\Data | Average Delete Aggregated Transitions Time / sec Average Base'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #9 04:25:20 WARN  Failed to create counter 'Sitecore.Automation\Data | Average Merge Transition Time/ sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #7 04:25:20 WARN  Failed to create counter 'Sitecore.Automation\Data | Average Merge Transition Time/ sec Average Base'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
20692 04:25:20 INFO  Sitecore.Analytics.Automation.Diagnostics.PerformanceCounters are initialized
ManagedPoolThread #0 04:25:20 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\Collection | Total Requests / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #10 04:25:20 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\Collection | Requests Tracked / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #11 04:25:20 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\Collection | Requests Ignored / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #12 04:25:20 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\Collection | Malicious Robot Requests / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #8 04:25:20 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\Collection | Robot Requests / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #13 04:25:20 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\Collection | Human Requests / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #9 04:25:20 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\Collection | Total Visits / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #7 04:25:20 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\Collection | Unique Visitors / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #0 04:25:20 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\Data | Dictionaries - Locations Reads / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #10 04:25:20 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\Data | Dictionaries - Locations Cache Hits / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #11 04:25:20 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\Data | Dictionaries - Locations Database Reads / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #12 04:25:20 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\Data | Dictionaries - Locations Writes / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #8 04:25:20 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\Data | Dictionaries - ReferringSites Reads / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #13 04:25:20 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\Data | Dictionaries - ReferringSites Cache Hits / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #9 04:25:20 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\Data | Dictionaries - ReferringSites Database Reads / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #7 04:25:20 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\Data | Dictionaries - ReferringSites Writes / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #0 04:25:20 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\Data | Dictionaries - UserAgents Reads / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #10 04:25:20 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\Data | Dictionaries - UserAgents Cache Hits / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #11 04:25:20 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\Data | Dictionaries - UserAgents Database Reads / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #12 04:25:20 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\Data | Dictionaries - UserAgents Writes / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #8 04:25:20 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\Data | Dictionaries - GeoIps Reads / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #13 04:25:20 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\Data | Dictionaries - GeoIps Cache Hits / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #9 04:25:20 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\Data | Dictionaries - GeoIps Database Reads / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #7 04:25:20 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\Data | Dictionaries - GeoIps Writes / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #0 04:25:20 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\GeoIP | Requests - Total / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #10 04:25:20 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\GeoIP | Requests - Pages / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #11 04:25:20 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\GeoIP | Requests - Background / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #12 04:25:20 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\GeoIP | Memory Lookups / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #8 04:25:20 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\GeoIP | Database Lookups / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #13 04:25:20 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\GeoIP | Provider Lookups / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #9 04:25:20 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\GeoIP | Failed Lookups / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #7 04:25:20 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\GeoIP | Unknown IPs / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #0 04:25:20 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\GeoIP | Average Resolve Time'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #10 04:25:20 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\GeoIP | Average Resolve Time Average Base'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #11 04:25:20 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\GeoIP | Cache Size'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #12 04:25:20 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\GeoIP | Visits Updated / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #8 04:25:20 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\GeoIP | Average Calls Before IP Resolved'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #13 04:25:20 WARN  Failed to create counter 'Sitecore.Analytics.Tracking\GeoIP | Average Calls Before IP Resolved Average Base'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
20692 04:25:20 INFO  Sitecore.Analytics.Tracking.Diagnostics.PerformanceCounters are initialized
ManagedPoolThread #9 04:25:20 WARN  Failed to create counter 'Sitecore.Analytics\Data | Rows Saved - Total / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #7 04:25:20 WARN  Failed to create counter 'Sitecore.Analytics\Data | Rows Saved - Bulk Copy / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #0 04:25:20 WARN  Failed to create counter 'Sitecore.Analytics\Data | Rows Saved - Batch / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #10 04:25:20 WARN  Failed to create counter 'Sitecore.Analytics\Data | Rows Saved - Row By Row / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #11 04:25:20 WARN  Failed to create counter 'Sitecore.Analytics\Data | Rows Failed to Save / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #12 04:25:20 WARN  Failed to create counter 'Sitecore.Analytics\Data | Commit Queue Length'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #8 04:25:20 WARN  Failed to create counter 'Sitecore.Analytics\Data | Commit Queue Flush Length'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #13 04:25:20 WARN  Failed to create counter 'Sitecore.Analytics\Data | Tracker Flushes - Total / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #9 04:25:20 WARN  Failed to create counter 'Sitecore.Analytics\Data | Tracker Flushes - Explicit / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #7 04:25:20 WARN  Failed to create counter 'Sitecore.Analytics\Data | Tracker Flushes - Inline / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #0 04:25:20 WARN  Failed to create counter 'Sitecore.Analytics\Data | Tracker Flushes - Timeout / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #10 04:25:20 WARN  Failed to create counter 'Sitecore.Analytics\Data | Tracker Flushes - Capacity Overflow'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #11 04:25:20 WARN  Failed to create counter 'Sitecore.Analytics\Data | Average Tracker Flush Time'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #12 04:25:20 WARN  Failed to create counter 'Sitecore.Analytics\Data | Average Tracker Flush Time Average Base'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #8 04:25:20 WARN  Failed to create counter 'Sitecore.Analytics\Data | Last Tracker Flush Time'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #13 04:25:20 WARN  Failed to create counter 'Sitecore.Analytics\Data | Aggregation - Visits saved to reporting database / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #9 04:25:20 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Live Interactions Processed / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #7 04:25:20 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | History Interactions Processed / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #0 04:25:20 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Total Interactions Processed / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #10 04:25:20 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Live Aggregation Errors / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #11 04:25:20 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | History Aggregation Errors / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #12 04:25:20 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Total Aggregation Errors / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #8 04:25:20 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Contacts Processed / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #13 04:25:20 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Contact Processing Errors / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #9 04:25:20 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Average Batch Size - Live'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #7 04:25:20 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Average Batch Size - Live Average Base'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #0 04:25:20 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Average Batch Size - History'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #10 04:25:20 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Average Batch Size - History Average Base'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #11 04:25:20 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Number of Batches Containing Failing Items - Live'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #12 04:25:20 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Number of Batches Containing Failing Items - History'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #8 04:25:20 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Average Aggregation Pipeline Time (ms)'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #13 04:25:20 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Average Aggregation Pipeline Time (ms) Average Base'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #9 04:25:20 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Average Write Time (ms)'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #7 04:25:20 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Average Write Time (ms) Average Base'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #0 04:25:20 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Average Contact Processing Pipeline Time (ms)'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #10 04:25:20 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Average Contact Processing Pipeline Time (ms) Average Base'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #11 04:25:20 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Average Write Time - Primary (ms)'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #12 04:25:20 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Average Write Time - Primary (ms) Average Base'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #8 04:25:20 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Average Write Time - Secondary, Live (ms)'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #13 04:25:20 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Average Write Time - Secondary, Live (ms) Average Base'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #9 04:25:20 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Average Write Time - Secondary, History (ms)'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #7 04:25:20 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Average Write Time - Secondary, History (ms) Average Base'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #0 04:25:20 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Active Interaction Aggregators'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #10 04:25:20 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Average Check Out Time - Live (ms)'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #11 04:25:20 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Average Check Out Time - Live (ms) Average Base'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #12 04:25:20 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Average Check In Time - Live (ms)'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #8 04:25:20 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Average Check In Time - Live (ms) Average Base'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #13 04:25:20 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Average Check Out Time - History (ms)'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #9 04:25:20 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Average Check Out Time - History (ms) Average Base'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #7 04:25:20 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Average Check In Time - History (ms)'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #0 04:25:20 WARN  Failed to create counter 'Sitecore.Analytics\Aggregation | Average Check In Time - History (ms) Average Base'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
20692 04:25:20 INFO  Sitecore.Analytics.Diagnostics.PerformanceCounters are initialized
20692 04:25:20 INFO  DumpConfigurationFiles: Started
23464 04:25:20 INFO  DumpConfigurationFiles: Dump folder is C:\Repo\Sitecore82\Sitecore82.Web\data\diagnostics\configuration_history\20170715Z.032520Z
ManagedPoolThread #2 04:25:21 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 04:25:21 INFO  Job started: Update device detection DB
23464 04:25:22 INFO  DumpConfigurationFiles: C:\Repo\Sitecore82\Sitecore82.Web\App_Config has been dumped
ManagedPoolThread #5 04:25:22 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
23464 04:25:22 INFO  DumpConfigurationFiles: C:\Repo\Sitecore82\Sitecore82.Web\Web.config has been dumped
23464 04:25:22 INFO  DumpConfigurationFiles: C:\Repo\Sitecore82\Sitecore82.Web\Global.asax has been dumped
23464 04:25:22 INFO  DumpConfigurationFiles: C:\Repo\Sitecore82\Sitecore82.Web\sitecore\shell\sitecore.version.xml has been dumped
23464 04:25:22 INFO  DumpConfigurationFiles: Zipping of the dumped configuration files is enabled
20692 04:25:22 INFO  Sitecore.Social: The Social MVC area is registered.
20692 04:25:22 INFO  [Sitecore Mvc]: Sitecore MVC IAssemblyResolver contains 190 assemblies
23464 04:25:22 INFO  DumpConfigurationFiles: C:\Repo\Sitecore82\Sitecore82.Web\data\diagnostics\configuration_history\20170715Z.032520Z.zip has been created
23464 04:25:22 INFO  DumpConfigurationFiles: C:\Repo\Sitecore82\Sitecore82.Web\data\diagnostics\configuration_history\20170715Z.032520Z has been removed
23464 04:25:22 INFO  DumpConfigurationFiles: Completed
ManagedPoolThread #6 04:25:23 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
20692 04:25:23 INFO  Trace: BaseTypeProvider`1.GetTypes 133ms
20692 04:25:23 INFO  Trace: BaseTypeProvider`1.GetTypes 12ms
20692 04:25:23 INFO  Trace: BaseTypeProvider`1.GetTypes 11ms
20692 04:25:23 INFO  Trace: BaseTypeProvider`1.GetTypes 11ms
20692 04:25:23 INFO  Cache created: 'PathAnalyzer_ResponseCache' (max size: 10MB, running total: 1028MB)
ManagedPoolThread #3 04:25:24 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
20692 04:25:24 INFO  [Experience Analytics]: SyncSegmentsProcessor started the syncronization of segments
6408 04:25:24 INFO  [Experience Analytics]: Segment Deploy started.
20692 04:25:24 INFO  [Experience Analytics]: WebApiInitializer
20692 04:25:24 INFO  [Experience Analytics]: Filter (Sitecore.ExperienceAnalytics.Api.Http.Filters.CacheHeaderFilterAttribute) added
ManagedPoolThread #0 04:25:24 WARN  Failed to create counter 'Sitecore.Data\Data.ClientDataReads'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #10 04:25:24 WARN  Failed to create counter 'Sitecore.Data\Data.ClientDataWrites'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #11 04:25:24 WARN  Failed to create counter 'Sitecore.Data\Data.ItemsAccessed'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #8 04:25:24 WARN  Failed to create counter 'Sitecore.Data\Data.PhysicalReads'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #13 04:25:24 WARN  Failed to create counter 'Sitecore.Data\Data.PhysicalWrites'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #7 04:25:24 WARN  Failed to create counter 'Sitecore.Data\StreamSharer.OpenStreams'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #9 04:25:24 WARN  Failed to create counter 'Sitecore.Data\SqlServerStream.OpenStreams'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
20692 04:25:24 INFO  Sitecore.Social: The Social remote events are initialized.
23896 04:25:24 INFO  Scheduler - Adding agents
23896 04:25:24 INFO  Scheduler - Adding agent: Sitecore.Tasks.UrlAgent (interval: 00:15:00)
23896 04:25:24 INFO  Scheduler - Adding agent: Sitecore.Tasks.TaskDatabaseAgent (interval: 00:10:00)
23896 04:25:24 INFO  Scheduler - Adding agent: Sitecore.Tasks.CompactClientDataAgent (interval: 04:00:00)
23896 04:25:24 INFO  Scheduler - Adding agent: Sitecore.Tasks.CleanupHistory (interval: 04:00:00)
23896 04:25:24 INFO  Scheduler - Adding agent: Sitecore.Tasks.CleanupPublishQueue (interval: 04:00:00)
23896 04:25:24 INFO  Scheduler - Adding agent: Sitecore.Tasks.CleanupEventQueue (interval: 04:00:00)
23896 04:25:24 INFO  Scheduler - Skipping inactive agent: Sitecore.Tasks.HtmlCacheClearAgent
23896 04:25:24 INFO  Scheduler - Adding agent: Sitecore.Tasks.CleanupAuthenticationTicketsAgent (interval: 04:00:00)
23896 04:25:24 INFO  Scheduler - Skipping inactive agent: Sitecore.Tasks.PublishAgent
23896 04:25:24 INFO  Scheduler - Adding agent: Sitecore.Tasks.CleanupAgent (interval: 06:00:00)
23896 04:25:24 INFO  Scheduler - Adding agent: Sitecore.Tasks.CounterDumpAgent (interval: 01:00:00)
23896 04:25:24 INFO  Scheduler - Adding agent: Sitecore.Tasks.CloneNotificationsCleanupAgent (interval: 1.00:00:00)
23896 04:25:24 INFO  Scheduler - Adding agent: Sitecore.Analytics.Tasks.EmailReportsTask (interval: 01:00:00)
23896 04:25:24 INFO  Scheduler - Adding agent: Sitecore.ContentSearch.Tasks.Optimize (interval: 12:00:00)
23896 04:25:24 INFO  Scheduler - Adding agent: Sitecore.PathAnalyzer.Client.Tasks.HelpUpdateAgent (interval: 03:00:00)
23896 04:25:24 INFO  Scheduler - Adding agent: Sitecore.PathAnalyzer.Client.Tasks.HelpUpdateAgent (interval: 03:00:00)
23896 04:25:24 INFO  Scheduler - Adding agent: Core_Database_Agent (interval: 00:10:00)
23896 04:25:24 INFO  Scheduler - Adding agent: Master_Database_Agent (interval: 00:10:00)
23896 04:25:24 INFO  Scheduler - Adding agent: Sitecore.Tasks.CleanupFDAObsoleteMediaData (interval: 1.00:00:00)
23896 04:25:24 INFO  Scheduler - Adding agent: Sitecore.Tasks.WebDAVOptionsCleanupAgent (interval: 1.00:00:00)
14244 04:25:24 INFO  HttpModule is being initialized
23224 04:25:24 INFO  HttpModule is being initialized
14244 04:25:25 INFO  Cache created: 'SqlDataProvider - Prefetch data(web)' (max size: 50MB, running total: 1078MB)
ManagedPoolThread #1 04:25:25 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
23896 04:25:25 INFO  Scheduler - Skipping inactive agent: Sitecore.Social.Client.Tasks.ManagePreExpiredAccounts
23896 04:25:25 INFO  Scheduler - Skipping inactive agent: Sitecore.Social.Client.Tasks.SynchronizeSocialMediaInfo
23896 04:25:25 INFO  Scheduler - Adding agent: Sitecore.Social.Client.Tasks.PostFlaggedMessages (interval: 01:00:00)
23896 04:25:25 INFO  Scheduler - Adding agent: Sitecore.Social.Client.Tasks.UpdateMessagesStatistics (interval: 01:00:00)
23896 04:25:25 INFO  Scheduler - Agents added
14244 04:25:25 INFO  Cache created: 'clientData' (max size: 25MB, running total: 1103MB)
14244 04:25:25 INFO  Cache created: 'UserProfileCache' (max size: 5MB, running total: 1108MB)
14244 04:25:25 INFO  Cache created: 'AccessResultCache' (max size: 10MB, running total: 1118MB)
ManagedPoolThread #8 04:25:25 WARN  Failed to create counter 'Sitecore.Security\Access Denied / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #13 04:25:25 WARN  Failed to create counter 'Sitecore.Security\Access Granted / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #7 04:25:25 WARN  Failed to create counter 'Sitecore.Security\Access Resolved / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #9 04:25:25 WARN  Failed to create counter 'Sitecore.Security\Modify Requests / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #0 04:25:25 WARN  Failed to create counter 'Sitecore.Security\Programmatic Disabling / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #11 04:25:25 WARN  Failed to create counter 'Sitecore.Security\Programmatic Enabling / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #10 04:25:25 WARN  Failed to create counter 'Sitecore.Security\Programmatic User Switch / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #8 04:25:25 WARN  Failed to create counter 'Sitecore.Security\Read Requests / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #13 04:25:25 WARN  Failed to create counter 'Sitecore.Security\Virtual Users Built / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
14244 04:25:25 INFO  Cache created: 'shell[html]' (max size: 0 bytes, running total: 1118MB)
14244 04:25:25 INFO  Cache created: 'shell[registry]' (max size: 15MB, running total: 1133MB)
14244 04:25:25 INFO  Cache created: 'shell[viewstate]' (max size: 1MB, running total: 1134MB)
14244 04:25:25 INFO  Cache created: 'shell[xsl]' (max size: 25MB, running total: 1159MB)
14244 04:25:25 INFO  Cache created: 'shell[filtered items]' (max size: 10MB, running total: 1169MB)
14244 04:25:25 INFO  Cache created: 'login[html]' (max size: 0 bytes, running total: 1169MB)
14244 04:25:25 INFO  Cache created: 'login[registry]' (max size: 25MB, running total: 1194MB)
14244 04:25:25 INFO  Cache created: 'login[viewstate]' (max size: 25MB, running total: 1219MB)
14244 04:25:25 INFO  Cache created: 'login[xsl]' (max size: 50MB, running total: 1269MB)
14244 04:25:25 INFO  Cache created: 'login[filtered items]' (max size: 10MB, running total: 1279MB)
14244 04:25:25 INFO  Cache created: 'admin[html]' (max size: 0 bytes, running total: 1279MB)
14244 04:25:25 INFO  Cache created: 'admin[registry]' (max size: 25MB, running total: 1304MB)
14244 04:25:25 INFO  Cache created: 'admin[viewstate]' (max size: 25MB, running total: 1329MB)
14244 04:25:25 INFO  Cache created: 'admin[xsl]' (max size: 50MB, running total: 1379MB)
14244 04:25:25 INFO  Cache created: 'admin[filtered items]' (max size: 10MB, running total: 1389MB)
14244 04:25:25 INFO  Cache created: 'service[html]' (max size: 0 bytes, running total: 1389MB)
14244 04:25:25 INFO  Cache created: 'service[registry]' (max size: 25MB, running total: 1414MB)
14244 04:25:25 INFO  Cache created: 'service[viewstate]' (max size: 25MB, running total: 1439MB)
14244 04:25:25 INFO  Cache created: 'service[xsl]' (max size: 50MB, running total: 1489MB)
14244 04:25:25 INFO  Cache created: 'service[filtered items]' (max size: 10MB, running total: 1499MB)
14244 04:25:25 INFO  Cache created: 'modules_shell[html]' (max size: 0 bytes, running total: 1499MB)
14244 04:25:25 INFO  Cache created: 'modules_shell[registry]' (max size: 25MB, running total: 1524MB)
14244 04:25:25 INFO  Cache created: 'modules_shell[viewstate]' (max size: 25MB, running total: 1549MB)
14244 04:25:25 INFO  Cache created: 'modules_shell[xsl]' (max size: 50MB, running total: 1599MB)
14244 04:25:25 INFO  Cache created: 'modules_shell[filtered items]' (max size: 10MB, running total: 1609MB)
14244 04:25:25 INFO  Cache created: 'modules_website[html]' (max size: 25MB, running total: 1634MB)
14244 04:25:25 INFO  Cache created: 'modules_website[registry]' (max size: 25MB, running total: 1659MB)
14244 04:25:25 INFO  Cache created: 'modules_website[viewstate]' (max size: 25MB, running total: 1684MB)
14244 04:25:25 INFO  Cache created: 'modules_website[xsl]' (max size: 50MB, running total: 1734MB)
14244 04:25:25 INFO  Cache created: 'modules_website[filtered items]' (max size: 10MB, running total: 1744MB)
14244 04:25:25 INFO  Cache created: 'website[html]' (max size: 50MB, running total: 1794MB)
14244 04:25:25 INFO  Cache created: 'website[registry]' (max size: 0 bytes, running total: 1794MB)
14244 04:25:25 INFO  Cache created: 'website[viewstate]' (max size: 0 bytes, running total: 1794MB)
14244 04:25:25 INFO  Cache created: 'website[xsl]' (max size: 25MB, running total: 1819MB)
14244 04:25:25 INFO  Cache created: 'website[filtered items]' (max size: 10MB, running total: 1829MB)
14244 04:25:25 INFO  Cache created: 'website[renderingParameters]' (max size: 10MB, running total: 1839MB)
14244 04:25:25 INFO  Cache created: 'scheduler[html]' (max size: 0 bytes, running total: 1839MB)
14244 04:25:25 INFO  Cache created: 'scheduler[registry]' (max size: 25MB, running total: 1864MB)
14244 04:25:25 INFO  Cache created: 'scheduler[viewstate]' (max size: 25MB, running total: 1889MB)
14244 04:25:25 INFO  Cache created: 'scheduler[xsl]' (max size: 50MB, running total: 1939MB)
14244 04:25:25 INFO  Cache created: 'scheduler[filtered items]' (max size: 10MB, running total: 1949MB)
14244 04:25:25 INFO  Cache created: 'system[html]' (max size: 0 bytes, running total: 1949MB)
14244 04:25:25 INFO  Cache created: 'system[registry]' (max size: 25MB, running total: 1974MB)
14244 04:25:25 INFO  Cache created: 'system[viewstate]' (max size: 25MB, running total: 1999MB)
14244 04:25:25 INFO  Cache created: 'system[xsl]' (max size: 50MB, running total: 2049MB)
14244 04:25:25 INFO  Cache created: 'system[filtered items]' (max size: 10MB, running total: 2059MB)
14244 04:25:25 INFO  Cache created: 'publisher[html]' (max size: 0 bytes, running total: 2059MB)
14244 04:25:25 INFO  Cache created: 'publisher[registry]' (max size: 25MB, running total: 2084MB)
14244 04:25:25 INFO  Cache created: 'publisher[viewstate]' (max size: 25MB, running total: 2109MB)
14244 04:25:25 INFO  Cache created: 'publisher[xsl]' (max size: 50MB, running total: 2159MB)
14244 04:25:25 INFO  Cache created: 'publisher[filtered items]' (max size: 10MB, running total: 2169MB)
23224 04:25:26 INFO  Cache created: 'Log singles' (max size: 100KB, running total: 2169MB)
23224 04:25:26 WARN  No session Id managers were found to manage the session Id for the current request. Default asp.net session manager will be used.
ManagedPoolThread #7 04:25:26 WARN  Failed to create counter 'Sitecore.Presentation\Context | Site Changed / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #9 04:25:26 WARN  Failed to create counter 'Sitecore.Presentation\Rendering | Controls Rendered / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #0 04:25:26 WARN  Failed to create counter 'Sitecore.Presentation\Rendering | Controls Rendered From Cache / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #11 04:25:26 WARN  Failed to create counter 'Sitecore.Presentation\Rendering | Pages Generated / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #10 04:25:26 WARN  Failed to create counter 'Sitecore.Presentation\Rendering | Renderings Rendered / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #8 04:25:26 WARN  Failed to create counter 'Sitecore.Presentation\Rendering | Sublayouts Rendered / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #13 04:25:26 WARN  Failed to create counter 'Sitecore.Presentation\Rendering | XmlControls Compiled / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #7 04:25:26 WARN  Failed to create counter 'Sitecore.Presentation\Rendering | Xsl Transforms Rendered / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #9 04:25:26 WARN  Failed to create counter 'Sitecore.Presentation\Rendering | Xaml Controls Compiled / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
6408 04:25:26 INFO  Cache created: 'SqlDataProvider - Prefetch data(master)' (max size: 100MB, running total: 2269MB)
ManagedPoolThread #12 04:25:26 INFO  Cache created: 'SqlDataProvider - Prefetch data(core)' (max size: 50MB, running total: 2319MB)
ManagedPoolThread #12 04:25:26 INFO  Loading Dictionary from cache
ManagedPoolThread #12 04:25:26 WARN  No subscription for Device Detection service. Could not check for updates.
ManagedPoolThread #12 04:25:26 INFO  Job ended: Update device detection DB (units processed: )
ManagedPoolThread #4 04:25:26 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
6408 04:25:27 INFO  Cache created: 'ItemCloningRelations' (max size: 50MB, running total: 2369MB)
14244 04:25:27 INFO  Cache created: 'scripts' (max size: 800KB, running total: 2370MB)
6408 04:25:28 INFO  Cache created: 'IsUserInRoleCache' (max size: 5MB, running total: 2375MB)
6408 04:25:28 INFO  Trying to load XML configuration /App_Config/Security/GlobalRoles.config
6408 04:25:28 INFO  Cache created: 'ReportDataCache' (max size: 50MB, running total: 2425MB)
6408 04:25:28 INFO  Cache created: 'ExperienceAnalytics.Segments' (max size: 20MB, running total: 2445MB)
6408 04:25:28 INFO  [Experience Analytics]: Segment Deploy complete.
14244 04:25:29 INFO  Cache created: 'LocationsDictionaryCache' (max size: 976KB, running total: 2446MB)
14244 04:25:29 INFO  Cache created: 'ReferringSitesDictionaryCache' (max size: 976KB, running total: 2447MB)
14244 04:25:29 INFO  Cache created: 'GeoIpDataDictionaryCache' (max size: 976KB, running total: 2448MB)
14244 04:25:29 INFO  Cache created: 'UserAgentDictionaryCache' (max size: 976KB, running total: 2449MB)
14244 04:25:29 INFO  Cache created: 'DeviceDictionaryCache' (max size: 976KB, running total: 2450MB)
ManagedPoolThread #10 04:25:29 WARN  Failed to create counter 'Sitecore.Analytics.MongoDb\Reads / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #4 04:25:29 WARN  Failed to create counter 'Sitecore.Analytics.MongoDb\Writes / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #11 04:25:29 WARN  Failed to create counter 'Sitecore.Analytics.MongoDb\Documents fetched / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #0 04:25:29 WARN  Failed to create counter 'Sitecore.Analytics.MongoDb\Data | Aggregation - Add (Visits scheduled for aggregation) / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #10 04:25:29 WARN  Failed to create counter 'Sitecore.Analytics.MongoDb\Data | Aggregation - Check out calls / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #4 04:25:29 WARN  Failed to create counter 'Sitecore.Analytics.MongoDb\Data | Aggregation - Check out (Visits checked out) / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #11 04:25:29 WARN  Failed to create counter 'Sitecore.Analytics.MongoDb\Data | Aggregation - Check in (Visits checked in) / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #0 04:25:29 WARN  Failed to create counter 'Sitecore.Analytics.MongoDb\Data | Aggregation - Pool Recovery calls / sec'. Sitecore has no necessary permissions for reading/creating counters.
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #10 04:25:30 INFO  Cache created: 'CES.GeoIp.Caching.GeoIpCache' (max size: 0 bytes, running total: 2450MB)
ManagedPoolThread #10 04:25:30 WARN  Authentication on CES Discovery service failed.
Exception: System.Net.WebException
Message: The remote server returned an error: (403) Forbidden.
Source: System
   at System.Net.HttpWebRequest.GetResponse()
   at Sitecore.CES.Client.WebClient.ExecuteRequest(String requestUri)
   at Sitecore.CES.Client.ResourceConnector`1.Request(String endpoint, Object[] parameters)
   at Sitecore.CES.Discovery.EndpointSource.GetEndpoint(String serviceName)

ManagedPoolThread #10 04:25:30 ERROR Failed to perform GeoIp lookup for 6f182084-c87a-7073-3d61-b296487494c8
Exception: System.ArgumentNullException
Message: Null ids are not allowed.
Parameter name: endpoint
Source: Sitecore.Kernel
   at Sitecore.Diagnostics.Assert.ArgumentNotNullOrEmpty(String argument, String argumentName)
   at Sitecore.CES.Client.ResourceConnector`1.Request(String endpoint, Object[] parameters)
   at Sitecore.CES.GeoIp.SitecoreProvider.GetInformationByIp(String ip)
   at Sitecore.Analytics.Lookups.GeoIpManager.GetDataFromLookupProvider(GeoIpHandle geoIpHandle)

ManagedPoolThread #10 04:25:30 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

ManagedPoolThread #14 04:25:31 INFO  Trying to load XML configuration /App_Config/Security/GlobalRoles.config
ManagedPoolThread #0 04:25:31 INFO  Cache created: '[IDTable]' (max size: 2MB, running total: 2452MB)
ManagedPoolThread #4 04:25:31 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

1184 04:25:32 INFO  Cache created: 'ReportingStorageProviderProperties.Properties' (max size: 10MB, running total: 2462MB)
25376 04:25:32 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26348 04:25:32 INFO  Cache created: 'Task Manager - tasks' (max size: 100 bytes, running total: 2462MB)
17156 04:25:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3060 04:25:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25316 04:25:32 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

27176 04:25:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1184 04:25:32 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

14244 04:25:32 ERROR An error occurred while reading an automation state document related to contact {E55EC108-0734-4425-8682-D900F34B5EB1} was found in the AutomationStates collection. Mongo collection returned null.
ManagedPoolThread #14 04:25:33 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
23224 04:25:34 INFO  Cache created: 'Theme_Images' (max size: 100KB, running total: 2462MB)
23224 04:25:34 INFO  Cache created: 'Theme_LanguageIcons' (max size: 100KB, running total: 2463MB)
ManagedPoolThread #0 04:25:34 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #11 04:25:35 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #4 04:25:36 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
25688 04:25:37 INFO  HttpModule is being initialized
26348 04:25:37 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
26348 04:25:37 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



23408 04:25:38 INFO  Cache created: 'SocialMessagesByContainerCache' (max size: 10MB, running total: 2473MB)
ManagedPoolThread #15 04:25:38 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #18 04:25:41 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

25376 04:25:47 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3060 04:25:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

17156 04:25:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25316 04:25:47 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

27176 04:25:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1184 04:25:47 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #16 04:25:51 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

26348 04:25:52 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 04:26:02 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

25376 04:26:02 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

17156 04:26:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

27176 04:26:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25316 04:26:03 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3060 04:26:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1184 04:26:03 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26348 04:26:07 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 04:26:12 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

25376 04:26:17 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

17156 04:26:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

27176 04:26:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25316 04:26:18 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3060 04:26:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1184 04:26:18 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 04:26:18 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

ManagedPoolThread #19 04:26:22 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

26348 04:26:22 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 04:26:28 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 04:26:29 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 04:26:30 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 04:26:31 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 04:26:32 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #4 04:26:32 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

25376 04:26:32 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

17156 04:26:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

27176 04:26:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25316 04:26:33 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3060 04:26:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1184 04:26:33 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #6 04:26:33 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #9 04:26:34 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #2 04:26:35 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 04:26:36 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 04:26:37 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
26348 04:26:37 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #14 04:26:38 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 04:26:39 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #18 04:26:40 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #15 04:26:41 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #19 04:26:43 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

25376 04:26:47 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

17156 04:26:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

27176 04:26:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25316 04:26:48 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3060 04:26:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1184 04:26:48 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26348 04:26:52 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #16 04:26:53 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

25376 04:27:02 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

17156 04:27:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

27176 04:27:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25316 04:27:03 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3060 04:27:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1184 04:27:03 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 04:27:03 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

26348 04:27:08 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 04:27:13 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

25376 04:27:17 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

17156 04:27:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

27176 04:27:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25316 04:27:18 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3060 04:27:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1184 04:27:18 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #16 04:27:19 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

26348 04:27:23 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 04:27:23 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

25376 04:27:32 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

17156 04:27:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

27176 04:27:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25316 04:27:33 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3060 04:27:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1184 04:27:33 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 04:27:34 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

26348 04:27:38 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 04:27:39 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 04:27:40 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 04:27:41 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 04:27:42 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 04:27:43 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #4 04:27:44 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

ManagedPoolThread #3 04:27:44 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #9 04:27:45 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 04:27:46 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #2 04:27:47 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
25376 04:27:47 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

17156 04:27:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

27176 04:27:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25316 04:27:48 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3060 04:27:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1184 04:27:48 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #12 04:27:48 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #14 04:27:49 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #18 04:27:50 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #15 04:27:51 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #11 04:27:52 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
26348 04:27:53 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 04:27:53 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #17 04:27:54 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

25376 04:28:02 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

17156 04:28:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

27176 04:28:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25316 04:28:03 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3060 04:28:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1184 04:28:03 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 04:28:04 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

26348 04:28:08 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #16 04:28:14 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

25376 04:28:18 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

17156 04:28:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

27176 04:28:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25316 04:28:18 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3060 04:28:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1184 04:28:18 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26348 04:28:23 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 04:28:25 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

25376 04:28:33 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

17156 04:28:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

27176 04:28:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25316 04:28:33 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3060 04:28:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1184 04:28:33 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 04:28:35 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

26348 04:28:38 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 04:28:45 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

25376 04:28:48 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

17156 04:28:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

27176 04:28:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25316 04:28:48 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3060 04:28:49 ERROR Exception when executing agent aggregation/automationAggregator
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Buffer`1..ctor(IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


1184 04:28:50 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Enumerable.FirstOrDefault[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


ManagedPoolThread #12 04:28:51 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 04:28:53 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #9 04:28:54 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 04:28:55 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #19 04:28:55 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

ManagedPoolThread #3 04:28:56 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 04:28:57 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 04:28:58 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 04:28:59 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 04:29:00 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #2 04:29:01 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #14 04:29:02 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
25376 04:29:03 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

17156 04:29:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

27176 04:29:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #11 04:29:03 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
25316 04:29:03 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26348 04:29:04 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
26348 04:29:04 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



3060 04:29:04 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 04:29:05 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #16 04:29:05 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

1184 04:29:05 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #18 04:29:06 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #15 04:29:07 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #16 04:29:16 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

25376 04:29:18 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

17156 04:29:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

27176 04:29:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25316 04:29:18 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26348 04:29:19 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3060 04:29:19 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1184 04:29:20 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 04:29:22 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

ManagedPoolThread #4 04:29:26 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

25376 04:29:33 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

17156 04:29:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

27176 04:29:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25316 04:29:33 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26348 04:29:34 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3060 04:29:35 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1184 04:29:35 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 04:29:36 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

ManagedPoolThread #17 04:29:47 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

25376 04:29:48 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

17156 04:29:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

27176 04:29:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25316 04:29:48 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26348 04:29:49 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3060 04:29:50 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1184 04:29:50 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 04:29:57 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

ManagedPoolThread #6 04:30:02 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
25376 04:30:03 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

17156 04:30:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

27176 04:30:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 04:30:03 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
25316 04:30:03 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 04:30:04 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
26348 04:30:04 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3060 04:30:05 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #2 04:30:05 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
1184 04:30:05 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #1 04:30:06 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #19 04:30:07 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

ManagedPoolThread #7 04:30:07 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 04:30:08 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #9 04:30:09 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 04:30:10 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 04:30:11 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #14 04:30:12 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #18 04:30:14 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #15 04:30:15 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #11 04:30:16 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #4 04:30:17 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

25376 04:30:18 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

17156 04:30:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

27176 04:30:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25316 04:30:18 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25752 04:30:19 INFO  [Path Analyzer](.) Running trail cleanup agent
25752 04:30:19 INFO  [Path Analyzer](.) Running trail cleanup on database
25752 04:30:19 WARN  [Path Analyzer](.) SqlStorage ConnectionString 'reporting.secondary' cannot be found
26348 04:30:19 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3060 04:30:20 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1184 04:30:20 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 04:30:28 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

25376 04:30:33 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

17156 04:30:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

27176 04:30:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25316 04:30:34 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26348 04:30:34 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3060 04:30:35 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1184 04:30:35 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 04:30:38 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

25376 04:30:48 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

17156 04:30:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

27176 04:30:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 04:30:48 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

25316 04:30:49 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26348 04:30:49 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3060 04:30:50 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1184 04:30:50 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 04:30:58 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

25376 04:31:03 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

17156 04:31:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

27176 04:31:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25316 04:31:04 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26348 04:31:04 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3060 04:31:05 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1184 04:31:06 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 04:31:08 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

ManagedPoolThread #7 04:31:13 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 04:31:14 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 04:31:15 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #2 04:31:16 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 04:31:17 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 04:31:18 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
25376 04:31:18 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

17156 04:31:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

27176 04:31:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 04:31:18 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

25316 04:31:19 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 04:31:19 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3060 04:31:20 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #3 04:31:20 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
1184 04:31:21 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 04:31:22 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 04:31:23 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #14 04:31:24 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #19 04:31:25 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

ManagedPoolThread #18 04:31:25 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 04:31:26 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #11 04:31:27 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
26348 04:31:28 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
26348 04:31:28 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



ManagedPoolThread #17 04:31:29 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

ManagedPoolThread #15 04:31:29 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
25376 04:31:33 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

27176 04:31:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

17156 04:31:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25316 04:31:34 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3060 04:31:35 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1184 04:31:36 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 04:31:39 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

26348 04:31:43 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

17156 04:31:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25376 04:31:48 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

27176 04:31:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25316 04:31:49 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #16 04:31:49 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

3060 04:31:50 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1184 04:31:51 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26348 04:31:58 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 04:31:59 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

25376 04:32:03 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

17156 04:32:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

27176 04:32:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25316 04:32:04 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3060 04:32:05 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1184 04:32:06 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #16 04:32:09 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

26348 04:32:13 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

27176 04:32:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25376 04:32:18 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

17156 04:32:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25316 04:32:19 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 04:32:20 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

3060 04:32:20 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1184 04:32:21 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #2 04:32:24 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 04:32:25 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #17 04:32:26 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

ManagedPoolThread #7 04:32:26 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 04:32:27 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 04:32:28 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
26348 04:32:28 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #12 04:32:29 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #17 04:32:30 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

ManagedPoolThread #13 04:32:30 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 04:32:31 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #9 04:32:33 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
17156 04:32:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25376 04:32:33 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

27176 04:32:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #3 04:32:34 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
25316 04:32:34 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #10 04:32:35 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3060 04:32:35 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #14 04:32:36 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
1184 04:32:36 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 04:32:37 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #15 04:32:38 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #18 04:32:39 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #11 04:32:40 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #19 04:32:40 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

26348 04:32:43 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

27176 04:32:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25376 04:32:48 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

17156 04:32:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25316 04:32:49 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3060 04:32:50 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 04:32:50 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

1184 04:32:51 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26348 04:32:58 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 04:33:01 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

17156 04:33:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25376 04:33:04 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

27176 04:33:04 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25316 04:33:04 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3060 04:33:05 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1184 04:33:06 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #16 04:33:11 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

26348 04:33:13 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

17156 04:33:19 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

27176 04:33:19 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25376 04:33:19 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25316 04:33:19 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3060 04:33:20 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 04:33:21 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

1184 04:33:22 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26348 04:33:28 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #16 04:33:31 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

17156 04:33:34 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25376 04:33:34 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

27176 04:33:34 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25316 04:33:34 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #2 04:33:36 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
1184 04:33:37 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #5 04:33:37 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 04:33:38 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 04:33:39 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 04:33:40 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #9 04:33:41 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #17 04:33:41 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

ManagedPoolThread #1 04:33:42 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 04:33:43 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 04:33:44 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3060 04:33:45 ERROR Exception when executing agent aggregation/automationAggregator
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Buffer`1..ctor(IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


ManagedPoolThread #10 04:33:46 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 04:33:47 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #14 04:33:48 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
17156 04:33:49 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

27176 04:33:49 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25376 04:33:49 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #18 04:33:49 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
25316 04:33:49 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #11 04:33:50 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
26348 04:33:51 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
26348 04:33:51 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



ManagedPoolThread #19 04:33:51 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

1184 04:33:52 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 04:33:52 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #15 04:33:53 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3060 04:34:00 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 04:34:01 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

17156 04:34:04 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25376 04:34:04 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

27176 04:34:04 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25316 04:34:04 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26348 04:34:06 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1184 04:34:07 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 04:34:11 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

3060 04:34:15 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

17156 04:34:19 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25376 04:34:19 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

27176 04:34:19 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25316 04:34:19 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26348 04:34:21 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 04:34:22 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

1184 04:34:22 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3060 04:34:30 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 04:34:32 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

17156 04:34:34 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25376 04:34:34 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

27176 04:34:34 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25316 04:34:34 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26348 04:34:36 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1184 04:34:37 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 04:34:42 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

3060 04:34:45 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #1 04:34:48 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
17156 04:34:49 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25376 04:34:49 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

27176 04:34:49 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 04:34:49 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
25316 04:34:50 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #2 04:34:50 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 04:34:51 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
26348 04:34:51 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1184 04:34:52 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #5 04:34:52 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #17 04:34:52 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

ManagedPoolThread #9 04:34:53 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 04:34:54 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 04:34:55 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 04:34:56 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 04:34:57 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #14 04:34:58 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 04:35:00 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3060 04:35:00 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #15 04:35:01 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #11 04:35:02 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #16 04:35:03 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

17156 04:35:04 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25376 04:35:04 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

27176 04:35:04 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25316 04:35:05 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26348 04:35:06 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1184 04:35:07 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 04:35:13 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

3060 04:35:15 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

17156 04:35:19 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25752 04:35:19 INFO  [Path Analyzer](.) Running trail cleanup agent
25752 04:35:19 INFO  [Path Analyzer](.) Running trail cleanup on database
25376 04:35:19 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

27176 04:35:19 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 04:35:19 INFO  Health.PrivateBytes: 709,517,312
ManagedPoolThread #4 04:35:19 INFO  Health.CacheInstances: 129
ManagedPoolThread #4 04:35:19 INFO  Health.CacheTotalCount: 21,063
ManagedPoolThread #4 04:35:19 INFO  Health.CacheTotalSize: 49,321,126
ManagedPoolThread #4 04:35:19 WARN  Could not register counter in HealthMonitor. Category: Process, Name: Private Bytes, Instance: , InstanceType: Windows
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #4 04:35:19 WARN  Could not register counter in HealthMonitor. Category: Process, Name: Virtual Bytes, Instance: , InstanceType: Windows
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #4 04:35:19 WARN  Could not register counter in HealthMonitor. Category: Process, Name: Page File Bytes, Instance: , InstanceType: Windows
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #4 04:35:19 WARN  Could not register counter in HealthMonitor. Category: .NET CLR Memory, Name: # Bytes in all Heaps, Instance: , InstanceType: CLR
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #4 04:35:19 WARN  Could not register counter in HealthMonitor. Category: .NET CLR Memory, Name: % Time in GC, Instance: , InstanceType: CLR
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #4 04:35:19 WARN  Could not register counter in HealthMonitor. Category: .NET CLR Memory, Name: Large Object Heap size, Instance: , InstanceType: CLR
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #4 04:35:19 WARN  Could not register counter in HealthMonitor. Category: .NET CLR Loading, Name: Bytes in Loader Heap, Instance: , InstanceType: CLR
		Message: Access to the registry key 'Global' is denied.
ManagedPoolThread #4 04:35:19 WARN  Could not register counter in HealthMonitor. Category: .NET CLR Loading, Name: Current Assemblies, Instance: , InstanceType: CLR
		Message: Access to the registry key 'Global' is denied.
25316 04:35:20 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26348 04:35:21 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #16 04:35:22 INFO  Job started: Sitecore.Tasks.TaskDatabaseAgent
1184 04:35:22 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #16 04:35:22 INFO  Processing tasks (count: 0)
ManagedPoolThread #16 04:35:22 INFO  Job ended: Sitecore.Tasks.TaskDatabaseAgent (units processed: )
ManagedPoolThread #4 04:35:22 INFO  Job started: Core_Database_Agent
ManagedPoolThread #4 04:35:22 INFO  Scheduling.DatabaseAgent started. Database: core
ManagedPoolThread #4 04:35:22 INFO  Examining schedules (count: 0)
ManagedPoolThread #4 04:35:22 INFO  Job ended: Core_Database_Agent (units processed: )
ManagedPoolThread #19 04:35:22 INFO  Job started: Master_Database_Agent
ManagedPoolThread #19 04:35:22 INFO  Scheduling.DatabaseAgent started. Database: master
ManagedPoolThread #19 04:35:22 INFO  Examining schedules (count: 5)
ManagedPoolThread #19 04:35:22 INFO  Starting: __Task Schedule
ManagedPoolThread #19 04:35:22 INFO  Ended: __Task Schedule
ManagedPoolThread #19 04:35:22 INFO  Not due: Calculate Statistical Relevancy
ManagedPoolThread #19 04:35:22 INFO  Not due: Rebuild Suggested Tests Index
ManagedPoolThread #19 04:35:22 INFO  Not due: Suspend Corrupted Tests
ManagedPoolThread #19 04:35:22 INFO  Not due: Try Finish Test
ManagedPoolThread #19 04:35:22 INFO  Job ended: Master_Database_Agent (units processed: 5)
ManagedPoolThread #4 04:35:23 INFO  Job started: Update device detection DB
ManagedPoolThread #4 04:35:23 WARN  No subscription for Device Detection service. Could not check for updates.
ManagedPoolThread #4 04:35:23 INFO  Job ended: Update device detection DB (units processed: )
ManagedPoolThread #19 04:35:23 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

ManagedPoolThread #19 04:35:29 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

3060 04:35:30 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 04:35:34 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

17156 04:35:34 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25376 04:35:34 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

27176 04:35:34 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25316 04:35:35 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26348 04:35:36 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1184 04:35:37 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #16 04:35:44 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

3060 04:35:45 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

17156 04:35:49 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25376 04:35:49 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

27176 04:35:49 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25316 04:35:50 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26348 04:35:51 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1184 04:35:52 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 04:35:54 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

ManagedPoolThread #2 04:35:58 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 04:35:59 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 04:36:00 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3060 04:36:00 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #6 04:36:01 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 04:36:02 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 04:36:03 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
17156 04:36:04 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #16 04:36:04 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

25376 04:36:04 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

27176 04:36:04 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 04:36:04 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
25316 04:36:05 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 04:36:05 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 04:36:06 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
1184 04:36:07 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #1 04:36:07 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #14 04:36:08 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 04:36:10 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #18 04:36:11 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #11 04:36:12 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
26348 04:36:13 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
26348 04:36:13 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



ManagedPoolThread #15 04:36:14 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #4 04:36:14 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

3060 04:36:15 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

17156 04:36:19 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25376 04:36:19 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

27176 04:36:19 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25316 04:36:20 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1184 04:36:22 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 04:36:24 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

26348 04:36:28 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 04:36:30 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

3060 04:36:30 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

17156 04:36:34 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25376 04:36:34 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

27176 04:36:34 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 04:36:34 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

25316 04:36:35 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1184 04:36:37 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26348 04:36:43 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 04:36:45 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

3060 04:36:45 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

17156 04:36:49 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25376 04:36:49 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

27176 04:36:49 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25316 04:36:50 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1184 04:36:52 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 04:36:55 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

26348 04:36:58 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3060 04:37:00 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

17156 04:37:04 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25376 04:37:04 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

27176 04:37:04 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 04:37:05 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

25316 04:37:05 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1184 04:37:07 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 04:37:09 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #2 04:37:10 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 04:37:11 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 04:37:12 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
26348 04:37:13 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 04:37:13 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 04:37:14 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #4 04:37:15 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

ManagedPoolThread #1 04:37:15 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3060 04:37:15 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 04:37:16 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 04:37:17 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 04:37:18 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #14 04:37:19 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
17156 04:37:19 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25376 04:37:19 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

27176 04:37:19 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25316 04:37:20 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #18 04:37:20 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #15 04:37:21 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 04:37:22 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
1184 04:37:22 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 04:37:25 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

26348 04:37:28 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3060 04:37:30 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

17156 04:37:34 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25376 04:37:34 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

27176 04:37:34 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25316 04:37:35 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 04:37:35 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

1184 04:37:37 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26348 04:37:43 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3060 04:37:46 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 04:37:46 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

17156 04:37:49 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25376 04:37:49 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

27176 04:37:49 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25316 04:37:50 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1184 04:37:52 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #16 04:37:56 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

26348 04:37:58 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3060 04:38:01 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

17156 04:38:04 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25376 04:38:04 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

27176 04:38:04 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25316 04:38:05 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #16 04:38:06 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

1184 04:38:07 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26348 04:38:13 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3060 04:38:16 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 04:38:17 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

ManagedPoolThread #1 04:38:20 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
25316 04:38:20 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #6 04:38:21 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 04:38:22 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
1184 04:38:22 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #5 04:38:23 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #2 04:38:24 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 04:38:25 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 04:38:26 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #9 04:38:27 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #4 04:38:27 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

ManagedPoolThread #8 04:38:28 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 04:38:29 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
26512 04:38:30 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
17156 04:38:31 ERROR Exception when executing agent aggregation/automationAggregator
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Buffer`1..ctor(IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


3060 04:38:31 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25376 04:38:32 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Enumerable.FirstOrDefault[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


27176 04:38:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Buffer`1..ctor(IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


ManagedPoolThread #4 04:38:33 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

ManagedPoolThread #14 04:38:34 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #15 04:38:35 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
25316 04:38:35 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 04:38:36 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #4 04:38:37 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

ManagedPoolThread #11 04:38:37 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
1184 04:38:37 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26348 04:38:38 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
26348 04:38:38 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



ManagedPoolThread #18 04:38:39 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
17156 04:38:46 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3060 04:38:46 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25376 04:38:47 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 04:38:47 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

27176 04:38:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25316 04:38:50 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1184 04:38:52 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26348 04:38:53 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 04:38:58 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

17156 04:39:01 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3060 04:39:01 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25376 04:39:02 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

27176 04:39:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25316 04:39:05 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1184 04:39:07 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 04:39:08 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

26348 04:39:08 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

17156 04:39:16 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3060 04:39:16 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25376 04:39:17 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 04:39:18 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

27176 04:39:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25316 04:39:20 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1184 04:39:22 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26348 04:39:23 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 04:39:28 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

26512 04:39:31 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
17156 04:39:31 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3060 04:39:31 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 04:39:32 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
25376 04:39:32 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

27176 04:39:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #2 04:39:33 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 04:39:34 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #19 04:39:34 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

ManagedPoolThread #6 04:39:35 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
25316 04:39:35 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 04:39:36 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 04:39:37 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
1184 04:39:38 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #1 04:39:38 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #4 04:39:38 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

ManagedPoolThread #5 04:39:39 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 04:39:40 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 04:39:41 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #14 04:39:42 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
26348 04:39:43 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
26348 04:39:43 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



ManagedPoolThread #18 04:39:45 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
17156 04:39:46 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3060 04:39:46 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25376 04:39:47 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

27176 04:39:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 04:39:48 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

25316 04:39:50 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1184 04:39:53 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26348 04:39:58 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 04:39:58 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

17156 04:40:01 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3060 04:40:01 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25376 04:40:02 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

27176 04:40:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25316 04:40:05 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1184 04:40:08 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 04:40:08 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

26348 04:40:13 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

17156 04:40:16 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3060 04:40:16 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25376 04:40:17 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

27176 04:40:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 04:40:19 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

25752 04:40:19 INFO  [Path Analyzer](.) Running trail cleanup agent
25752 04:40:19 INFO  [Path Analyzer](.) Running trail cleanup on database
25284 04:40:19 WARN  [Path Analyzer](.) SmartMergeAgent.Execute() returns. No missing date ranges to merge.
ManagedPoolThread #16 04:40:20 INFO  Job started: Sitecore.Tasks.UrlAgent
ManagedPoolThread #16 04:40:20 INFO  Scheduling.UrlAgent started. Url: http://localhost:91/sitecore/service/keepalive.aspx
ManagedPoolThread #16 04:40:20 INFO  Scheduling.UrlAgent done (received: 589 bytes)
ManagedPoolThread #16 04:40:20 INFO  Job ended: Sitecore.Tasks.UrlAgent (units processed: )
25316 04:40:20 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1184 04:40:23 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26348 04:40:28 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 04:40:31 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

17156 04:40:31 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3060 04:40:31 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25376 04:40:32 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

27176 04:40:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #16 04:40:35 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

25316 04:40:35 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1184 04:40:38 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 04:40:41 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

ManagedPoolThread #2 04:40:42 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 04:40:43 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 04:40:44 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #9 04:40:45 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
17156 04:40:46 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3060 04:40:46 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 04:40:46 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 04:40:47 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
25376 04:40:47 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

27176 04:40:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 04:40:48 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 04:40:49 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 04:40:50 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
25316 04:40:50 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 04:40:51 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

ManagedPoolThread #14 04:40:51 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
26348 04:40:52 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
26348 04:40:52 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



1184 04:40:53 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #15 04:40:53 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #18 04:40:54 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 04:40:55 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #11 04:40:56 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #16 04:41:01 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

17156 04:41:01 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3060 04:41:01 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25376 04:41:02 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

27176 04:41:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25316 04:41:05 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26348 04:41:07 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1184 04:41:08 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 04:41:11 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

17156 04:41:16 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3060 04:41:16 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25376 04:41:17 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

27176 04:41:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25316 04:41:21 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #16 04:41:21 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

26348 04:41:22 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1184 04:41:23 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

17156 04:41:31 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3060 04:41:31 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 04:41:32 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

25376 04:41:32 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

27176 04:41:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 04:41:36 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

25316 04:41:36 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26348 04:41:37 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1184 04:41:38 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 04:41:42 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

17156 04:41:46 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3060 04:41:46 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25376 04:41:47 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

27176 04:41:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 04:41:51 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #16 04:41:52 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

ManagedPoolThread #1 04:41:52 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
26348 04:41:53 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1184 04:41:53 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 04:41:53 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 04:41:54 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 04:41:55 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 04:41:56 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #2 04:41:57 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 04:41:59 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #9 04:42:00 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
25316 04:42:01 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Enumerable.FirstOrDefault[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


26276 04:42:02 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
17156 04:42:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3060 04:42:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 04:42:02 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

25376 04:42:02 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #12 04:42:03 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
27176 04:42:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #14 04:42:04 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 04:42:05 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #11 04:42:06 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #15 04:42:07 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
26348 04:42:08 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #18 04:42:08 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
1184 04:42:08 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 04:42:13 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

25316 04:42:16 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

17156 04:42:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3060 04:42:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25376 04:42:17 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

27176 04:42:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26348 04:42:23 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #16 04:42:23 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

1184 04:42:23 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25316 04:42:31 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

17156 04:42:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3060 04:42:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25376 04:42:32 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 04:42:33 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

27176 04:42:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26348 04:42:38 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1184 04:42:38 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #16 04:42:43 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

25316 04:42:46 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

17156 04:42:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3060 04:42:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25376 04:42:47 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

27176 04:42:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26348 04:42:53 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1184 04:42:53 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #16 04:42:53 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

25316 04:43:01 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

17156 04:43:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3060 04:43:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25376 04:43:02 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #3 04:43:04 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 04:43:05 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
27176 04:43:06 ERROR Exception when executing agent aggregation/automationAggregator
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Buffer`1..ctor(IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


ManagedPoolThread #13 04:43:07 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
1184 04:43:08 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #2 04:43:08 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 04:43:09 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 04:43:10 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 04:43:11 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 04:43:12 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #9 04:43:13 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #17 04:43:14 ERROR Cannot process Automation states.
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Enumerable.WhereSelectEnumerableIterator`2.MoveNext()
   at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)
   at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


ManagedPoolThread #12 04:43:15 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
25316 04:43:16 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #14 04:43:16 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
17156 04:43:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3060 04:43:17 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #15 04:43:17 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
25376 04:43:17 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26348 04:43:18 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
26348 04:43:18 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



ManagedPoolThread #18 04:43:19 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #0 04:43:20 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
27176 04:43:21 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #11 04:43:21 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
1184 04:43:23 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 04:43:24 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

25316 04:43:31 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

17156 04:43:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3060 04:43:32 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25376 04:43:33 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26348 04:43:33 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 04:43:34 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

27176 04:43:36 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1184 04:43:39 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #16 04:43:39 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

ManagedPoolThread #4 04:43:45 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

25316 04:43:46 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

17156 04:43:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3060 04:43:47 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25376 04:43:48 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26348 04:43:48 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

27176 04:43:51 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1184 04:43:54 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 04:43:55 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

25316 04:44:01 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

17156 04:44:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3060 04:44:02 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25376 04:44:03 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26348 04:44:03 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 04:44:05 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

27176 04:44:06 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1184 04:44:09 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 04:44:16 ERROR Cannot process Automation states.
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Enumerable.WhereSelectEnumerableIterator`2.MoveNext()
   at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)
   at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


ManagedPoolThread #8 04:44:18 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
26348 04:44:18 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 04:44:19 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 04:44:20 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 04:44:21 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
27176 04:44:21 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 04:44:22 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 04:44:23 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
1184 04:44:24 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #2 04:44:24 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #16 04:44:25 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

ManagedPoolThread #5 04:44:25 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 04:44:27 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 04:44:28 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
25316 04:44:29 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Enumerable.FirstOrDefault[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


ManagedPoolThread #14 04:44:30 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
26512 04:44:31 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
26276 04:44:32 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
17156 04:44:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Buffer`1..ctor(IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


3060 04:44:34 ERROR Exception when executing agent aggregation/automationAggregator
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Buffer`1..ctor(IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


ManagedPoolThread #19 04:44:35 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

25376 04:44:35 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Enumerable.FirstOrDefault[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


27176 04:44:36 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 04:44:36 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #11 04:44:37 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #15 04:44:38 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
1184 04:44:39 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #18 04:44:40 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
26348 04:44:41 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
26348 04:44:41 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



25316 04:44:44 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 04:44:45 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

17156 04:44:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3060 04:44:49 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25376 04:44:50 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

27176 04:44:51 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1184 04:44:54 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26348 04:44:56 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 04:44:56 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

25316 04:44:59 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

17156 04:45:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3060 04:45:04 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25376 04:45:05 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 04:45:06 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

27176 04:45:06 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1184 04:45:09 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26348 04:45:11 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25316 04:45:14 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #16 04:45:16 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

17156 04:45:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25752 04:45:19 INFO  [Path Analyzer](.) Running trail cleanup agent
25752 04:45:19 INFO  [Path Analyzer](.) Running trail cleanup on database
3060 04:45:20 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 04:45:20 INFO  Health.PrivateBytes: 710,443,008
ManagedPoolThread #17 04:45:20 INFO  Health.CacheInstances: 129
ManagedPoolThread #17 04:45:20 INFO  Health.CacheTotalCount: 21,097
ManagedPoolThread #17 04:45:20 INFO  Health.CacheTotalSize: 49,378,338
25376 04:45:20 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

27176 04:45:21 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1184 04:45:24 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 04:45:24 INFO  Job started: Update device detection DB
ManagedPoolThread #4 04:45:25 WARN  Authentication on CES Discovery service failed.
Exception: System.Net.WebException
Message: The remote server returned an error: (403) Forbidden.
Source: System
   at System.Net.HttpWebRequest.GetResponse()
   at Sitecore.CES.Client.WebClient.ExecuteRequest(String requestUri)
   at Sitecore.CES.Client.ResourceConnector`1.Request(String endpoint, Object[] parameters)
   at Sitecore.CES.Discovery.EndpointSource.GetEndpoint(String serviceName)

ManagedPoolThread #4 04:45:25 WARN  No subscription for Device Detection service. Could not check for updates.
ManagedPoolThread #4 04:45:25 INFO  Job ended: Update device detection DB (units processed: )
26348 04:45:26 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 04:45:26 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

ManagedPoolThread #16 04:45:27 INFO  Job started: Sitecore.Tasks.TaskDatabaseAgent
ManagedPoolThread #16 04:45:27 INFO  Processing tasks (count: 0)
ManagedPoolThread #16 04:45:27 INFO  Job ended: Sitecore.Tasks.TaskDatabaseAgent (units processed: )
ManagedPoolThread #19 04:45:27 INFO  Job started: Core_Database_Agent
ManagedPoolThread #19 04:45:27 INFO  Scheduling.DatabaseAgent started. Database: core
ManagedPoolThread #19 04:45:27 INFO  Examining schedules (count: 0)
ManagedPoolThread #19 04:45:27 INFO  Job ended: Core_Database_Agent (units processed: )
ManagedPoolThread #4 04:45:27 INFO  Job started: Master_Database_Agent
ManagedPoolThread #4 04:45:27 INFO  Scheduling.DatabaseAgent started. Database: master
ManagedPoolThread #4 04:45:27 INFO  Examining schedules (count: 5)
ManagedPoolThread #4 04:45:27 INFO  Starting: __Task Schedule
ManagedPoolThread #4 04:45:27 INFO  Ended: __Task Schedule
ManagedPoolThread #4 04:45:27 INFO  Not due: Calculate Statistical Relevancy
ManagedPoolThread #4 04:45:27 INFO  Not due: Rebuild Suggested Tests Index
ManagedPoolThread #4 04:45:27 INFO  Not due: Suspend Corrupted Tests
ManagedPoolThread #4 04:45:27 INFO  Not due: Try Finish Test
ManagedPoolThread #4 04:45:27 INFO  Job ended: Master_Database_Agent (units processed: 5)
25316 04:45:29 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #14 04:45:31 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
26276 04:45:33 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 04:45:34 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3060 04:45:35 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25376 04:45:35 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 04:45:35 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
27176 04:45:36 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #2 04:45:36 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #16 04:45:37 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

ManagedPoolThread #5 04:45:37 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 04:45:39 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
1184 04:45:39 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 04:45:40 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #17 04:45:41 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

ManagedPoolThread #9 04:45:41 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 04:45:42 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 04:45:43 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 04:45:44 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
25316 04:45:44 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

17156 04:45:45 ERROR Exception when executing agent aggregation/automationAggregator
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Buffer`1..ctor(IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


ManagedPoolThread #18 04:45:46 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #4 04:45:47 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

26348 04:45:47 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
26348 04:45:47 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



3060 04:45:50 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25376 04:45:50 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

27176 04:45:51 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1184 04:45:54 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 04:45:57 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

25316 04:45:59 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

17156 04:46:00 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26348 04:46:02 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3060 04:46:05 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25376 04:46:05 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

27176 04:46:07 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 04:46:07 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

1184 04:46:09 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25316 04:46:14 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

17156 04:46:15 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26348 04:46:17 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #16 04:46:18 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

3060 04:46:20 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25376 04:46:20 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

27176 04:46:22 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1184 04:46:24 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 04:46:28 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

25316 04:46:29 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

17156 04:46:30 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26348 04:46:32 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #14 04:46:33 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3060 04:46:35 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25376 04:46:35 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

27176 04:46:37 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 04:46:38 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

1184 04:46:39 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #16 04:46:42 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

25316 04:46:45 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Enumerable.FirstOrDefault[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


ManagedPoolThread #7 04:46:46 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #9 04:46:47 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 04:46:48 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #4 04:46:49 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

ManagedPoolThread #5 04:46:49 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3060 04:46:50 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #2 04:46:50 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
25376 04:46:51 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 04:46:51 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
27176 04:46:52 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #6 04:46:52 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 04:46:53 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
1184 04:46:54 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #1 04:46:54 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 04:46:55 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
17156 04:46:56 ERROR Exception when executing agent aggregation/automationAggregator
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Buffer`1..ctor(IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


ManagedPoolThread #18 04:46:58 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
26348 04:46:59 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
26348 04:46:59 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



ManagedPoolThread #17 04:46:59 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

ManagedPoolThread #0 04:47:00 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
25316 04:47:00 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #11 04:47:01 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #15 04:47:02 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3060 04:47:05 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25376 04:47:06 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

27176 04:47:07 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1184 04:47:09 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 04:47:09 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

17156 04:47:11 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26348 04:47:14 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25316 04:47:15 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 04:47:19 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

3060 04:47:20 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25376 04:47:21 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

27176 04:47:22 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1184 04:47:24 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

17156 04:47:26 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26348 04:47:29 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 04:47:29 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

25316 04:47:30 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #14 04:47:34 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3060 04:47:35 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25376 04:47:36 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

27176 04:47:37 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1184 04:47:39 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 04:47:39 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

17156 04:47:41 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26348 04:47:44 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25316 04:47:45 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 04:47:50 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

3060 04:47:50 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25376 04:47:51 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

27176 04:47:52 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1184 04:47:54 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #9 04:47:57 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 04:47:58 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 04:47:59 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
26348 04:47:59 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 04:48:00 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #4 04:48:00 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

25316 04:48:00 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #6 04:48:01 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #2 04:48:02 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 04:48:03 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 04:48:04 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 04:48:05 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3060 04:48:05 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #12 04:48:06 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
25376 04:48:06 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

17156 04:48:07 ERROR Exception when executing agent aggregation/automationAggregator
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Buffer`1..ctor(IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


27176 04:48:07 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 04:48:08 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #15 04:48:09 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
1184 04:48:09 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 04:48:10 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

26348 04:48:14 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25316 04:48:15 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3060 04:48:20 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 04:48:20 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

25376 04:48:21 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

17156 04:48:22 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

27176 04:48:22 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1184 04:48:24 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26348 04:48:29 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25316 04:48:30 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 04:48:31 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

ManagedPoolThread #14 04:48:35 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3060 04:48:35 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25376 04:48:36 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

17156 04:48:37 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

27176 04:48:37 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1184 04:48:39 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 04:48:41 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

26348 04:48:44 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25316 04:48:45 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3060 04:48:50 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25376 04:48:51 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 04:48:51 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

17156 04:48:52 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

27176 04:48:52 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1184 04:48:54 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26348 04:48:59 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25316 04:49:00 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 04:49:02 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

3060 04:49:05 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25376 04:49:07 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Enumerable.FirstOrDefault[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


ManagedPoolThread #12 04:49:08 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #9 04:49:09 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
1184 04:49:10 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #2 04:49:10 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 04:49:11 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #17 04:49:12 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

ManagedPoolThread #7 04:49:12 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 04:49:13 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 04:49:14 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 04:49:15 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
25316 04:49:15 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #3 04:49:16 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 04:49:17 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
17156 04:49:18 ERROR Exception when executing agent aggregation/automationAggregator
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Buffer`1..ctor(IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


27176 04:49:19 ERROR Exception when executing agent aggregation/automationAggregator
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Buffer`1..ctor(IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


3060 04:49:20 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 04:49:20 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #15 04:49:21 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #16 04:49:22 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

25376 04:49:22 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #18 04:49:22 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #11 04:49:23 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
26348 04:49:24 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
26348 04:49:24 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



1184 04:49:25 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25316 04:49:30 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #16 04:49:32 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

17156 04:49:33 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

27176 04:49:34 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3060 04:49:35 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #14 04:49:36 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
25376 04:49:37 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26348 04:49:39 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1184 04:49:40 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 04:49:42 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

25316 04:49:45 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 04:49:46 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

17156 04:49:48 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

27176 04:49:49 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3060 04:49:51 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25376 04:49:52 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 04:49:52 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

26348 04:49:54 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1184 04:49:55 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25316 04:50:00 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #16 04:50:03 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

17156 04:50:03 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

27176 04:50:04 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3060 04:50:06 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25376 04:50:07 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26348 04:50:09 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1184 04:50:10 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #16 04:50:13 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

25316 04:50:15 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26512 04:50:18 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #9 04:50:19 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
27176 04:50:19 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25752 04:50:20 INFO  [Path Analyzer](.) Running trail cleanup agent
25752 04:50:20 INFO  [Path Analyzer](.) Running trail cleanup on database
ManagedPoolThread #1 04:50:20 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
3060 04:50:21 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #6 04:50:21 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
25376 04:50:22 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #2 04:50:22 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #4 04:50:23 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

ManagedPoolThread #13 04:50:23 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 04:50:24 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
1184 04:50:25 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #7 04:50:26 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 04:50:27 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #8 04:50:28 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 04:50:29 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
17156 04:50:30 ERROR Exception when executing agent aggregation/automationAggregator
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Buffer`1..ctor(IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


25316 04:50:30 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #18 04:50:31 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
26348 04:50:32 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
26348 04:50:32 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



ManagedPoolThread #4 04:50:33 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

27176 04:50:35 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3060 04:50:36 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25376 04:50:37 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #14 04:50:38 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
1184 04:50:40 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #16 04:50:43 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

17156 04:50:45 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25316 04:50:45 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26348 04:50:47 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 04:50:47 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

27176 04:50:50 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3060 04:50:51 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25376 04:50:52 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 04:50:53 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

1184 04:50:55 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

17156 04:51:00 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25316 04:51:00 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26348 04:51:02 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 04:51:04 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

27176 04:51:05 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3060 04:51:06 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25376 04:51:07 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1184 04:51:10 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 04:51:14 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

17156 04:51:15 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25316 04:51:15 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26348 04:51:17 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

27176 04:51:20 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3060 04:51:21 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25376 04:51:23 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #16 04:51:24 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

1184 04:51:25 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 04:51:31 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 04:51:32 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 04:51:33 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 04:51:34 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #19 04:51:35 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

ManagedPoolThread #7 04:51:35 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
27176 04:51:35 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3060 04:51:36 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #5 04:51:36 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #2 04:51:37 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
25376 04:51:38 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #3 04:51:38 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #9 04:51:39 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
1184 04:51:40 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #12 04:51:40 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
17156 04:51:41 ERROR Exception when executing agent aggregation/automationAggregator
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Buffer`1..ctor(IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


25316 04:51:42 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Enumerable.FirstOrDefault[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


ManagedPoolThread #0 04:51:43 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
26348 04:51:44 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
26348 04:51:44 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



ManagedPoolThread #16 04:51:45 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

ManagedPoolThread #15 04:51:45 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #18 04:51:46 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #11 04:51:47 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #14 04:51:48 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
27176 04:51:50 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3060 04:51:51 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25376 04:51:53 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1184 04:51:55 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #16 04:51:55 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

17156 04:51:56 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25316 04:51:57 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26348 04:51:59 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 04:52:05 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

27176 04:52:05 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3060 04:52:06 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25376 04:52:08 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1184 04:52:10 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

17156 04:52:11 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25316 04:52:12 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26348 04:52:14 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 04:52:16 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

27176 04:52:20 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3060 04:52:21 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25376 04:52:23 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1184 04:52:25 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 04:52:26 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

17156 04:52:26 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25316 04:52:27 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26348 04:52:29 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

27176 04:52:35 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3060 04:52:36 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 04:52:36 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

25376 04:52:38 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #2 04:52:41 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
25316 04:52:42 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #8 04:52:42 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 04:52:43 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
26348 04:52:44 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #13 04:52:44 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 04:52:45 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #9 04:52:46 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #16 04:52:46 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

ManagedPoolThread #7 04:52:47 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #3 04:52:48 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 04:52:49 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
27176 04:52:50 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1184 04:52:50 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Enumerable.FirstOrDefault[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


ManagedPoolThread #4 04:52:50 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

3060 04:52:51 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

17156 04:52:51 ERROR Exception when executing agent aggregation/automationAggregator
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Buffer`1..ctor(IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


ManagedPoolThread #1 04:52:52 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
25376 04:52:53 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #18 04:52:53 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #11 04:52:54 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #14 04:52:55 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #16 04:52:57 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

25316 04:52:57 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26348 04:52:59 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

27176 04:53:05 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1184 04:53:05 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3060 04:53:06 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

17156 04:53:06 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 04:53:07 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

25376 04:53:08 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25316 04:53:12 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26348 04:53:14 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #4 04:53:17 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

27176 04:53:20 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1184 04:53:20 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3060 04:53:21 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

17156 04:53:21 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25376 04:53:23 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25316 04:53:27 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 04:53:27 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

26348 04:53:29 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

27176 04:53:35 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1184 04:53:35 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3060 04:53:36 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

17156 04:53:36 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 04:53:37 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

25376 04:53:38 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25316 04:53:42 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26348 04:53:44 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #17 04:53:48 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

27176 04:53:51 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1184 04:53:51 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3060 04:53:51 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

17156 04:53:51 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 04:53:52 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

ManagedPoolThread #3 04:53:54 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #7 04:53:55 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #13 04:53:56 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
25376 04:53:57 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCursor`1.MongoCursorConnectionProvider.AcquireConnection()
   at MongoDB.Driver.Operations.QueryOperation`1.GetFirstBatch(IConnectionProvider connectionProvider)
   at MongoDB.Driver.Operations.QueryOperation`1.Execute(IConnectionProvider connectionProvider)
   at System.Linq.Enumerable.FirstOrDefault[TSource](IEnumerable`1 source)
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)


25316 04:53:57 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #2 04:53:58 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #17 04:53:58 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

ManagedPoolThread #8 04:53:59 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #5 04:54:00 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #6 04:54:01 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #9 04:54:02 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #1 04:54:03 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #12 04:54:04 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #18 04:54:05 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
27176 04:54:06 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1184 04:54:06 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3060 04:54:06 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #0 04:54:06 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
17156 04:54:06 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #11 04:54:07 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #14 04:54:08 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
ManagedPoolThread #19 04:54:08 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

ManagedPoolThread #15 04:54:09 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
26348 04:54:10 ERROR Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
26348 04:54:10 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.HandleDatabaseException(ExceptionBehavior exceptionBehavior, Exception ex)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

Nested Exception

Exception: MongoDB.Driver.MongoConnectionException
Message: Unable to connect to server localhost:27017: No connection could be made because the target machine actively refused it 127.0.0.1:27017.
Source: MongoDB.Driver
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)
   at MongoDB.Driver.Internal.DirectMongoServerProxy.ChooseServerInstance(ReadPreference readPreference)
   at MongoDB.Driver.MongoServer.AcquireConnection(ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference, IBsonSerializer resultSerializer, IBsonSerializationOptions resultSerializationOptions)
   at MongoDB.Driver.MongoCollection.RunCommandAs[TCommandResult](IMongoCommand command, ReadPreference readPreference)
   at MongoDB.Driver.MongoCollection.FindAndModify(FindAndModifyArgs args)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.<>c__DisplayClass2c.<FindAndModify>b__2b()
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)

Nested Exception

Exception: System.Net.Sockets.SocketException
Message: No connection could be made because the target machine actively refused it 127.0.0.1:27017
Source: System
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at System.Net.Sockets.TcpClient.Connect(IPEndPoint remoteEP)
   at MongoDB.Driver.Internal.MongoConnection.Open()
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(BsonBuffer buffer, Int32 requestId)
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message)
   at MongoDB.Driver.Operations.CommandOperation`1.Execute(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Ping(MongoConnection connection)
   at MongoDB.Driver.MongoServerInstance.Connect()
   at MongoDB.Driver.Internal.DirectMongoServerProxy.Connect(TimeSpan timeout, ReadPreference readPreference)



25376 04:54:12 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25316 04:54:12 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 04:54:19 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

27176 04:54:21 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

3060 04:54:21 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

1184 04:54:21 ERROR Exception when executing agent aggregation/automationCleanupService
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetOldestUnaggregatedRangeTimestamp()
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.RemoveAutomationTransitions(DateTime oldestInclusive, DateTime latestExclusive)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.CleanupAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

17156 04:54:21 ERROR Exception when executing agent aggregation/automationAggregator
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.TryLockRange(WorkerHandle worker, DateTime leaseExpiration, RangeHandle& range)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryLockRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.GetNextRange(WorkScheduler`1& context)
   at Sitecore.Analytics.Core.RangeScheduler.RangeMapWorkScheduler2`1.TryGetNext(TKey& item)
   at Sitecore.Analytics.Automation.Aggregation.AutomationWorkDispatcher.TryGetNext(AutomationWorkItem& workItem)
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.AggregatorAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

26348 04:54:25 ERROR Exception when executing agent processing/taskAgent
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.FindAndModify(IMongoQuery query, IMongoSortBy sortBy, IMongoUpdate update, Boolean returnNew, Boolean upsert)
   at Sitecore.Analytics.Processing.MongoDbTaskStorageProvider.PickFirstExclusiveTask()
   at Sitecore.Analytics.Processing.TaskQueue.TryGetNext(Guid taskIdBoundary, ProcessingTask& workItem)
   at Sitecore.Analytics.Processing.TasksAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25376 04:54:27 ERROR Exception when executing agent aggregation/automationRangeManager
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.GetRightKey()
   at Sitecore.Analytics.Automation.Aggregation.Data.Processing.RangeManagerAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

25316 04:54:27 ERROR Exception when executing agent aggregation/historyCompletionCheck
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.RangeScheduler.MongoDbRangeMap2.RemoveFinishedRanges()
   at Sitecore.Analytics.Aggregation.History.MongoDbHistoryTaskManager.VerifyTaskCompletion()
   at Sitecore.Analytics.Aggregation.Data.Processing.HistoryCompletionCheckAgent.Execute()
   at Sitecore.Analytics.Core.BackgroundService.Run()

ManagedPoolThread #19 04:54:29 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

20496 04:54:31 INFO  **************************************************
20496 04:54:31 WARN  Sitecore shutting down
20496 04:54:31 WARN  Shutdown message: Change Notification for critical directories.
bin dir change or directory rename
HostingEnvironment initiated shutdown
Change Notification for critical directories.
bin dir change or directory rename
ManagedPoolThread #17 04:54:39 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

ManagedPoolThread #4 04:54:49 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

ManagedPoolThread #4 04:54:53 ERROR MongoDbDictionary.Store() has failed.
Exception: Sitecore.Analytics.DataAccess.DatabaseNotAvailableException
Message: Database not available
Source: Sitecore.Analytics.MongoDB
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Execute(Action action, ExceptionBehavior exceptionBehavior)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbCollection.Save(Object value)
   at Sitecore.Analytics.Data.DataAccess.MongoDb.MongoDbDictionary.Store(Object value)

ManagedPoolThread #17 04:54:59 ERROR Cannot process Automation states.
Exception: System.NullReferenceException
Message: Object reference not set to an instance of an object.
Source: Sitecore.Analytics.Automation.MongoDB
   at Sitecore.Analytics.Automation.Data.MongoDbAutomationProvider.GetContactIdsToProcessByWakeUpTime()
   at Sitecore.Analytics.Automation.AutomationWorker.Process()
   at Sitecore.Analytics.Automation.AutomationWorker.<Wakeup>b__5(Object state)

25724 04:55:01 ERROR An error occurred while reading an automation state document related to contact {85A65003-62A1-4C43-B9A6-C51B97A0F264} was found in the AutomationStates collection. Mongo collection returned null.
